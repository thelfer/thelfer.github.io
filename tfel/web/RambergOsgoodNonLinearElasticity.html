

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="generator" content="pandoc" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Non linear elasticity of the Ramberg-Osgood type</title>
        <meta name="author" content="Thomas Helfer, Duc Vinh Nguyen" />
            <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <style type="text/css">code{white-space: pre;}</style>
            <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {  background-color: #f8f8f8; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span.al { color: #ef2929; } /* Alert */
      code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { color: #204a87; } /* Attribute */
      code span.bn { color: #0000cf; } /* BaseN */
      code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #4e9a06; } /* Char */
      code span.cn { color: #8f5902; } /* Constant */
      code span.co { color: #8f5902; font-style: italic; } /* Comment */
      code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
      code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
      code span.dt { color: #204a87; } /* DataType */
      code span.dv { color: #0000cf; } /* DecVal */
      code span.er { color: #a40000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #0000cf; } /* Float */
      code span.fu { color: #204a87; font-weight: bold; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
      code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
      code span.ot { color: #8f5902; } /* Other */
      code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
      code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
      code span.ss { color: #4e9a06; } /* SpecialString */
      code span.st { color: #4e9a06; } /* String */
      code span.va { color: #000000; } /* Variable */
      code span.vs { color: #4e9a06; } /* VerbatimString */
      code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    </style>
            <link rel="stylesheet" href="css/normalize.css"/>
    <link rel="stylesheet" href="css/main.css"/>
        <script
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
        type="text/javascript"></script>
          </head>
  <body>
    <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
        <header>
      <ul id="nav">
	<li><a href="news.html">News</a></li>
	<li><a href="index.html">Overview</a>
	  <ul>
	    <li><a>Domain specific languages</a>
	      <ul>
		<li><a href="material-properties.html">Material properties</a></li>
		<li><a href="behaviours.html">Mechanical behaviours</a></li>
		<li><a href="models.html">Models</a></li>
	      </ul>
            </li>
	    <li><a href="interfaces.html">Available interfaces</a></li>
	    <li><a href="associated-projects.html">Associated projects</a></li>
     	    <li><a>Tools</a>
	      <ul>
	        <li><a href="mfront-doc.html">mfront-doc</a></li>
	        <li><a href="mtest.html">mtest</a></li>
	        <li><a href="mfm.html">mfm</a></li>
	        <li><a href="mfm-test-generator.html">mfm-test-generator</a></li>
	        <li><a href="tfel-check.html">tfel-check</a></li>
	      </ul>
	    </li>
	  </ul>
	</li>
	<li><a>Getting started</a>
	  <ul>
	    <li><a href="https://github.com/thelfer/tfel/">Github repository</a></li>
	    <li><a href="https://github.com/thelfer/tfel/releases">Download</a></li>
	    <li><a href="release-notes.html">Release notes</a>
	      <ul>
		<li><a>Versions 2.0.x</a>
                  <ul>
                    <li><a href="release-notes.html">Versions prior to 2.0.5</a></li>
	 	    <li><a href="release-notes-2.0.5.html">Version 2.0.5</a></li>
                  </ul>
		</li>
		<li><a>Versions 3.0.x</a>
                  <ul>
		    <li><a href="release-notes-3.0.html">Version 3.0.0</a></li>
		    <li><a href="release-notes-3.0.1.html">Version 3.0.1</a></li>
		    <li><a href="release-notes-3.0.2.html">Version 3.0.2</a></li>
		    <li><a href="release-notes-3.0.3.html">Version 3.0.3</a></li>
		    <li><a href="release-notes-3.0.4.html">Version 3.0.4</a></li>
		    <li><a href="release-notes-3.0.5.html">Version 3.0.5</a></li>
		    <li><a href="release-notes-3.0.6.html">Version 3.0.6</a></li>
		    <li><a href="release-notes-3.0.7.html">Version 3.0.7</a></li>
		    <li><a href="release-notes-3.0.8.html">Version 3.0.8</a></li>
		    <li><a href="release-notes-3.0.9.html">Version 3.0.9</a></li>
		    <li><a href="release-notes-3.0.10.html">Version 3.0.10</a></li>
		    <li><a href="release-notes-3.0.11.html">Version 3.0.11</a></li>
		    <li><a href="release-notes-3.0.12.html">Version 3.0.12</a></li>
		    <li><a href="release-notes-3.0.13.html">Version 3.0.13</a></li>
		    <li><a href="release-notes-3.0.14.html">Version 3.0.14</a></li>
		    <li><a href="release-notes-3.0.15.html">Version 3.0.15</a></li>
		    <li><a href="release-notes-3.0.16.html">Version 3.0.16</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.1.x</a>
		  <ul>
		    <li><a href="release-notes-3.1.html">Version 3.1.0</a></li>
		    <li><a href="release-notes-3.1.1.html">Version 3.1.1</a></li>
		    <li><a href="release-notes-3.1.2.html">Version 3.1.2</a></li>
		    <li><a href="release-notes-3.1.3.html">Version 3.1.3</a></li>
		    <li><a href="release-notes-3.1.4.html">Version 3.1.4</a></li>
		    <li><a href="release-notes-3.1.5.html">Version 3.1.5</a></li>
		    <li><a href="release-notes-3.1.6.html">Version 3.1.6</a></li>
		    <li><a href="release-notes-3.1.7.html">Version 3.1.7</a></li>
		    <li><a href="release-notes-3.1.8.html">Version 3.1.8</a></li>
		    <li><a href="release-notes-3.1.9.html">Version 3.1.9</a></li>
		    <li><a href="release-notes-3.1.10.html">Version 3.1.10</a></li>
		    <li><a href="release-notes-3.1.11.html">Version 3.1.11</a></li>
		    <li><a href="release-notes-3.1.12.html">Version 3.1.12</a></li>
		    <li><a href="release-notes-3.1.13.html">Version 3.1.13</a></li>
		    <li><a href="release-notes-3.1.14.html">Version 3.1.14</a></li>
		    <li><a href="release-notes-3.1.15.html">Version 3.1.15</a></li>
		    <li><a href="release-notes-3.1.16.html">Version 3.1.16</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.2.x</a>
		  <ul>
		    <li><a href="release-notes-3.2.html">Version 3.2.0</a></li>
		    <li><a href="release-notes-3.2.1.html">Version 3.2.1</a></li>
		    <li><a href="release-notes-3.2.2.html">Version 3.2.2</a></li>
		    <li><a href="release-notes-3.2.3.html">Version 3.2.3</a></li>
		    <li><a href="release-notes-3.2.4.html">Version 3.2.4</a></li>
		    <li><a href="release-notes-3.2.5.html">Version 3.2.5</a></li>
		    <li><a href="release-notes-3.2.6.html">Version 3.2.6</a></li>
		    <li><a href="release-notes-3.2.7.html">Version 3.2.7</a></li>
		    <li><a href="release-notes-3.2.8.html">Version 3.2.8</a></li>
		    <li><a href="release-notes-3.2.9.html">Version 3.2.9</a></li>
		    <li><a href="release-notes-3.2.10.html">Version 3.2.10</a></li>
		    <li><a href="release-notes-3.2.11.html">Version 3.2.11</a></li>
		    <li><a href="release-notes-3.2.12.html">Version 3.2.12</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.3.x</a>
		  <ul>
		    <li><a href="release-notes-3.3.html">Version 3.3.0</a></li>
		    <li><a href="release-notes-3.3.1.html">Version 3.3.1</a></li>
		    <li><a href="release-notes-3.3.1.html">Version 3.3.2</a></li>
		    <li><a href="release-notes-3.3.2.html">Version 3.3.2</a></li>
		    <li><a href="release-notes-3.3.3.html">Version 3.3.3</a></li>
		    <li><a href="release-notes-3.3.4.html">Version 3.3.4</a></li>
		    <li><a href="release-notes-3.3.5.html">Version 3.3.5</a></li>
		    <li><a href="release-notes-3.3.6.html">Version 3.3.6</a></li>
		    <li><a href="release-notes-3.3.7.html">Version 3.3.7</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.4.x</a>
		  <ul>
		    <li><a href="release-notes-3.4.html">Version 3.4.0</a></li>
		    <li><a href="release-notes-3.4.1.html">Version 3.4.1</a></li>
		    <li><a href="release-notes-3.4.2.html">Version 3.4.2</a></li>
		    <li><a href="release-notes-3.4.3.html">Version 3.4.3</a></li>
		    <li><a href="release-notes-3.4.4.html">Version 3.4.4</a></li>
		    <li><a href="release-notes-3.4.5.html">Version 3.4.5</a></li>
		    <li><a href="release-notes-3.4.6.html">Version 3.4.6</a></li>
		    <li><a href="release-notes-3.4.7.html">Version 3.4.7</a></li>
		    <li><a href="release-notes-3.4.8.html">Version 3.4.8</a></li>
		    <li><a href="release-notes-3.4.9.html">Version 3.4.9</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.0.x</a>
		  <ul>
		    <li><a href="release-notes-4.0.html">Version 4.0.0</a></li>
		    <li><a href="release-notes-4.0.1.html">Version 4.0.1</a></li>
		    <li><a href="release-notes-4.0.2.html">Version 4.0.2</a></li>
		    <li><a href="release-notes-4.0.3.html">Version 4.0.3</a></li>
		    <li><a href="release-notes-4.0.4.html">Version 4.0.4</a></li>
		    <li><a href="release-notes-4.0.5.html">Version 4.0.5</a></li>
		    <li><a href="release-notes-4.0.6.html">Version 4.0.6</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.1.x</a>
		  <ul>
		    <li><a href="release-notes-4.1.html">Version 4.1.0</a></li>
		    <li><a href="release-notes-4.1.1.html">Version 4.1.1</a></li>
		    <li><a href="release-notes-4.1.2.html">Version 4.1.2</a></li>
		    <li><a href="release-notes-4.1.3.html">Version 4.1.3</a></li>
		    <li><a href="release-notes-4.1.4.html">Version 4.1.4</a></li>
		    <li><a href="release-notes-4.1.5.html">Version 4.1.5</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.2.x</a>
		  <ul>
		    <li><a href="release-notes-4.2.html">Version 4.2.0</a></li>
		    <li><a href="release-notes-4.2.1.html">Version 4.2.1</a></li>
		    <li><a href="release-notes-4.2.2.html">Version 4.2.2</a></li>
		    <li><a href="release-notes-4.2.3.html">Version 4.2.3</a></li>
		  </ul>
		</li>
		<li><a>Versions 5.0.x</a>
		  <ul>
		    <li><a href="release-notes-5.0.html">Version 5.0.0</a></li>
		    <li><a href="release-notes-5.0.1.html">Version 5.0.1</a></li>
		    <li><a href="release-notes-5.0.2.html">Version 5.0.2</a></li>
		  </ul>
		</li>
		<li><a>Versions 5.1.x</a>
		  <ul>
		    <li><a href="release-notes-5.1.html">Version 5.1.0</a></li>
		  </ul>
		</li>
	      </ul>
	    </li>
	    <li><a href="coverity-scan.html">Coverity scan</a></li>
	    <li><a href="install.html">Installation</a></li>
	  </ul>
	</li>
	<li><a>Documentation</a>
	  <ul>
	    <li><a href="documentations.html">General documentation</a></li>
	    <li><a href="gallery.html">Gallery</a></li>
<!--	    
	    <li><a href="http://tfel.sourceforge.net/doxygen/index.html">Doxygen documentation</a></li>
-->
	    <li><a>Behaviours</a>
	      <ul>
		<li><a href="tutorial.html">Tutorial</a></li>
		<li><a href="implicit-dsl.html">The Implicit DSL</a></li>
		<li><a href="benchmark.html">Benchmark</a></li>
		<li><a href="parameters.html">Parameters</a></li>
		<li><a href="BehaviourBricks.html">Behaviour bricks</a></li>
		<li><a href="interfaces.html">Solver interfaces</a>
		  <ul>
		    <li><a href="castem.html">Cast3M</a></li>
		    <li><a href="amitex.html">AMITEX_FFTP</a></li>
		    <li><a href="aster.html">Code-Aster</a></li>
    		    <li><a href="abaqus.html">Abaqus</a></li>
		    <li><a href="zmat.html">ZeBuLoN</a></li>
   		    <li><a href="calculix.html">CalculiX</a></li>
		    <!-- <li><a >TMFFT</a></li> -->
		    <li><a href="cyrano.html">Cyrano</a></li>
   		    <li><a href="generic-material-property-interface.html">Generic interface for material properties</a></li>
   		    <li><a href="generic-behaviours-interface.html">Generic interface for behaviours</a></li>
		  </ul>
		</li>
	      </ul>
	    </li>
	    <li><a>TFEL libraries</a>
	      <ul>
		<li><a href="libraries_usage.html">Usage of the TFEL libraries in C++</a></li>
		<li><a href="tfel-math.html">TFEL/Math</a></li>
		<li><a href="tfel-material.html">TFEL/Material</a></li>
	      </ul>
	    </li>
	    <li><a>Python modules</a>
	      <ul>
		<li><a href="tfel-python.html">TFEL modules</a></li>
		<li><a href="mfront-python.html">mfront module</a></li>
		<li><a href="mtest-python.html">mtest module</a></li>
	      </ul>
	    </li>
	    <li><a>MFront keywords</a>
	      <ul>
	        <li><a href="Default-keywords.html">Default</a></li>
	        <li><a href="DefaultCZM-keywords.html">DefaultCZM</a></li>
	        <li><a href="DefaultFiniteStrain-keywords.html">DefaultFiniteStrain</a></li>
	        <li><a href="DefaultGenericBehaviour-keywords.html">DefaultGenericBehaviour</a></li>
	        <li><a href="DefaultModel-keywords.html">DefaultModel</a></li>
	        <li><a href="Implicit-keywords.html">Implicit</a></li>
	        <li><a href="ImplicitCZM-keywords.html">ImplicitCZM</a></li>
	        <li><a href="ImplicitFiniteStrain-keywords.html">ImplicitFiniteStrain</a></li>
	        <li><a href="ImplicitGenericBehaviour-keywords.html">ImplicitGenericBehaviour</a></li>
	        <li><a href="ImplicitModel-keywords.html">ImplicitModel</a></li>
	        <li><a href="ImplicitII-keywords.html">ImplicitII</a></li>
	        <li><a href="IsotropicMisesCreep-keywords.html">IsotropicMisesCreep</a></li>
	        <li><a href="IsotropicMisesPlasticFlow-keywords.html">IsotropicMisesPlasticFlow</a></li>
	        <li><a href="IsotropicPlasticMisesFlow-keywords.html">IsotropicPlasticMisesFlow</a></li>
	        <li><a href="IsotropicStrainHardeningMisesCreep-keywords.html">IsotropicStrainHardeningMisesCreep</a></li>
	        <li><a href="MaterialLaw-keywords.html">MaterialLaw</a></li>
	        <li><a href="MaterialProperty-keywords.html">MaterialProperty</a></li>
	        <li><a href="Model-keywords.html">Model</a></li>
	        <li><a href="MultipleIsotropicMisesFlows-keywords.html">MultipleIsotropicMisesFlows</a></li>
	        <li><a href="RungeKutta-keywords.html">RungeKutta</a></li>
	        <li><a href="RungeKuttaFiniteStrain-keywords.html">RungeKuttaFiniteStrain</a></li>
	        <li><a href="RungeKuttaGenericBehaviour-keywords.html">RungeKuttaGenericBehaviour</a></li>
	        <li><a href="RungeKuttaModel-keywords.html">RungeKuttaModel</a></li>
	      </ul>
	    </li>
	    <li><a href="MTest-keywords.html">MTest keywords</a></li>
	    <li><a href="physical-constants.html">Physical constants</a></li>
	    <li><a href="glossary.html">Glossary</a></li>
	    <li><a href="publications.html">Publications</a></li>
	    <li><a href="faq.html">FAQ</a></li>
	    <li><a href="about.html">About</a></li>
	  </ul>
	</li>
	<li><a>Contributing</a>
	  <ul>
	    <li><a href="https://github.com/thelfer/tfel">Access to sources</a></li>
	    <li><a href="contributing.html">Contributing guidelines</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Report bugs</a></li>
	  </ul>
	</li>
	<li><a>Getting Help</a>
	  <ul>
	    <li><a href="search.html">Search on this site</a></li>
	    <li><a href="https://github.com/thelfer/tfel/discussions">Forum</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Bug report</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Feature request</a></li>
	    <li><a href="mailto:tfel-contact@cea.fr">Contact</a></li>
	  </ul>
	</li>
      </ul>
    </header>
<div id="header">
<h1 class="title">Non linear elasticity of the Ramberg-Osgood type</h1>
<h2 class="author">Thomas Helfer, Duc Vinh Nguyen</h2>
<h3 class="date">10/11</h3>
</div>
<div id="TOC">
<ul>
<li><a href="#description-of-the-behaviour"
id="toc-description-of-the-behaviour">Description of the
behaviour</a></li>
<li><a href="#algorithm" id="toc-algorithm">Algorithm</a>
<ul>
<li><a href="#sec:StressComputation"
id="toc-sec:StressComputation">Computation of the stress</a></li>
<li><a href="#computation-of-the-tangent-operator"
id="toc-computation-of-the-tangent-operator">Computation of the tangent
operator</a></li>
</ul></li>
<li><a href="#implementation" id="toc-implementation">Implementation</a>
<ul>
<li><a href="#choice-of-domain-specific-language"
id="toc-choice-of-domain-specific-language">Choice of domain specific
language</a></li>
<li><a href="#name-of-the-behaviour" id="toc-name-of-the-behaviour">Name
of the behaviour</a></li>
<li><a href="#metadata" id="toc-metadata">Metadata</a></li>
<li><a href="#material-properties" id="toc-material-properties">Material
properties</a></li>
<li><a href="#a-numerical-parameter" id="toc-a-numerical-parameter">A
numerical parameter</a></li>
<li><a href="#local-variables" id="toc-local-variables">Local
variables</a></li>
<li><a href="#initialisation-of-local-variables"
id="toc-initialisation-of-local-variables">Initialisation of local
variables</a></li>
<li><a href="#prediction-operator"
id="toc-prediction-operator">Prediction operator</a></li>
<li><a href="#the-behaviour-integration"
id="toc-the-behaviour-integration">The behaviour integration</a></li>
<li><a href="#first-part-of-the-computation"
id="toc-first-part-of-the-computation">First part of the
computation</a></li>
</ul></li>
<li><a href="#computation-of-the-tangent-operator-1"
id="toc-computation-of-the-tangent-operator-1">Computation of the
tangent operator</a></li>
<li><a href="#examples-of-usage" id="toc-examples-of-usage">Examples of
usage</a>
<ul>
<li><a href="#uniaxial-tensile-test"
id="toc-uniaxial-tensile-test">Uniaxial tensile test</a></li>
</ul></li>
</ul>
</div>
<p>In fracture mechanics, it is classical to replace the plastic
behaviour by an equivalent non linear elastic behaviour.</p>
<p>This document describes the implementation of non linear elastic
behaviour of the Ramberg-Osgood type using the <code>Default</code>
domain specific language of <code>MFront</code>.</p>
<p>The full implementation is available <a
href="gallery/nonlinearelasticity/RambergOsgoodNonLinearElasticity.mfront">here</a>.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>This implementation is compatible with <code>MFront-3.3</code> and
uses unicode characters (see <a href="unicode.html">this page</a> for
details).</p>
</blockquote>
<h1 id="description-of-the-behaviour">Description of the behaviour</h1>
<p>The behaviour is based on the following relationship between the
strain <span
class="math inline">\(\underline{\varepsilon}^{\mathrm{to}}\)</span> and
the stress <span class="math inline">\(\underline{\sigma}\)</span>:</p>
<p><span id="eq:sigeto"><span class="math display">\[
\underline{\varepsilon}^{\mathrm{to}}= {{\displaystyle
\frac{\displaystyle 1}{\displaystyle
3\,K}}}\,{\mathrm{tr}{\left(\underline{\sigma}\right)}}\,\underline{I}+
{{\displaystyle \frac{\displaystyle \sigma_{\mathrm{eq}}}{\displaystyle
3\,\mu}}}\,\underline{n}+
\alpha\,{\left({{\displaystyle \frac{\displaystyle
\sigma_{\mathrm{eq}}}{\displaystyle
\sigma_{0}}}}\right)}^{n}\,\underline{n}
\qquad{(1)}\]</span></span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(K\)</span> is the bulk modulus.</li>
<li><span class="math inline">\(\mu\)</span> is the shear modulus.</li>
<li><span class="math inline">\(\sigma_{0}\)</span>, <span
class="math inline">\(\alpha\)</span> and <span
class="math inline">\(n\)</span> are material properties describing the
pseudo-plastic part of the behaviour</li>
<li><span class="math inline">\(\underline{s} =
\underline{\sigma}-{{\displaystyle \frac{\displaystyle
{\mathrm{tr}{\left(\underline{\sigma}\right)}}}{\displaystyle
3}}}\,\underline{I}\)</span> is the deviatoric part of the stress
tensor.</li>
<li><span class="math inline">\(\sigma_{\mathrm{eq}}\)</span> is the von
Mises equivalent stress.</li>
<li><span class="math inline">\(\underline{n}={{\displaystyle
\frac{\displaystyle 3\,\underline{s}}{\displaystyle
2\,\sigma_{\mathrm{eq}}}}}\)</span> is the von Mises normal.</li>
</ul>
<h1 id="algorithm">Algorithm</h1>
<h2 id="sec:StressComputation">Computation of the stress</h2>
<p>Knowing the strain <span
class="math inline">\(\underline{\varepsilon}^{\mathrm{to}}\)</span>,
integration of the behaviour, which boils down to the computation of the
stress <span class="math inline">\(\underline{\sigma}\)</span>, requires
the inversion of Equation (1).</p>
<p>The projection of this equation on the volumetric axis yields:</p>
<p><span class="math display">\[
{\mathrm{tr}{\left(\underline{\sigma}\right)}}=K\,{\mathrm{tr}{\left(\underline{\varepsilon}^{\mathrm{to}}\right)}}
\]</span></p>
<p>Taking the deviatoric part of Equation (1) yields:</p>
<p><span id="eq:sigeto_dev"><span class="math display">\[
\underline{s}^{e}= {\left({{\displaystyle \frac{\displaystyle
\sigma_{\mathrm{eq}}}{\displaystyle 3\,\mu}}}+
\alpha\,{\left({{\displaystyle \frac{\displaystyle
\sigma_{\mathrm{eq}}}{\displaystyle
\sigma_{0}}}}\right)}^{n}\right)}\,\underline{n} =
f{\left(\sigma_{\mathrm{eq}}\right)}\,\underline{n}
\qquad{(2)}\]</span></span></p>
<p>Contracting each side of his equations with itself leads to:</p>
<p><span class="math display">\[
\underline{s}^{e}\,\colon\,\underline{s}^{e} =
f^{2}{\left(\sigma_{\mathrm{eq}}\right)}\,
\underline{n}\,\colon\,\underline{n} =
{{\displaystyle \frac{\displaystyle 3}{\displaystyle
2}}}\,f^{2}{\left(\sigma_{\mathrm{eq}}\right)}
\]</span></p>
<p>where we used the classical result: <span
class="math inline">\(\underline{n}\,\colon\,\underline{n}={{\displaystyle
\frac{\displaystyle 3}{\displaystyle 2}}}\)</span>.</p>
<p>Finally, <span class="math inline">\(\sigma_{\mathrm{eq}}\)</span>
satisfies:</p>
<p><span id="eq:sigmaeq"><span class="math display">\[
f{\left(\sigma_{\mathrm{eq}}\right)}=\varepsilon_{\mathrm{eq}}
\qquad{(3)}\]</span></span></p>
<p>with <span
class="math inline">\(\varepsilon_{\mathrm{eq}}=\sqrt{{{\displaystyle
\frac{\displaystyle 2}{\displaystyle
3}}}\,\underline{s}^{e}\,\colon\,\underline{s}^{e}}\)</span>.</p>
<p>The scalar Equation (3) allows resolving iteratively <span
class="math inline">\(\sigma_{\mathrm{eq}}\)</span> using a standard
Newton-Raphson algorithm. Let <span
class="math inline">\(\sigma_{\mathrm{eq}}^{(i)}\)</span> be the current
estimate of <span class="math inline">\(\sigma_{\mathrm{eq}}\)</span>,
the next estimate is given by:</p>
<p><span class="math display">\[
\sigma_{\mathrm{eq}}^{(i+1)}=\sigma_{\mathrm{eq}}^{(i)}-{{\displaystyle
\frac{\displaystyle
f{\left(\sigma_{\mathrm{eq}}^{(i)}\right)}}{\displaystyle {\displaystyle
\frac{\displaystyle \mathrm{d} f}{\displaystyle \mathrm{d}
\sigma_{\mathrm{eq}}}}{\left(\sigma_{\mathrm{eq}}^{(i)}\right)}}}}
\]</span></p>
<p>The initial estimation is choosen as follows:</p>
<p><span class="math display">\[
\sigma_{\mathrm{eq}}^{(0)}=\sigma_{0}\,\sqrt[n]{{{\displaystyle
\frac{\displaystyle \varepsilon_{\mathrm{eq}}}{\displaystyle \alpha}}}}
\]</span></p>
<p>Once <span class="math inline">\(\sigma_{\mathrm{eq}}\)</span> is
known, Equations (2) and (3) allow computing the normal <span
class="math inline">\(\underline{n}\)</span>:</p>
<p><span class="math display">\[
\underline{n}=
{{\displaystyle \frac{\displaystyle 1}{\displaystyle
f{\left(\sigma_{\mathrm{eq}}\right)}}}}\,\underline{s}^{e}=
{{\displaystyle \frac{\displaystyle 1}{\displaystyle
\varepsilon_{\mathrm{eq}}}}}\,\underline{s}^{e}
\]</span></p>
<p>The following relation allows computing the stress:</p>
<p><span class="math display">\[
\underline{\sigma}
=K\,{\mathrm{tr}{\left(\underline{\varepsilon}^{\mathrm{to}}\right)}}\,\underline{I}+\underline{s}
=K\,{\mathrm{tr}{\left(\underline{\varepsilon}^{\mathrm{to}}\right)}}\,\underline{I}+{{\displaystyle
\frac{\displaystyle 2\,\sigma_{\mathrm{eq}}}{\displaystyle
3}}}\underline{n}
=K\,{\mathrm{tr}{\left(\underline{\varepsilon}^{\mathrm{to}}\right)}}\,\underline{I}+{{\displaystyle
\frac{\displaystyle 2\,\sigma_{\mathrm{eq}}}{\displaystyle
3\,\varepsilon_{\mathrm{eq}}}}}\,\underline{s}^{e}
\]</span></p>
<p>Finally: <span id="eq:sigma"><span class="math display">\[
\underline{\sigma}=K\,{\mathrm{tr}{\left(\underline{\varepsilon}^{\mathrm{to}}\right)}}\,\underline{I}+\sigma_{\mathrm{eq}}\,\underline{n}^{e}
\qquad{(4)}\]</span></span> with <span
class="math inline">\(\underline{n}^{e}={{\displaystyle
\frac{\displaystyle 2}{\displaystyle
3\,\varepsilon_{\mathrm{eq}}}}}\,\underline{s}^{e}\)</span>.</p>
<h2 id="computation-of-the-tangent-operator">Computation of the tangent
operator</h2>
<p>The following relations will be useful: <span class="math display">\[
\begin{aligned}
{\displaystyle \frac{\displaystyle \mathrm{d}
\varepsilon_{\mathrm{eq}}}{\displaystyle \mathrm{d}
\underline{\varepsilon}^{\mathrm{to}}}}&amp;=\underline{n}^{e}\\
{\displaystyle \frac{\displaystyle \mathrm{d}
\underline{n}^{e}}{\displaystyle \mathrm{d}
\underline{\varepsilon}^{\mathrm{to}}}}&amp;=
{{\displaystyle \frac{\displaystyle 1}{\displaystyle
\varepsilon_{\mathrm{eq}}}}}{\left({{\displaystyle \frac{\displaystyle
2}{\displaystyle
3}}}\,\underline{\underline{\mathbf{P}}}-\underline{n}^{e}\,\otimes\,\underline{n}^{e}\right)}\\
\end{aligned}
\]</span> with <span
class="math inline">\(\underline{\underline{\mathbf{P}}}=\underline{\underline{\mathbf{I}}}-{{\displaystyle
\frac{\displaystyle 1}{\displaystyle
3}}}\,\underline{I}\,\otimes\,\underline{I}\)</span></p>
<p>Equation (4) allows computing the tangent operator as follows:</p>
<p><span id="eq:tangentoperator"><span class="math display">\[
{\displaystyle \frac{\displaystyle \mathrm{d}
\underline{\sigma}}{\displaystyle \mathrm{d}
\underline{\varepsilon}^{\mathrm{to}}}}=
K\,\underline{I}\,\otimes\,\underline{I}+
{\displaystyle \frac{\displaystyle \mathrm{d}
\sigma_{\mathrm{eq}}}{\displaystyle \mathrm{d}
\varepsilon_{\mathrm{eq}}}}\,\underline{n}^{e}\,\otimes\,\underline{n}^{e}+
\sigma_{\mathrm{eq}}\,{\displaystyle \frac{\displaystyle \mathrm{d}
\underline{n}^{e}}{\displaystyle \mathrm{d}
\underline{\varepsilon}^{\mathrm{to}}}}
\qquad{(5)}\]</span></span></p>
<p><span class="math inline">\({\displaystyle \frac{\displaystyle
\mathrm{d} \sigma_{\mathrm{eq}}}{\displaystyle \mathrm{d}
\varepsilon_{\mathrm{eq}}}}\)</span> is obtained by derivation of
Equation (3) as follows:</p>
<p><span id="eq:dseq_deeq"><span class="math display">\[
f{\left(\sigma_{\mathrm{eq}}{\left(\varepsilon_{\mathrm{eq}}\right)}\right)}=\varepsilon_{\mathrm{eq}}\Rightarrow
{\displaystyle \frac{\displaystyle \mathrm{d}
\sigma_{\mathrm{eq}}}{\displaystyle \mathrm{d}
\varepsilon_{\mathrm{eq}}}}={{\displaystyle \frac{\displaystyle
1}{\displaystyle {\displaystyle \frac{\displaystyle \partial
f}{\displaystyle \partial \sigma_{\mathrm{eq}}}}}}}
\qquad{(6)}\]</span></span></p>
<h1 id="implementation">Implementation</h1>
<h2 id="choice-of-domain-specific-language">Choice of domain specific
language</h2>
<p>While not mandatory (the <code>@DSL</code> keyword can be place
anywhere in the file), its is convenient to start the implementation by
declaring the domain specific language to be used. The
<code>Default</code> DSL, which does not set any particular integration
scheme, is the most appropriate here:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>DSL Default<span class="op">;</span></span></code></pre></div>
<h2 id="name-of-the-behaviour">Name of the behaviour</h2>
<p>The <code>@Behaviour</code> keyword is used to give the name of the
behaviour.</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Behaviour RambergOsgoodNonLinearElasticity<span class="op">;</span></span></code></pre></div>
<h2 id="metadata">Metadata</h2>
<p>The following instructions give some information about the author,
the date and some description of the behaviour.</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Author L<span class="op">.</span> Gelebart<span class="op">/</span>V<span class="op">.</span> Duc Nguyen<span class="op">;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Description <span class="op">{</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Ramberg-Osgood model (non-(linear elastic formulation)&quot;</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;Eps = S:Sig +β.σ_eq^n. N&quot;</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;with:&quot;</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; - N = (3/2) Sig_dev / σ_eq&quot;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; - σ_eq = rac((3/2)σ_dev:σ_dev))&quot;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot; - β = α⋅σ₀/E&quot;</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="material-properties">Material properties</h2>
<p>This behaviour is meant to be generic, which means that the specific
characteristics of the material are to be given by the calling
solver.</p>
<p>Here, we declare <span class="math inline">\(5\)</span> material
properties:</p>
<ul>
<li>Two properties associated with the elastic part of the behaviour:
the Young modulus <span class="math inline">\(E\)</span> and the Poisson
ratio <span class="math inline">\(\nu\)</span>. Although this set of
elastic properties is not the most convenient for this specific case
(the bulk modulus and the shear modulus are more appropriate), it is
compatible with the requirement of the <code>Cast3M</code> solver.</li>
<li>Three properties associated with the plastic part of the behaviour:
<span class="math inline">\(n\)</span>, <span
class="math inline">\(\alpha\)</span> and the <span
class="math inline">\(\sigma_{0}\)</span>.</li>
</ul>
<div class="sourceCode" id="cb4"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>MaterialProperty stress E<span class="op">;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>E<span class="op">.</span>setGlossaryName<span class="op">(</span><span class="st">&quot;YoungModulus&quot;</span><span class="op">);</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>MaterialProperty real ν<span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>ν<span class="op">.</span>setGlossaryName<span class="op">(</span><span class="st">&quot;PoissonRatio&quot;</span><span class="op">);</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>MaterialProperty real n<span class="op">;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>MaterialProperty real α<span class="op">;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>α<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;alpha&quot;</span><span class="op">);</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>MaterialProperty stress σ₀<span class="op">;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>σ₀<span class="op">.</span>setGlossaryName<span class="op">(</span><span class="st">&quot;YieldStrength&quot;</span><span class="op">);</span></span></code></pre></div>
<p>Here, we use the subset of UTF-8 characters supported by
<code>MFront</code> (See <a href="unicode.html">this page</a> for
details) to define the variables. Note that it is important to associate
so called external names to those variables using one of the
<code>setEntryName</code> and <code>setGlossaryName</code> methods: it
is highly recommended that the external names only contains
<code>ASCII</code> characters.</p>
<h2 id="a-numerical-parameter">A numerical parameter</h2>
<p>The following numerical parameter will be used as threshold to avoid
division by zero.</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">//! Numerical threshold </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Parameter real e_ε <span class="op">=</span> <span class="fl">1e-12</span><span class="op">;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>e_ε<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;NumericalThreshold&quot;</span><span class="op">);</span></span></code></pre></div>
<h2 id="local-variables">Local variables</h2>
<p>The following local variables are used:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">//! the shear modulus</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>LocalVariable stress μ<span class="op">;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">//! the bulk modulus</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>LocalVariable stress K<span class="op">;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">//! an helper variable</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>LocalVariable real β<span class="op">;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">//! von Mises equivalent stress</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>LocalVariable stress σₑ<span class="op">;</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co">/*!</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"> * derivative of the von Mises equivalent stress</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"> * with respect to the equivalent strain</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>LocalVariable stress ∂σₑ∕∂εₑ<span class="op">;</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">//! the equivalent strain</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>LocalVariable strain εₑ<span class="op">;</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">//! inverse of the equivalent strain</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>LocalVariable real iεₑ<span class="op">;</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">//! normal associated with the deviatoric part of the strain</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>LocalVariable StrainStensor ne<span class="op">;</span></span></code></pre></div>
<p>Local variables are available in each code blocks.</p>
<h2 id="initialisation-of-local-variables">Initialisation of local
variables</h2>
<p>The initialisation of local variables is devoted to the
<code>@InitLocalVariables</code>.</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>InitLocalVariables <span class="op">{</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  μ <span class="op">=</span> computeMu<span class="op">(</span>E<span class="op">,</span> ν<span class="op">);</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  K <span class="op">=</span> E <span class="op">/</span> <span class="op">(</span><span class="dv">3</span> ⋅ <span class="op">(</span><span class="dv">1</span> <span class="op">-</span> <span class="dv">2</span> ⋅ ν<span class="op">));</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  β <span class="op">=</span> α ⋅ σ₀ <span class="op">/</span> E<span class="op">;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  σₑ <span class="op">=</span> stress<span class="op">{};</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  ∂σₑ∕∂εₑ <span class="op">=</span> stress<span class="op">{};</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Note that we use here the symbol <code>⋅</code> in place of
<code>*</code> as the multiplication sign. Both are equivalent.</p>
<p>The statement <code>σₑ = stress{};</code> initializes <code>σₑ</code>
to a default value (which is <code>0</code>).</p>
<h2 id="prediction-operator">Prediction operator</h2>
<p>The prediction operator can used by <code>code_aster</code> to
initialize the algorithm used to find the equilibrium. Here we only
implement an elastic prediction operator.</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>PredictionOperator<span class="op">{</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> P <span class="op">=</span> I₄ <span class="op">-</span> <span class="op">(</span>I₂ ⊗ I₂<span class="op">)</span> <span class="op">/</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  Dt <span class="op">=</span> K ⋅ <span class="op">(</span>I₂ ⊗ I₂<span class="op">)</span> <span class="op">+</span> <span class="dv">2</span> ⋅ μ ⋅ P<span class="op">;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>where:</p>
<ul>
<li><code>I₄</code> is the fourth order identity tensor (of type
<code>st2tost2</code>, i.e. a fourth order tensor which transforms a
symmetric tensor to a a symmetric tensor).</li>
<li><code>I₂</code> is the second order identity symmetric tensor</li>
<li><code>⊗</code> is the tensorial product. It is equivalent to the
<code>^</code> characters.</li>
</ul>
<h2 id="the-behaviour-integration">The behaviour integration</h2>
<p>The behaviour integration is <code>@Integrator</code>.</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Integrator<span class="op">{</span></span></code></pre></div>
<p>The integrator part is divided in three parts:</p>
<ul>
<li>The first part computes some useful variables.</li>
<li>The second part deals with the computation of the von Mises stress
<code>σₑ</code> and its derivative <code>∂σₑ∕∂εₑ</code>.</li>
<li>The last part computes the stress tensor.</li>
</ul>
<h2 id="first-part-of-the-computation">First part of the
computation</h2>
<p>The first part computes the strain at the end of the time step, its
deviatoric part, the equivalent strain and the normal.</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> ε <span class="op">=</span> εᵗᵒ <span class="op">+</span> Δεᵗᵒ<span class="op">;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> se <span class="op">=</span> deviator<span class="op">(</span>ε<span class="op">);</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  εₑ <span class="op">=</span> sqrt<span class="op">(</span><span class="dv">2</span> ⋅ <span class="op">(</span>se <span class="op">|</span> se<span class="op">)</span> <span class="op">/</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  iεₑ <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> max<span class="op">(</span>εₑ<span class="op">,</span> e_ε<span class="op">);</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  ne <span class="op">=</span> <span class="dv">2</span> ⋅ se ⋅ <span class="op">(</span>iεₑ <span class="op">/</span> <span class="dv">3</span><span class="op">);</span></span></code></pre></div>
<h3
id="computation-of-the-von-mises-stress-and-its-derivative">Computation
of the von Mises stress and its derivative</h3>
<p>The following code computes the von Mises stress and its
derivative:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>εₑ <span class="op">&lt;</span> e_ε<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    σₑ <span class="op">=</span> <span class="dv">3</span> ⋅ μ ⋅ εₑ<span class="op">;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    ∂σₑ∕∂εₑ <span class="op">=</span> <span class="dv">3</span> ⋅ μ<span class="op">;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="kw">auto</span> e_σ <span class="op">=</span> E ⋅ e_ε<span class="op">;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="kw">auto</span> i3μ <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> <span class="op">(</span><span class="dv">3</span> ⋅ μ<span class="op">);</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> f <span class="op">=</span> real<span class="op">{};</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> fidf <span class="op">=</span> <span class="op">[&amp;]()</span> <span class="op">{</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">const</span> <span class="kw">auto</span> rσₑⁿ <span class="op">=</span> pow<span class="op">(</span>σₑ <span class="op">/</span> σ₀<span class="op">,</span> n<span class="op">);</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">const</span> <span class="kw">auto</span> iσₑ <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> max<span class="op">(</span>e_σ<span class="op">,</span> σₑ<span class="op">);</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>      f <span class="op">=</span> σₑ ⋅ i3μ <span class="op">+</span> β ⋅ rσₑⁿ <span class="op">-</span> εₑ<span class="op">;</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>      ∂σₑ∕∂εₑ <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> max<span class="op">(</span>i3μ <span class="op">+</span> n ⋅ β ⋅ rσₑⁿ ⋅ iσₑ<span class="op">,</span> i3μ ⋅ e_ε<span class="op">);</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    σₑ <span class="op">=</span> σ₀ ⋅ pow<span class="op">(</span>εₑ <span class="op">/</span> β<span class="op">,</span> <span class="dv">1</span> <span class="op">/</span> n<span class="op">);</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">auto</span> iter <span class="op">=</span> <span class="dt">int</span><span class="op">{};</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    fidf<span class="op">();</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>abs<span class="op">(</span>f<span class="op">)</span> <span class="op">&gt;</span> e_ε<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>      fidf<span class="op">();</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>      σₑ <span class="op">-=</span> f ⋅ ∂σₑ∕∂εₑ<span class="op">;</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(++</span>iter <span class="op">&gt;</span> <span class="dv">20</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">throw</span><span class="op">(</span>DivergenceException<span class="op">());</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span></code></pre></div>
<p>If the equivalent strain is below the numerical threshold, a solution
corresponding to an elastic behaviour is returned.</p>
<p>In the other case, a local Newton algorithm is used to determine
<code>σₑ</code> and <code>∂σₑ∕∂εₑ</code>, as described by Section 2.1.
Except for the usage of a lambda function called <code>ifdf</code>, the
code is quite easy to read. A lambda function can be seen as a local
function which allows to factorise the code computing the residual and
its derivative. The syntax <code>[&amp;]</code> means that the lambda
function of has access to all the variables of the surrounding scope by
references. Note that we used Equation (6) to identify <span
class="math inline">\({{\displaystyle \frac{\displaystyle
1}{\displaystyle {\displaystyle \frac{\displaystyle \mathrm{d}
f}{\displaystyle \mathrm{d} \sigma_{\mathrm{eq}}}}}}}\)</span> to
<code>∂σₑ∕∂εₑ</code>.</p>
<h3 id="computation-of-the-stress">Computation of the stress</h3>
<p>The computation of the stress is a direct translation of Equation
(4):</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>  σ <span class="op">=</span> K ⋅ trace<span class="op">(</span>ε<span class="op">)</span> ⋅ I₂ <span class="op">+</span> σₑ ⋅ ne<span class="op">;</span></span></code></pre></div>
<h3 id="finalisation">Finalisation</h3>
<p>The <code>@Integrator</code> code block ends with a final curly
brace.</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="co">// end of @Integrator</span></span></code></pre></div>
<h1 id="computation-of-the-tangent-operator-1">Computation of the
tangent operator</h1>
<p>The following block compute the tangent operator using Equation
(5):</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>TangentOperator<span class="op">{</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> P <span class="op">=</span> I₄ <span class="op">-</span> <span class="op">(</span>I₂ ⊗ I₂<span class="op">)</span> <span class="op">/</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">((</span>smt <span class="op">==</span> ELASTIC<span class="op">)</span> <span class="op">||</span> <span class="op">(</span>smt <span class="op">==</span> SECANTOPERATOR<span class="op">))</span> <span class="op">{</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    Dt <span class="op">=</span> K ⋅ <span class="op">(</span>I₂ ⊗ I₂<span class="op">)</span> <span class="op">+</span> <span class="dv">2</span> ⋅ μ ⋅ P<span class="op">;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>εₑ <span class="op">&lt;</span> e_ε<span class="op">)</span> <span class="op">{</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>      Dt <span class="op">=</span> K ⋅ <span class="op">(</span>I₂ ⊗ I₂<span class="op">)</span> <span class="op">+</span> <span class="dv">2</span> ⋅ μ ⋅ P<span class="op">;</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>      Dt <span class="op">=</span> K ⋅ <span class="op">(</span>I₂ ⊗ I₂<span class="op">)</span> <span class="op">+</span> ∂σₑ∕∂εₑ ⋅ <span class="op">(</span>ne ⊗ ne<span class="op">)</span> <span class="op">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>           σₑ ⋅ iεₑ ⋅ <span class="op">(</span><span class="dv">2</span> ⋅ P <span class="op">/</span> <span class="dv">3</span> <span class="op">-</span> <span class="op">(</span>ne ⊗ ne<span class="op">));</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="examples-of-usage">Examples of usage</h1>
<h2 id="uniaxial-tensile-test">Uniaxial tensile test</h2>
<figure>
<img
src="./img/RambergOsgoodNonLinearElasticity-UniaxialTensileTest.png"
title="Result of an uniaxial tensile test"
alt="Result of an uniaxial tensile test" />
<figcaption aria-hidden="true">Result of an uniaxial tensile
test</figcaption>
</figure>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-62273823-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
