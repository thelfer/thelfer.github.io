<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-EN" xml:lang="en-EN">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="generator" content="pandoc" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Numerical integration in the TFEL/Math library</title>
        <meta name="author" content="Thomas Helfer" />
            <meta name="date" content="2025-12-10" />
        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <style type="text/css">code{white-space: pre;}</style>
            <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {  background-color: #f8f8f8; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span.al { color: #ef2929; } /* Alert */
      code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { color: #204a87; } /* Attribute */
      code span.bn { color: #0000cf; } /* BaseN */
      code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #4e9a06; } /* Char */
      code span.cn { color: #8f5902; } /* Constant */
      code span.co { color: #8f5902; font-style: italic; } /* Comment */
      code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
      code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
      code span.dt { color: #204a87; } /* DataType */
      code span.dv { color: #0000cf; } /* DecVal */
      code span.er { color: #a40000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #0000cf; } /* Float */
      code span.fu { color: #204a87; font-weight: bold; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
      code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
      code span.ot { color: #8f5902; } /* Other */
      code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
      code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
      code span.ss { color: #4e9a06; } /* SpecialString */
      code span.st { color: #4e9a06; } /* String */
      code span.va { color: #000000; } /* Variable */
      code span.vs { color: #4e9a06; } /* VerbatimString */
      code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    </style>
            <link rel="stylesheet" href="css/normalize.css"/>
    <link rel="stylesheet" href="css/main.css"/>
        <script
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
        type="text/javascript"></script>
            
      </head>
  <body>
    <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
        <header>
      <ul id="nav">
	<li><a href="news.html">News</a></li>
	<li><a href="index.html">Overview</a>
	  <ul>
	    <li><a>Domain specific languages</a>
	      <ul>
		<li><a href="material-properties.html">Material properties</a></li>
		<li><a href="behaviours.html">Mechanical behaviours</a></li>
		<li><a href="models.html">Models</a></li>
	      </ul>
            </li>
	    <li><a href="interfaces.html">Available interfaces</a></li>
	    <li><a href="associated-projects.html">Associated projects</a></li>
	  </ul>
	</li>
	<li><a>Getting started</a>
	  <ul>
	    <li><a href="https://github.com/thelfer/tfel/">Github repository</a></li>
	    <li><a href="https://github.com/thelfer/tfel/releases">Download</a></li>
	    <li><a href="release-notes.html">Release notes</a>
	      <ul>
		<li><a>Versions 2.0.x</a>
                  <ul>
                    <li><a href="release-notes.html">Versions prior to 2.0.5</a></li>
	 	    <li><a href="release-notes-2.0.5.html">Version 2.0.5</a></li>
                  </ul>
		</li>
		<li><a>Versions 3.0.x</a>
                  <ul>
		    <li><a href="release-notes-3.0.html">Version 3.0.0</a></li>
		    <li><a href="release-notes-3.0.1.html">Version 3.0.1</a></li>
		    <li><a href="release-notes-3.0.2.html">Version 3.0.2</a></li>
		    <li><a href="release-notes-3.0.3.html">Version 3.0.3</a></li>
		    <li><a href="release-notes-3.0.4.html">Version 3.0.4</a></li>
		    <li><a href="release-notes-3.0.5.html">Version 3.0.5</a></li>
		    <li><a href="release-notes-3.0.6.html">Version 3.0.6</a></li>
		    <li><a href="release-notes-3.0.7.html">Version 3.0.7</a></li>
		    <li><a href="release-notes-3.0.8.html">Version 3.0.8</a></li>
		    <li><a href="release-notes-3.0.9.html">Version 3.0.9</a></li>
		    <li><a href="release-notes-3.0.10.html">Version 3.0.10</a></li>
		    <li><a href="release-notes-3.0.11.html">Version 3.0.11</a></li>
		    <li><a href="release-notes-3.0.12.html">Version 3.0.12</a></li>
		    <li><a href="release-notes-3.0.13.html">Version 3.0.13</a></li>
		    <li><a href="release-notes-3.0.14.html">Version 3.0.14</a></li>
		    <li><a href="release-notes-3.0.15.html">Version 3.0.15</a></li>
		    <li><a href="release-notes-3.0.16.html">Version 3.0.16</a></li>
		    <li><a href="release-notes-3.0.17.html">Version 3.0.17</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.1.x</a>
		  <ul>
		    <li><a href="release-notes-3.1.html">Version 3.1.0</a></li>
		    <li><a href="release-notes-3.1.1.html">Version 3.1.1</a></li>
		    <li><a href="release-notes-3.1.2.html">Version 3.1.2</a></li>
		    <li><a href="release-notes-3.1.3.html">Version 3.1.3</a></li>
		    <li><a href="release-notes-3.1.4.html">Version 3.1.4</a></li>
		    <li><a href="release-notes-3.1.5.html">Version 3.1.5</a></li>
		    <li><a href="release-notes-3.1.6.html">Version 3.1.6</a></li>
		    <li><a href="release-notes-3.1.7.html">Version 3.1.7</a></li>
		    <li><a href="release-notes-3.1.8.html">Version 3.1.8</a></li>
		    <li><a href="release-notes-3.1.9.html">Version 3.1.9</a></li>
		    <li><a href="release-notes-3.1.10.html">Version 3.1.10</a></li>
		    <li><a href="release-notes-3.1.11.html">Version 3.1.11</a></li>
		    <li><a href="release-notes-3.1.12.html">Version 3.1.12</a></li>
		    <li><a href="release-notes-3.1.13.html">Version 3.1.13</a></li>
		    <li><a href="release-notes-3.1.14.html">Version 3.1.14</a></li>
		    <li><a href="release-notes-3.1.15.html">Version 3.1.15</a></li>
		    <li><a href="release-notes-3.1.16.html">Version 3.1.16</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.2.x</a>
		  <ul>
		    <li><a href="release-notes-3.2.html">Version 3.2.0</a></li>
		    <li><a href="release-notes-3.2.1.html">Version 3.2.1</a></li>
		    <li><a href="release-notes-3.2.2.html">Version 3.2.2</a></li>
		    <li><a href="release-notes-3.2.3.html">Version 3.2.3</a></li>
		    <li><a href="release-notes-3.2.4.html">Version 3.2.4</a></li>
		    <li><a href="release-notes-3.2.5.html">Version 3.2.5</a></li>
		    <li><a href="release-notes-3.2.6.html">Version 3.2.6</a></li>
		    <li><a href="release-notes-3.2.7.html">Version 3.2.7</a></li>
		    <li><a href="release-notes-3.2.8.html">Version 3.2.8</a></li>
		    <li><a href="release-notes-3.2.9.html">Version 3.2.9</a></li>
		    <li><a href="release-notes-3.2.10.html">Version 3.2.10</a></li>
		    <li><a href="release-notes-3.2.11.html">Version 3.2.11</a></li>
		    <li><a href="release-notes-3.2.12.html">Version 3.2.12</a></li>
		    <li><a href="release-notes-3.2.13.html">Version 3.2.13</a></li>
		    <li><a href="release-notes-3.2.14.html">Version 3.2.14</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.3.x</a>
		  <ul>
		    <li><a href="release-notes-3.3.html">Version 3.3.0</a></li>
		    <li><a href="release-notes-3.3.1.html">Version 3.3.1</a></li>
		    <li><a href="release-notes-3.3.1.html">Version 3.3.2</a></li>
		    <li><a href="release-notes-3.3.2.html">Version 3.3.2</a></li>
		    <li><a href="release-notes-3.3.3.html">Version 3.3.3</a></li>
		    <li><a href="release-notes-3.3.4.html">Version 3.3.4</a></li>
		    <li><a href="release-notes-3.3.5.html">Version 3.3.5</a></li>
		    <li><a href="release-notes-3.3.6.html">Version 3.3.6</a></li>
		    <li><a href="release-notes-3.3.7.html">Version 3.3.7</a></li>
		    <li><a href="release-notes-3.3.7.html">Version 3.3.8</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.4.x</a>
		  <ul>
		    <li><a href="release-notes-3.4.html">Version 3.4.0</a></li>
		    <li><a href="release-notes-3.4.1.html">Version 3.4.1</a></li>
		    <li><a href="release-notes-3.4.2.html">Version 3.4.2</a></li>
		    <li><a href="release-notes-3.4.3.html">Version 3.4.3</a></li>
		    <li><a href="release-notes-3.4.4.html">Version 3.4.4</a></li>
		    <li><a href="release-notes-3.4.5.html">Version 3.4.5</a></li>
		    <li><a href="release-notes-3.4.6.html">Version 3.4.6</a></li>
		    <li><a href="release-notes-3.4.7.html">Version 3.4.7</a></li>
		    <li><a href="release-notes-3.4.8.html">Version 3.4.8</a></li>
		    <li><a href="release-notes-3.4.9.html">Version 3.4.9</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.0.x</a>
		  <ul>
		    <li><a href="release-notes-4.0.html">Version 4.0.0</a></li>
		    <li><a href="release-notes-4.0.1.html">Version 4.0.1</a></li>
		    <li><a href="release-notes-4.0.2.html">Version 4.0.2</a></li>
		    <li><a href="release-notes-4.0.3.html">Version 4.0.3</a></li>
		    <li><a href="release-notes-4.0.4.html">Version 4.0.4</a></li>
		    <li><a href="release-notes-4.0.5.html">Version 4.0.5</a></li>
		    <li><a href="release-notes-4.0.6.html">Version 4.0.6</a></li>
		    <li><a href="release-notes-4.0.7.html">Version 4.0.7</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.1.x</a>
		  <ul>
		    <li><a href="release-notes-4.1.html">Version 4.1.0</a></li>
		    <li><a href="release-notes-4.1.1.html">Version 4.1.1</a></li>
		    <li><a href="release-notes-4.1.2.html">Version 4.1.2</a></li>
		    <li><a href="release-notes-4.1.3.html">Version 4.1.3</a></li>
		    <li><a href="release-notes-4.1.4.html">Version 4.1.4</a></li>
		    <li><a href="release-notes-4.1.5.html">Version 4.1.5</a></li>
		    <li><a href="release-notes-4.1.6.html">Version 4.1.6</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.2.x</a>
		  <ul>
		    <li><a href="release-notes-4.2.html">Version 4.2.0</a></li>
		    <li><a href="release-notes-4.2.1.html">Version 4.2.1</a></li>
		    <li><a href="release-notes-4.2.2.html">Version 4.2.2</a></li>
		    <li><a href="release-notes-4.2.3.html">Version 4.2.3</a></li>
		    <li><a href="release-notes-4.2.4.html">Version 4.2.4</a></li>
		    <li><a href="release-notes-4.2.5.html">Version 4.2.5</a></li>
		    <li><a href="release-notes-4.2.6.html">Version 4.2.6</a></li>
		  </ul>
		</li>
		<li><a>Versions 5.0.x</a>
		  <ul>
		    <li><a href="release-notes-5.0.html">Version 5.0.0</a></li>
		    <li><a href="release-notes-5.0.1.html">Version 5.0.1</a></li>
		    <li><a href="release-notes-5.0.2.html">Version 5.0.2</a></li>
		    <li><a href="release-notes-5.0.3.html">Version 5.0.3</a></li>
		  </ul>
		</li>
		<li><a>Versions 5.1.x</a>
		  <ul>
		    <li><a href="release-notes-5.1.html">Version 5.1.0</a></li>
		    <li><a href="release-notes-5.1.1.html">Version 5.1.1</a></li>
		  </ul>
		</li>
		<li><a>Versions 5.2.x</a>
		  <ul>
		    <li><a href="release-notes-5.1.html">Version 5.2.0</a></li>
		  </ul>
		</li>
	      </ul>
	    </li>
	    <li><a href="coverity-scan.html">Coverity scan</a></li>
	    <li><a href="install.html">Installation</a></li>
	  </ul>
	</li>
	<li><a>Documentation</a>
	  <ul>
	    <li><a href="documentations.html">General documentation</a></li>
	    <li><a href="gallery.html">Gallery</a></li>
	    <li><a href="https://thelfer.github.io/tfel/doxygen/index.html">Doxygen documentation</a></li>
	    <li><a>MFront</a>
	      <ul>
		<li><a href="tutorial.html">Tutorial</a></li>
		<li><a href="implicit-dsl.html">The Implicit DSL</a></li>
		<li><a href="benchmark.html">Benchmark</a></li>
		<li><a href="parameters.html">Parameters</a></li>
		<li><a href="BehaviourBricks.html">Behaviour bricks</a></li>
                 <li><a href="behaviour-variable.html">behaviour variables</a></li>
		<li><a href="interfaces.html">Solver interfaces</a>
		  <ul>
		    <li><a href="castem.html">Cast3M</a></li>
		    <li><a href="amitex.html">AMITEX_FFTP</a></li>
		    <li><a href="aster.html">Code-Aster</a></li>
    		    <li><a href="abaqus.html">Abaqus</a></li>
		    <li><a href="zmat.html">ZeBuLoN</a></li>
   		    <li><a href="calculix.html">CalculiX</a></li>
		    <!-- <li><a >TMFFT</a></li> -->
		    <li><a href="cyrano.html">Cyrano</a></li>
   		    <li><a href="generic-material-property-interface.html">Generic interface for material properties</a></li>
   		    <li><a href="generic-behaviours-interface.html">Generic interface for behaviours</a></li>
		  </ul>
		</li>
                 <li><a>MFront keywords</a>
    	              <ul>
    	        <li><a href="Default-keywords.html">Default</a></li>
    	        <li><a href="DefaultCZM-keywords.html">DefaultCZM</a></li>
    	        <li><a href="DefaultFiniteStrain-keywords.html">DefaultFiniteStrain</a></li>
    	        <li><a href="DefaultGenericBehaviour-keywords.html">DefaultGenericBehaviour</a></li>
    	        <li><a href="DefaultModel-keywords.html">DefaultModel</a></li>
    	        <li><a href="Implicit-keywords.html">Implicit</a></li>
    	        <li><a href="ImplicitCZM-keywords.html">ImplicitCZM</a></li>
    	        <li><a href="ImplicitFiniteStrain-keywords.html">ImplicitFiniteStrain</a></li>
    	        <li><a href="ImplicitGenericBehaviour-keywords.html">ImplicitGenericBehaviour</a></li>
    	        <li><a href="ImplicitModel-keywords.html">ImplicitModel</a></li>
    	        <li><a href="ImplicitII-keywords.html">ImplicitII</a></li>
    	        <li><a href="IsotropicMisesCreep-keywords.html">IsotropicMisesCreep</a></li>
    	        <li><a href="IsotropicMisesPlasticFlow-keywords.html">IsotropicMisesPlasticFlow</a></li>
    	        <li><a href="IsotropicPlasticMisesFlow-keywords.html">IsotropicPlasticMisesFlow</a></li>
    	        <li><a href="IsotropicStrainHardeningMisesCreep-keywords.html">IsotropicStrainHardeningMisesCreep</a></li>
    	        <li><a href="MaterialLaw-keywords.html">MaterialLaw</a></li>
    	        <li><a href="MaterialProperty-keywords.html">MaterialProperty</a></li>
    	        <li><a href="Model-keywords.html">Model</a></li>
    	        <li><a href="MultipleIsotropicMisesFlows-keywords.html">MultipleIsotropicMisesFlows</a></li>
    	        <li><a href="RungeKutta-keywords.html">RungeKutta</a></li>
    	        <li><a href="RungeKuttaFiniteStrain-keywords.html">RungeKuttaFiniteStrain</a></li>
    	        <li><a href="RungeKuttaGenericBehaviour-keywords.html">RungeKuttaGenericBehaviour</a></li>
    	        <li><a href="RungeKuttaModel-keywords.html">RungeKuttaModel</a></li>
    	      </ul>
                </li>
	      </ul>
	    </li>
	    <li><a href="mtest.html">MTest</a>
               <ul>
	      <li><a href="ptest.html">Simulation of pipes</a></li>
	      <li><a href="mtest-nonlinear-constraints.html">Nonlinear constraints</a></li>
              <li><a href="MTest-keywords.html">MTest keywords</a></li>
	      </ul>
            </li>
     	    <li><a>Tools</a>
	      <ul>
	        <li><a href="mfront-doc.html">mfront-doc</a></li>
	        <li><a href="mfm.html">mfm</a></li>
	        <li><a href="mfm-test-generator.html">mfm-test-generator</a></li>
	        <li><a href="tfel-check.html">tfel-check</a></li>
	      </ul>
	    </li>
	    <li><a>TFEL libraries</a>
	      <ul>
		<li><a href="libraries_usage.html">Usage of the TFEL libraries in C++</a></li>
		<li><a href="tfel-math.html">TFEL/Math</a></li>
                 <ul>
		  <li><a href="tfel-math-numerical-integration.html">Numerical integeration</a></li>
		  <li><a href="tfel-math-data-interpolation.html">Data interpolation</a></li>
	        </ul>
		<li><a href="tfel-material.html">TFEL/Material</a></li>
                 <li><a href="glossary.html">Glossary</a></li>
                 <li><a href="physical-constants.html">Physical constants</a></li>
		<li><a href="tfel-mfront-database.html">TFELMFrontDatabase</a></li>
	      </ul>
	    </li>
	    <li><a>Python modules</a>
	      <ul>
		<li><a href="tfel-python.html">TFEL modules</a></li>
		<li><a href="mfront-python.html">mfront module</a></li>
		<li><a href="mtest-python.html">mtest module</a></li>
	      </ul>
	    </li>
	    <li><a href="publications.html">Publications</a></li>
	    <li><a href="faq.html">FAQ</a></li>
	    <li><a href="about.html">About</a></li>
	  </ul>
	</li>
	<li><a>Contributing</a>
	  <ul>
	    <li><a href="https://github.com/thelfer/tfel">Access to sources</a></li>
	    <li><a href="contributing.html">Contributing guidelines</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Report bugs</a></li>
	  </ul>
	</li>
	<li><a>Getting Help</a>
	  <ul>
	    <li><a href="search.html">Search on this site</a></li>
	    <li><a href="https://github.com/thelfer/tfel/discussions">Forum</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Bug report</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Feature request</a></li>
	    <li><a href="mailto:tfel-contact@cea.fr">Contact</a></li>
	  </ul>
	</li>
      </ul>
    </header>
<div id="header">
<h1 class="title">Numerical integration in the <code>TFEL/Math</code>
library</h1>
<h2 class="author">Thomas Helfer</h2>
<h3 class="date">12/10/2025</h3>
</div>
<div id="TOC">
<ul>
<li><a href="#d-integration" id="toc-d-integration"><span
class="toc-section-number">1</span> 1D integration</a>
<ul>
<li><a href="#gauss-kronrod-adapative-scheme"
id="toc-gauss-kronrod-adapative-scheme"><span
class="toc-section-number">1.1</span> Gauss-Kronrod adapative
scheme</a></li>
</ul></li>
</ul>
</div>
<p>Numerical integration refers to algorithms meant to evaluate
numerically integrals. Such an algorithm is also known as quadarature
rule.</p>
<h1 data-number="1" id="d-integration"><span
class="header-section-number">1</span> 1D integration</h1>
<h2 data-number="1.1" id="gauss-kronrod-adapative-scheme"><span
class="header-section-number">1.1</span> Gauss-Kronrod adapative
scheme</h2>
<p>The <code>GaussKronrodQuadrature</code> class provides an
implementation of the Kronrod’s 15 pts quadrature rule with an estimate
of the error based on the comparison of Gauss’ 7pts rule with only the
15 evaluations of the function required by the Kronrod’s quadrature.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>The implementation in <code>TFEL/Math</code> is strongly inspired by
the implementation available in the <code>boost::math</code>
library.</p>
</blockquote>
<h3 data-number="1.1.1" id="treatment-of-unbouded-intervals"><span
class="header-section-number">1.1.1</span> Treatment of unbouded
intervals</h3>
<p>If any of the integration interval is finite, a change of variable is
automatically perform to perform an integration on the interval <span
class="math inline">\([-1, 1]\)</span>:</p>
<ul>
<li>when integrating from <span class="math inline">\([-\infty,
b]\)</span>, the following change of variable is performed: <span
class="math display">\[
u\left(x\right)= b-\left(\frac{2}{1+x}-1\right)
\]</span></li>
<li>when integrating from <span class="math inline">\([a,
\infty]\)</span>, the following change of variable is performed: <span
class="math display">\[
u\left(x\right)= \left(\frac{2}{1+x}-1\right) +a
\]</span></li>
<li>when integrating from <span class="math inline">\([-\infty,
\infty]\)</span>, the following change of variable is performed: <span
class="math display">\[
u\left(x\right) = \frac{x}{1 - x^2}
\]</span></li>
</ul>
<p>This estimation of the error can be used to refine the integration
interval to ensure that the final error is below a given bound.</p>
<h3 data-number="1.1.2" id="adaptative-refinements"><span
class="header-section-number">1.1.2</span> Adaptative refinements</h3>
<p>The estimate of the error allows to divide the integration interval
<span class="math inline">\([a, b]\)</span> to match a user defined
tolerance. In the tolerance, the interval is divided in <span
class="math inline">\(2\)</span> and in the integration is performed
recusively on the left interval and the right interval: on each of those
intervals, the tolerance is divided by two, which is conservative. This
procedure is performed up to a user defined maximum number of
refinements.</p>
<blockquote>
<p><strong>Note</strong></p>
<p>Note that if <span class="math inline">\(n\)</span> is the maximum
number of refinements, the minimal interval is as small as <span
class="math inline">\(\frac{b-a}{2^{n}}\)</span>.</p>
</blockquote>
<h3 data-number="1.1.3" id="example-of-usage"><span
class="header-section-number">1.1.3</span> Example of usage</h3>
<h4 data-number="1.1.3.1" id="standard-interval"><span
class="header-section-number">1.1.3.1</span> Standard interval:</h4>
<p>Let <span class="math inline">\(f_{1}\)</span> be the defined by:
<span class="math display">\[
f_{1}\left(x\right) = \exp\left(-x^2\right)
\]</span></p>
<p>The following code computes an approximation of the integral <span
class="math inline">\(\displaystyle\int_{0}^{10}f_{1}\left(x\right)\,\mathrm{d}x\)</span>:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">auto</span> a <span class="op">=</span> <span class="dt">double</span><span class="op">{};</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">auto</span> b <span class="op">=</span> <span class="dt">double</span><span class="op">{</span><span class="dv">10</span><span class="op">};</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="kw">auto</span> oi <span class="op">=</span> tfel<span class="op">::</span>math<span class="op">::</span>gauss_kronrod_integrate<span class="op">(</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">[](</span><span class="at">const</span> <span class="dt">double</span> x<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> <span class="bu">std::</span>exp<span class="op">(-</span>x <span class="op">*</span> x<span class="op">);</span> <span class="op">},</span> a<span class="op">,</span> b<span class="op">,</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{.</span>absolute_tolerance <span class="op">=</span> <span class="fl">1e-12</span><span class="op">,</span> <span class="op">.</span>maximum_number_of_refinements <span class="op">=</span> <span class="dv">8</span><span class="op">});</span></span></code></pre></div>
<h4 data-number="1.1.3.2" id="unbounded-intervals"><span
class="header-section-number">1.1.3.2</span> Unbounded intervals</h4>
<p>Let <span class="math inline">\(f_{2}\)</span> be the defined by:
<span class="math display">\[
f_{2}\left(x\right) =
\frac{\mathrm{d}}{\mathrm{d}x}\left(\arctan(x)\right)=\frac{1}{1+x^2}
\]</span></p>
<p>The following code computes an approximation of the integral <span
class="math inline">\(\displaystyle\int_{-\infty}^{0}f_{2}\left(x\right)\,\mathrm{d}x\)</span>:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="kw">auto</span> or2 <span class="op">=</span> tfel<span class="op">::</span>math<span class="op">::</span>gauss_kronrod_integrate<span class="op">(</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    f1<span class="op">,</span> <span class="op">-</span><span class="bu">std::</span>numeric_limits<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;::</span>max<span class="op">(),</span> <span class="dt">double</span><span class="op">{},</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{.</span>absolute_tolerance <span class="op">=</span> <span class="fl">1e-12</span><span class="op">,</span> <span class="op">.</span>maximum_number_of_refinements <span class="op">=</span> <span class="dv">8</span><span class="op">});</span></span></code></pre></div>
<p>The following code computes an approximation of the integral <span
class="math inline">\(\displaystyle\int_{0}^{\infty}f_{2}\left(x\right)\,\mathrm{d}x\)</span>:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="kw">auto</span> or3 <span class="op">=</span> tfel<span class="op">::</span>math<span class="op">::</span>gauss_kronrod_integrate<span class="op">(</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    f1<span class="op">,</span> <span class="dt">double</span><span class="op">{},</span> <span class="bu">std::</span>numeric_limits<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;::</span>max<span class="op">(),</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{.</span>absolute_tolerance <span class="op">=</span> <span class="fl">1e-12</span><span class="op">,</span> <span class="op">.</span>maximum_number_of_refinements <span class="op">=</span> <span class="dv">8</span><span class="op">});</span></span></code></pre></div>
<p>The following code computes an approximation of the integral <span
class="math inline">\(\displaystyle\int_{-\infty}^{\infty}f_{2}\left(x\right)\,\mathrm{d}x\)</span>:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="kw">auto</span> or4 <span class="op">=</span> tfel<span class="op">::</span>math<span class="op">::</span>gauss_kronrod_integrate<span class="op">(</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    f1<span class="op">,</span> <span class="op">-</span><span class="bu">std::</span>numeric_limits<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;::</span>max<span class="op">(),</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">std::</span>numeric_limits<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;::</span>max<span class="op">(),</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">{.</span>absolute_tolerance <span class="op">=</span> <span class="fl">1e-12</span><span class="op">,</span> <span class="op">.</span>maximum_number_of_refinements <span class="op">=</span> <span class="dv">8</span><span class="op">});</span></span></code></pre></div>
<h4 data-number="1.1.3.3" id="vector-valuated-function"><span
class="header-section-number">1.1.3.3</span> Vector-valuated
function</h4>
<p>Let <span class="math inline">\(f_{3}\)</span> be the defined by:
<span class="math display">\[
f_{3}\left(x\right) =
\begin{pmatrix}
\sin\left(x\right)\\
\cos\left(x\right)
\end{pmatrix}
\]</span></p>
<p>The following code computes an approximation of the integral <span
class="math inline">\(\displaystyle\int_{0}^{\pi/4}f_{3}\left(x\right)\,\mathrm{d}x\)</span>:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">auto</span> a <span class="op">=</span> <span class="dt">double</span><span class="op">{};</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">auto</span> b <span class="op">=</span> <span class="bu">std::</span>numbers::pi_v<span class="op">&lt;</span><span class="dt">double</span><span class="op">&gt;</span> <span class="op">/</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="kw">auto</span> <span class="kw">or</span> <span class="op">=</span> tfel<span class="op">::</span>math<span class="op">::</span>gauss_kronrod_integrate<span class="op">(</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">[](</span><span class="at">const</span> <span class="dt">double</span> x<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">-&gt;</span> tfel<span class="op">::</span>math<span class="op">::</span>tvector<span class="op">&lt;</span><span class="dv">2</span><span class="bu">u</span><span class="op">,</span> <span class="dt">double</span><span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>      <span class="cf">return</span> <span class="op">{</span><span class="bu">std::</span>sin<span class="op">(</span>x<span class="op">),</span> <span class="bu">std::</span>cos<span class="op">(</span>x<span class="op">)};</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">},</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    a<span class="op">,</span> b<span class="op">,</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">{.</span>absolute_tolerance <span class="op">=</span> <span class="fl">1e-12</span><span class="op">,</span> <span class="op">.</span>maximum_number_of_refinements <span class="op">=</span> <span class="dv">8</span><span class="op">});</span></span></code></pre></div>
<h4 data-number="1.1.3.4" id="support-of-quantities"><span
class="header-section-number">1.1.3.4</span> Support of quantities</h4>
<p>The following snippet shows that quantities are also supported:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">auto</span> a <span class="op">=</span> time<span class="op">{};</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">auto</span> b <span class="op">=</span> time<span class="op">{</span><span class="dv">3600</span><span class="op">};</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="kw">constexpr</span> <span class="kw">auto</span> c <span class="op">=</span> tfel<span class="op">::</span>math<span class="op">::</span><span class="dt">derivative_type</span><span class="op">&lt;</span>strainrate<span class="op">,</span> time<span class="op">&gt;{</span><span class="fl">2.3e-5</span><span class="op">};</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="kw">auto</span> or1 <span class="op">=</span> tfel<span class="op">::</span>math<span class="op">::</span>gauss_kronrod_integrate<span class="op">(</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">[</span>c<span class="op">](</span><span class="at">const</span> time t<span class="op">)</span> <span class="kw">noexcept</span> <span class="op">{</span> <span class="cf">return</span> c <span class="op">*</span> t<span class="op">;</span> <span class="op">},</span> a<span class="op">,</span> b<span class="op">);</span></span></code></pre></div>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-62273823-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
