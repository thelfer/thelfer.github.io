<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="generator" content="pandoc" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Implementation of Barlat’ Yld2004-18p behaviour</title>
        <meta name="author" content="Thomas Helfer, Dominique Deloison" />
            <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <style type="text/css">code{white-space: pre;}</style>
            <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {  background-color: #f8f8f8; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span.al { color: #ef2929; } /* Alert */
      code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { color: #204a87; } /* Attribute */
      code span.bn { color: #0000cf; } /* BaseN */
      code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #4e9a06; } /* Char */
      code span.cn { color: #8f5902; } /* Constant */
      code span.co { color: #8f5902; font-style: italic; } /* Comment */
      code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
      code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
      code span.dt { color: #204a87; } /* DataType */
      code span.dv { color: #0000cf; } /* DecVal */
      code span.er { color: #a40000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #0000cf; } /* Float */
      code span.fu { color: #204a87; font-weight: bold; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
      code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
      code span.ot { color: #8f5902; } /* Other */
      code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
      code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
      code span.ss { color: #4e9a06; } /* SpecialString */
      code span.st { color: #4e9a06; } /* String */
      code span.va { color: #000000; } /* Variable */
      code span.vs { color: #4e9a06; } /* VerbatimString */
      code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    </style>
            <link rel="stylesheet" href="css/normalize.css"/>
    <link rel="stylesheet" href="css/main.css"/>
        <script
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
        type="text/javascript"></script>
          </head>
  <body>
    <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
        <header>
      <ul id="nav">
	<li><a href="news.html">News</a></li>
	<li><a href="index.html">Overview</a>
	  <ul>
	    <li><a>Domain specific languages</a>
	      <ul>
		<li><a href="material-properties.html">Material properties</a></li>
		<li><a href="behaviours.html">Mechanical behaviours</a></li>
		<li><a href="models.html">Models</a></li>
	      </ul>
            </li>
	    <li><a href="interfaces.html">Available interfaces</a></li>
	    <li><a href="associated-projects.html">Associated projects</a></li>
     	    <li><a>Tools</a>
	      <ul>
	        <li><a href="mfront-doc.html">mfront-doc</a></li>
	        <li><a href="mtest.html">mtest</a></li>
	        <li><a href="mfm.html">mfm</a></li>
	        <li><a href="mfm-test-generator.html">mfm-test-generator</a></li>
	        <li><a href="tfel-check.html">tfel-check</a></li>
	      </ul>
	    </li>
	  </ul>
	</li>
	<li><a>Getting started</a>
	  <ul>
	    <li><a href="https://github.com/thelfer/tfel/">Github repository</a></li>
	    <li><a href="https://github.com/thelfer/tfel/releases">Download</a></li>
	    <li><a href="release-notes.html">Release notes</a>
	      <ul>
		<li><a>Versions 2.0.x</a>
                  <ul>
                    <li><a href="release-notes.html">Versions prior to 2.0.5</a></li>
	 	    <li><a href="release-notes-2.0.5.html">Version 2.0.5</a></li>
                  </ul>
		</li>
		<li><a>Versions 3.0.x</a>
                  <ul>
		    <li><a href="release-notes-3.0.html">Version 3.0.0</a></li>
		    <li><a href="release-notes-3.0.1.html">Version 3.0.1</a></li>
		    <li><a href="release-notes-3.0.2.html">Version 3.0.2</a></li>
		    <li><a href="release-notes-3.0.3.html">Version 3.0.3</a></li>
		    <li><a href="release-notes-3.0.4.html">Version 3.0.4</a></li>
		    <li><a href="release-notes-3.0.5.html">Version 3.0.5</a></li>
		    <li><a href="release-notes-3.0.6.html">Version 3.0.6</a></li>
		    <li><a href="release-notes-3.0.7.html">Version 3.0.7</a></li>
		    <li><a href="release-notes-3.0.8.html">Version 3.0.8</a></li>
		    <li><a href="release-notes-3.0.9.html">Version 3.0.9</a></li>
		    <li><a href="release-notes-3.0.10.html">Version 3.0.10</a></li>
		    <li><a href="release-notes-3.0.11.html">Version 3.0.11</a></li>
		    <li><a href="release-notes-3.0.12.html">Version 3.0.12</a></li>
		    <li><a href="release-notes-3.0.13.html">Version 3.0.13</a></li>
		    <li><a href="release-notes-3.0.14.html">Version 3.0.14</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.1.x</a>
		  <ul>
		    <li><a href="release-notes-3.1.html">Version 3.1.0</a></li>
		    <li><a href="release-notes-3.1.1.html">Version 3.1.1</a></li>
		    <li><a href="release-notes-3.1.2.html">Version 3.1.2</a></li>
		    <li><a href="release-notes-3.1.3.html">Version 3.1.3</a></li>
		    <li><a href="release-notes-3.1.4.html">Version 3.1.4</a></li>
		    <li><a href="release-notes-3.1.5.html">Version 3.1.5</a></li>
		    <li><a href="release-notes-3.1.6.html">Version 3.1.6</a></li>
		    <li><a href="release-notes-3.1.7.html">Version 3.1.7</a></li>
		    <li><a href="release-notes-3.1.8.html">Version 3.1.8</a></li>
		    <li><a href="release-notes-3.1.9.html">Version 3.1.9</a></li>
		    <li><a href="release-notes-3.1.10.html">Version 3.1.10</a></li>
		    <li><a href="release-notes-3.1.11.html">Version 3.1.11</a></li>
		    <li><a href="release-notes-3.1.12.html">Version 3.1.12</a></li>
		    <li><a href="release-notes-3.1.13.html">Version 3.1.13</a></li>
		    <li><a href="release-notes-3.1.14.html">Version 3.1.14</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.2.x</a>
		  <ul>
		    <li><a href="release-notes-3.2.html">Version 3.2.0</a></li>
		    <li><a href="release-notes-3.2.1.html">Version 3.2.1</a></li>
		    <li><a href="release-notes-3.2.2.html">Version 3.2.2</a></li>
		    <li><a href="release-notes-3.2.3.html">Version 3.2.3</a></li>
		    <li><a href="release-notes-3.2.4.html">Version 3.2.4</a></li>
		    <li><a href="release-notes-3.2.5.html">Version 3.2.5</a></li>
		    <li><a href="release-notes-3.2.6.html">Version 3.2.6</a></li>
		    <li><a href="release-notes-3.2.7.html">Version 3.2.7</a></li>
		    <li><a href="release-notes-3.2.8.html">Version 3.2.8</a></li>
		    <li><a href="release-notes-3.2.9.html">Version 3.2.9</a></li>
		    <li><a href="release-notes-3.2.10.html">Version 3.2.10</a></li>
		    <li><a href="release-notes-3.2.11.html">Version 3.2.11</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.3.x</a>
		  <ul>
		    <li><a href="release-notes-3.3.html">Version 3.3.0</a></li>
		    <li><a href="release-notes-3.3.1.html">Version 3.3.1</a></li>
		    <li><a href="release-notes-3.3.1.html">Version 3.3.2</a></li>
		    <li><a href="release-notes-3.3.2.html">Version 3.3.2</a></li>
		    <li><a href="release-notes-3.3.3.html">Version 3.3.3</a></li>
		    <li><a href="release-notes-3.3.4.html">Version 3.3.4</a></li>
		    <li><a href="release-notes-3.3.5.html">Version 3.3.5</a></li>
		    <li><a href="release-notes-3.3.6.html">Version 3.3.6</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.4.x</a>
		  <ul>
		    <li><a href="release-notes-3.4.html">Version 3.4.0</a></li>
		    <li><a href="release-notes-3.4.1.html">Version 3.4.1</a></li>
		    <li><a href="release-notes-3.4.2.html">Version 3.4.2</a></li>
		    <li><a href="release-notes-3.4.3.html">Version 3.4.3</a></li>
		    <li><a href="release-notes-3.4.4.html">Version 3.4.4</a></li>
		    <li><a href="release-notes-3.4.5.html">Version 3.4.5</a></li>
		    <li><a href="release-notes-3.4.6.html">Version 3.4.6</a></li>
		    <li><a href="release-notes-3.4.7.html">Version 3.4.7</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.0.x</a>
		  <ul>
		    <li><a href="release-notes-4.0.html">Version 4.0.0</a></li>
		    <li><a href="release-notes-4.0.1.html">Version 4.0.1</a></li>
		    <li><a href="release-notes-4.0.2.html">Version 4.0.2</a></li>
		    <li><a href="release-notes-4.0.3.html">Version 4.0.3</a></li>
		    <li><a href="release-notes-4.0.4.html">Version 4.0.4</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.1.x</a>
		  <ul>
		    <li><a href="release-notes-4.1.html">Version 4.1.0</a></li>
		    <li><a href="release-notes-4.1.1.html">Version 4.1.1</a></li>
		    <li><a href="release-notes-4.1.2.html">Version 4.1.2</a></li>
		    <li><a href="release-notes-4.1.3.html">Version 4.1.3</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.2.x</a>
		  <ul>
		    <li><a href="release-notes-4.2.html">Version 4.2.0</a></li>
		    <li><a href="release-notes-4.2.1.html">Version 4.2.1</a></li>
		    <li><a href="release-notes-4.2.2.html">Version 4.2.2</a></li>
		  </ul>
		</li>
		<li><a>Versions 5.0.x</a>
		  <ul>
		    <li><a href="release-notes-5.0.html">Version 5.0.0</a></li>
		  </ul>
		</li>
	      </ul>
	    </li>
	    <li><a href="coverity-scan.html">Coverity scan</a></li>
	    <li><a href="install.html">Installation</a></li>
	  </ul>
	</li>
	<li><a>Documentation</a>
	  <ul>
	    <li><a href="documentations.html">General documentation</a></li>
	    <li><a href="gallery.html">Gallery</a></li>
<!--	    
	    <li><a href="http://tfel.sourceforge.net/doxygen/index.html">Doxygen documentation</a></li>
-->
	    <li><a>Behaviours</a>
	      <ul>
		<li><a href="tutorial.html">Tutorial</a></li>
		<li><a href="implicit-dsl.html">The Implicit DSL</a></li>
		<li><a href="benchmark.html">Benchmark</a></li>
		<li><a href="parameters.html">Parameters</a></li>
		<li><a href="BehaviourBricks.html">Behaviour bricks</a></li>
		<li><a href="interfaces.html">Solver interfaces</a>
		  <ul>
		    <li><a href="castem.html">Cast3M</a></li>
		    <li><a href="amitex.html">AMITEX_FFTP</a></li>
		    <li><a href="aster.html">Code-Aster</a></li>
    		    <li><a href="abaqus.html">Abaqus</a></li>
    		    <li><a href="epx.html">EUROPLEXUS</a></li>
		    <li><a href="zmat.html">ZeBuLoN</a></li>
   		    <li><a href="calculix.html">CalculiX</a></li>
		    <!-- <li><a >TMFFT</a></li> -->
		    <li><a href="cyrano.html">Cyrano</a></li>
   		    <li><a href="generic-material-property-interface.html">Generic interface for material properties</a></li>
   		    <li><a href="generic-behaviours-interface.html">Generic interface for behaviours</a></li>
		  </ul>
		</li>
	      </ul>
	    </li>
	    <li><a>TFEL libraries</a>
	      <ul>
		<li><a href="libraries_usage.html">Usage of the TFEL libraries in C++</a></li>
		<li><a href="tfel-math.html">TFEL/Math</a></li>
		<li><a href="tfel-material.html">TFEL/Material</a></li>
	      </ul>
	    </li>
	    <li><a>Python modules</a>
	      <ul>
		<li><a href="tfel-python.html">TFEL modules</a></li>
		<li><a href="mfront-python.html">mfront module</a></li>
		<li><a href="mtest-python.html">mtest module</a></li>
	      </ul>
	    </li>
	    <li><a>MFront keywords</a>
	      <ul>
	        <li><a href="Default-keywords.html">Default</a></li>
	        <li><a href="DefaultCZM-keywords.html">DefaultCZM</a></li>
	        <li><a href="DefaultFiniteStrain-keywords.html">DefaultFiniteStrain</a></li>
	        <li><a href="DefaultGenericBehaviour-keywords.html">DefaultGenericBehaviour</a></li>
	        <li><a href="DefaultModel-keywords.html">DefaultModel</a></li>
	        <li><a href="Implicit-keywords.html">Implicit</a></li>
	        <li><a href="ImplicitCZM-keywords.html">ImplicitCZM</a></li>
	        <li><a href="ImplicitFiniteStrain-keywords.html">ImplicitFiniteStrain</a></li>
	        <li><a href="ImplicitGenericBehaviour-keywords.html">ImplicitGenericBehaviour</a></li>
	        <li><a href="ImplicitModel-keywords.html">ImplicitModel</a></li>
	        <li><a href="ImplicitII-keywords.html">ImplicitII</a></li>
	        <li><a href="IsotropicMisesCreep-keywords.html">IsotropicMisesCreep</a></li>
	        <li><a href="IsotropicMisesPlasticFlow-keywords.html">IsotropicMisesPlasticFlow</a></li>
	        <li><a href="IsotropicPlasticMisesFlow-keywords.html">IsotropicPlasticMisesFlow</a></li>
	        <li><a href="IsotropicStrainHardeningMisesCreep-keywords.html">IsotropicStrainHardeningMisesCreep</a></li>
	        <li><a href="MaterialLaw-keywords.html">MaterialLaw</a></li>
	        <li><a href="MaterialProperty-keywords.html">MaterialProperty</a></li>
	        <li><a href="Model-keywords.html">Model</a></li>
	        <li><a href="MultipleIsotropicMisesFlows-keywords.html">MultipleIsotropicMisesFlows</a></li>
	        <li><a href="RungeKutta-keywords.html">RungeKutta</a></li>
	        <li><a href="RungeKuttaFiniteStrain-keywords.html">RungeKuttaFiniteStrain</a></li>
	        <li><a href="RungeKuttaGenericBehaviour-keywords.html">RungeKuttaGenericBehaviour</a></li>
	        <li><a href="RungeKuttaModel-keywords.html">RungeKuttaModel</a></li>
	      </ul>
	    </li>
	    <li><a href="MTest-keywords.html">MTest keywords</a></li>
	    <li><a href="physical-constants.html">Physical constants</a></li>
	    <li><a href="glossary.html">Glossary</a></li>
	    <li><a href="publications.html">Publications</a></li>
	    <li><a href="faq.html">FAQ</a></li>
	    <li><a href="about.html">About</a></li>
	  </ul>
	</li>
	<li><a>Contributing</a>
	  <ul>
	    <li><a href="svn.html">Access to source repositories</a></li>
	    <li><a href="devel.html">Development guidelines</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Report bugs</a></li>
	  </ul>
	</li>
	<li><a>Getting Help</a>
	  <ul>
	    <li><a href="search.html">Search on this site</a></li>
	    <li><a href="https://github.com/thelfer/tfel/discussions">Forum</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Bug report</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Feature request</a></li>
	    <li><a href="mailto:tfel-contact@cea.fr">Contact</a></li>
	  </ul>
	</li>
      </ul>
    </header>
<div id="header">
<h1 class="title">Implementation of Barlat’ Yld2004-18p behaviour</h1>
<h2 class="author">Thomas Helfer, Dominique Deloison</h2>
<h3 class="date">7/01/2018</h3>
</div>
<div id="TOC">
<ul>
<li><a href="#description-of-the-behaviour"
id="toc-description-of-the-behaviour">Description of the behaviour</a>
<ul>
<li><a href="#elasticity" id="toc-elasticity">Elasticity</a></li>
<li><a href="#plasticity" id="toc-plasticity">Plasticity</a></li>
</ul></li>
<li><a href="#implicit-scheme" id="toc-implicit-scheme">Implicit
scheme</a>
<ul>
<li><a href="#choice-of-the-state-variables"
id="toc-choice-of-the-state-variables">Choice of the state
variables</a></li>
<li><a href="#elastic-prediction" id="toc-elastic-prediction">Elastic
prediction</a></li>
<li><a
href="#equations-governing-the-material-evolution-under-plastic-loading"
id="toc-equations-governing-the-material-evolution-under-plastic-loading">Equations
governing the material evolution under plastic loading</a></li>
</ul></li>
<li><a href="#implementation" id="toc-implementation">Implementation</a>
<ul>
<li><a href="#metadata" id="toc-metadata">Metadata</a></li>
<li><a href="#orthotropic-axes-convention"
id="toc-orthotropic-axes-convention">Orthotropic axes
convention</a></li>
<li><a href="#the-standard-elasticity-brick"
id="toc-the-standard-elasticity-brick">The standard elasticity
brick</a></li>
<li><a href="#numerical-parameters"
id="toc-numerical-parameters">Numerical parameters</a></li>
<li><a href="#elastic-properties-and-yield-stress"
id="toc-elastic-properties-and-yield-stress">Elastic properties and
yield stress</a></li>
<li><a href="#state-variables" id="toc-state-variables">State
variables</a></li>
<li><a href="#local-variables-declaration"
id="toc-local-variables-declaration">Local variables
declaration</a></li>
<li><a href="#local-variable-initialization"
id="toc-local-variable-initialization">Local variable
initialization</a></li>
<li><a href="#implicit-system" id="toc-implicit-system">Implicit
system</a></li>
</ul></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>
<p>This article discusses the implementation of the Yld2004-18p
behaviour, as decribed by Barlat et al. (See <span class="citation"
data-cites="barlat_linear_2005">[1]</span>).</p>
<h1 id="description-of-the-behaviour">Description of the behaviour</h1>
<h2 id="elasticity">Elasticity</h2>
<p>The elasticity is assumed linear and isotropic, i.e. given by the
Hooke law: <span class="math display">\[
\underline{\sigma}=\lambda\,{\mathrm{tr}{\left(\underline{\varepsilon}^{\mathrm{el}}\right)}}\,\underline{I}+2\,\mu\,\underline{\varepsilon}^{\mathrm{el}}
\]</span> where <span class="math inline">\(\lambda\)</span> and <span
class="math inline">\(\mu\)</span> are the first and second Lamé
parameters.</p>
<h2 id="plasticity">Plasticity</h2>
<p>The yield surface is given by: <span class="math display">\[
{{\displaystyle \frac{\displaystyle
\sigma_{\mathrm{eq}}^{B}}{\displaystyle
\sigma_{0}}}}-\left(1+{{\displaystyle \frac{\displaystyle
p}{\displaystyle p_{0}}}}\right)^{np}=0
\]</span> where:</p>
<ul>
<li><span class="math inline">\(\sigma_{\mathrm{eq}}^{B}\)</span> is the
Barlat equivalent stress defined hereafter.</li>
<li><span class="math inline">\(p\)</span> is the equivalent plastic
strain.</li>
<li><span class="math inline">\(\sigma_{0}\)</span>, <span
class="math inline">\(p_{0}\)</span> and <span
class="math inline">\(np\)</span> are material parameters.</li>
</ul>
<p>The Barlat equivalent stress is defined as follows (See <span
class="citation" data-cites="barlat_linear_2005">[1]</span>): <span
class="math display">\[
\sigma_{\mathrm{eq}}^{B}=
\sqrt[a]{
  \frac{1}{4}\left(
  \sum_{i=0}^{3}
  \sum_{j=0}^{3}
  {\left|s&#39;_{i}-s&#39;&#39;_{j}\right|}^{a}
  \right)
}
\]</span></p>
<p>where <span class="math inline">\(s&#39;_{i}\)</span> and <span
class="math inline">\(s&#39;&#39;_{i}\)</span> are the eigenvalues of
two transformed stresses <span
class="math inline">\(\underline{s}&#39;\)</span> and <span
class="math inline">\(\underline{s}&#39;&#39;\)</span> by two linear
transformation <span
class="math inline">\(\underline{\underline{\mathbf{L}}}&#39;\)</span>
and <span
class="math inline">\(\underline{\underline{\mathbf{L}}}&#39;&#39;\)</span>:
<span class="math display">\[
\left\{
\begin{aligned}
\underline{s}&#39;  &amp;= \underline{\underline{\mathbf{L&#39;}}}
\,\colon\,\underline{\sigma}\\
\underline{s}&#39;&#39; &amp;=
\underline{\underline{\mathbf{L&#39;&#39;}}}\,\colon\,\underline{\sigma}\\
\end{aligned}
\right.
\]</span></p>
<p>The linear transformations <span
class="math inline">\(\underline{\underline{\mathbf{L}}}&#39;\)</span>
and <span
class="math inline">\(\underline{\underline{\mathbf{L}}}&#39;&#39;\)</span>
are defined by <span class="math inline">\(9\)</span> coefficients
(each) which describe the material orthotropy. There are defined through
auxiliary linear transformations <span
class="math inline">\(\underline{\underline{\mathbf{C}}}&#39;\)</span>
and <span
class="math inline">\(\underline{\underline{\mathbf{C}}}&#39;&#39;\)</span>
as follows: <span class="math display">\[
\begin{aligned}
\underline{\underline{\mathbf{L}}}&#39;
&amp;=\underline{\underline{\mathbf{C}}}&#39;\,\colon\,\underline{\underline{\mathbf{M}}}
\\
\underline{\underline{\mathbf{L}}}&#39;&#39;&amp;=\underline{\underline{\mathbf{C}}}&#39;&#39;\,\colon\,\underline{\underline{\mathbf{M}}}
\end{aligned}
\]</span> where <span
class="math inline">\(\underline{\underline{\mathbf{M}}}\)</span> is the
transformation of the stress to its deviator: <span
class="math display">\[
\underline{\underline{\mathbf{M}}}=\underline{\underline{\mathbf{I}}}-{{\displaystyle
\frac{\displaystyle 1}{\displaystyle
3}}}\underline{I}\,\otimes\,\underline{I}
\]</span></p>
<p>The linear transformations <span
class="math inline">\(\underline{\underline{\mathbf{C}}}&#39;\)</span>
and <span
class="math inline">\(\underline{\underline{\mathbf{C}}}&#39;&#39;\)</span>
of the deviator stress are defined as follows: <span
class="math display">\[
\underline{\underline{\mathbf{C}}}&#39;=
\begin{pmatrix}
0 &amp; -c&#39;_{12} &amp; -c&#39;_{13} &amp; 0 &amp; 0 &amp; 0 \\
-c&#39;_{21} &amp; 0 &amp; -c&#39;_{23} &amp; 0 &amp; 0 &amp; 0 \\
-c&#39;_{31} &amp; -c&#39;_{32} &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; c&#39;_{44} &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; c&#39;_{55} &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; c&#39;_{66} \\
\end{pmatrix}
\quad
\text{and}
\quad
\underline{\underline{\mathbf{C}}}&#39;&#39;=
\begin{pmatrix}
0 &amp; -c&#39;&#39;_{12} &amp; -c&#39;&#39;_{13} &amp; 0 &amp; 0 &amp;
0 \\
-c&#39;&#39;_{21} &amp; 0 &amp; -c&#39;&#39;_{23} &amp; 0 &amp; 0 &amp;
0 \\
-c&#39;&#39;_{31} &amp; -c&#39;&#39;_{32} &amp; 0 &amp; 0 &amp; 0 &amp;
0 \\
0 &amp; 0 &amp; 0 &amp; c&#39;&#39;_{44} &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; c&#39;&#39;_{55} &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; c&#39;&#39;_{66} \\
\end{pmatrix}
\]</span></p>
<p>When all the coefficients <span
class="math inline">\(c&#39;_{ji}\)</span> and <span
class="math inline">\(c&#39;&#39;_{ji}\)</span> are equal to <span
class="math inline">\(1\)</span>, the Barlat equivalent stress reduces
to the Hosford equivalent stress.</p>
<h1 id="implicit-scheme">Implicit scheme</h1>
<h2 id="choice-of-the-state-variables">Choice of the state
variables</h2>
<p>The behaviour is integrated by an implicit scheme. Two state
variables are introduced:</p>
<ul>
<li>the elastic strain <span
class="math inline">\(\underline{\varepsilon}^{\mathrm{el}}\)</span>.</li>
<li>the equivalent plastic strain <span
class="math inline">\(p\)</span>.</li>
</ul>
<p>The elastic strain is automatically defined by the
<code>StandardElasticity</code> brick.</p>
<h2 id="elastic-prediction">Elastic prediction</h2>
<p>First, an elastic prediction of the stress <span
class="math inline">\(\underline{\sigma}^{\mathrm{tr}}\)</span> is made
(The following expression is not valid in plane stress hypothesis, this
is the reason why we will use the <code>computeElasticPrediction</code>
method defined by the <code>StandardElasticity</code> brick, see
below):</p>
<p><span class="math display">\[
\underline{\sigma}^{\mathrm{tr}}=\lambda\,{\mathrm{tr}{\left({\left.\underline{\varepsilon}^{\mathrm{el}}\right|_{t}}+\theta\,\Delta\,\underline{\varepsilon}^{\mathrm{to}}\right)}}\,\underline{I}+2\,\mu\,{\left({\left.\underline{\varepsilon}^{\mathrm{el}}\right|_{t}}+\theta\,\Delta\,\underline{\varepsilon}^{\mathrm{to}}\right)}
\]</span></p>
<ul>
<li>If the predicted stress is inside the elastic domain, no plastic
flow occurs.</li>
<li>Otherwise, the material state at the end of the time step lies on
the yield surface.</li>
</ul>
<h2
id="equations-governing-the-material-evolution-under-plastic-loading">Equations
governing the material evolution under plastic loading</h2>
<p>The equation associated with the evolution of the elastic strain is
given by the split of strain: <span class="math display">\[
f_{\underline{\varepsilon}^{\mathrm{el}}}=\Delta\,\underline{\varepsilon}^{\mathrm{el}}-\Delta\,\underline{\varepsilon}^{\mathrm{to}}+\Delta\,p\,{\left.\underline{n}^{B}\right|_{t+\theta\,\Delta\,t}}
\]</span></p>
<p>The derivatives of this equation with respect to <span
class="math inline">\(\Delta\,\underline{\varepsilon}^{\mathrm{el}}\)</span>
and <span class="math inline">\(\Delta\,p\)</span> are given by: <span
class="math display">\[
\left\{
\begin{aligned}
{\displaystyle \frac{\displaystyle \partial
f_{\underline{\varepsilon}^{\mathrm{el}}}}{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{el}}}} &amp;=
\underline{\underline{\mathbf{I}}}+2\,\mu\,\theta\,\Delta\,p\,{\displaystyle
\frac{\displaystyle \partial
{\left.\underline{n}^{B}\right|_{t+\theta\,\Delta\,t}}}{\displaystyle
\partial {\left.\underline{\sigma}\right|_{t+\theta\,\Delta\,t}}}}\\
{\displaystyle \frac{\displaystyle \partial
f_{\underline{\varepsilon}^{\mathrm{el}}}}{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{el}}}} &amp;=
{\left.\underline{n}^{B}\right|_{t+\theta\,\Delta\,t}}\\
\end{aligned}
\right.
\]</span></p>
<p>To determine the equivalent plastic strain increment, the following
equation must be satisfied: <span class="math display">\[
f_{p}={{\displaystyle \frac{\displaystyle
{\left.\sigma_{\mathrm{eq}}^{B}\right|_{t+\theta\,\Delta\,t}}}{\displaystyle
\sigma 0}}}-\left(1+{{\displaystyle \frac{\displaystyle
{\left.p\right|_{t+\theta\,\Delta\,t}}}{\displaystyle
p_{0}}}}\right)^{np}=0
\]</span></p>
<p>The derivatives of this equation with respect to <span
class="math inline">\(\Delta\,\underline{\varepsilon}^{\mathrm{el}}\)</span>
and <span class="math inline">\(\Delta\,p\)</span> are given by: <span
class="math display">\[
\left\{
\begin{aligned}
{\displaystyle \frac{\displaystyle \partial f_{p}}{\displaystyle
\partial \Delta\,\underline{\varepsilon}^{\mathrm{el}}}} &amp;=
{{\displaystyle \frac{\displaystyle 2\,\mu\,\theta}{\displaystyle
\sigma_{0}}}}\,{\left.\underline{n}^{B}\right|_{t+\theta\,\Delta\,t}}\\
{\displaystyle \frac{\displaystyle \partial f_{p}}{\displaystyle
\partial \Delta\,p}}           &amp;= -{{\displaystyle
\frac{\displaystyle np\,\theta}{\displaystyle
p0}}}\left(1+{{\displaystyle \frac{\displaystyle
{\left.p\right|_{t+\theta\,\Delta\,t}}}{\displaystyle
p_{0}}}}\right)^{np-1}\\
\end{aligned}
\right.
\]</span></p>
<h1 id="implementation">Implementation</h1>
<h2 id="metadata">Metadata</h2>
<p>The beginning of the file gives some information about the
behaviour:</p>
<ul>
<li>the integration scheme used, selected by the <code>@DSL</code>
keyword.</li>
<li>the name of the behaviour, introduced by the <code>@Behaviour</code>
keyword.</li>
<li>the author of the implementation (<code>@Author</code>).</li>
<li>a small description of the behaviour
(<code>@Description</code>).</li>
</ul>
<h2 id="orthotropic-axes-convention">Orthotropic axes convention</h2>
<p>An orthotropic axes convention has to be defined to have consistent
definition of the linear transformations <span
class="math inline">\(l_{1}\)</span> and <span
class="math inline">\(l_{2}\)</span>. The behaviour has been identified
for plates, so the natural choice is the <code>Plate</code> orthotropic
convention:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>OrthotropicBehaviour<span class="op">&lt;</span>Plate<span class="op">&gt;;</span></span></code></pre></div>
<p>This choice limits the number of possible modelling hypotheses that
are available to the following list: <code>Tridimensional</code>,
<code>PlaneStrain</code>, <code>GeneralisedPlaneStrain</code>,
<code>PlaneStress</code>.</p>
<p>Thanks to the <code>StandardElasticity</code> brick defined below,
all those modelling hypotheses can be supported, but the support for the
plane stress hypothesis as to be explicitly requested. The following
statement, starting with the <code>@ModellingHypotheses</code>, enables
all the previously listed modelling hypotheses:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>ModellingHypotheses <span class="op">{</span>Tridimensional<span class="op">,</span>PlaneStrain<span class="op">,</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                      GeneralisedPlaneStrain<span class="op">,</span>PlaneStress<span class="op">};</span></span></code></pre></div>
<h2 id="the-standard-elasticity-brick">The standard elasticity
brick</h2>
<p>To implement this behaviour, we will use the
<code>StandardElasticity</code> brick which provides:</p>
<ul>
<li>Automatic computation of the stress tensor at various stages of the
behaviour integration.</li>
<li>Automatic computation of the consistent tangent operator.</li>
<li>Automatic support for plane stress and generalized plane stress
modelling hypotheses (The axial strain is defined as an additional state
variable and the associated equation in the implicit system is added to
enforce the plane stess condition).</li>
<li>Automatic addition of the standard terms associated with the elastic
strain state variable.</li>
</ul>
<p>This behaviour brick is fully described <a
href="BehaviourBricks.html">here</a>.</p>
<p>The usage of the <code>StandardElasticity</code> is introduced as
follows:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Brick StandardElasticity<span class="op">;</span></span></code></pre></div>
<h2 id="numerical-parameters">Numerical parameters</h2>
<p>The following part of file give some default values for numerical
parameters used by the integration algorithm:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Epsilon <span class="fl">1.e-16</span><span class="op">;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Theta   <span class="dv">1</span><span class="op">;</span></span></code></pre></div>
<h2 id="elastic-properties-and-yield-stress">Elastic properties and
yield stress</h2>
<p>The material properties are hard-coded. The
<code>@ElasticMaterialProperties</code> is used to declare the Young
modulus and the Poisson ratio.</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>ElasticMaterialProperties <span class="op">{</span><span class="fl">150e9</span><span class="op">,</span><span class="fl">0.3</span><span class="op">};</span></span></code></pre></div>
<p>This keyword automatically declares two parameters called
<code>YoungModulus</code> and <code>PoissonRatio</code>.</p>
<p>In the <code>Implicit</code> scheme, the lame coefficients are
automatically deduced from the Young modulus and the Poisson ratio. They
are accessible though the <code>lambda</code> and <code>mu</code> local
variables which are automatically defined.</p>
<p>The parameters associated with the plastic part of the behaviour are
defined as follows:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Parameter a    <span class="op">=</span> <span class="dv">8</span><span class="op">;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">// 646*0.025**0.227</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Parameter sig0 <span class="op">=</span> <span class="fl">150e6</span><span class="op">;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>sig0<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;HardeningReferenceStress&quot;</span><span class="op">);</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Parameter p0   <span class="op">=</span> <span class="fl">1.e-4</span><span class="op">;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>p0<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;HardeningReferenceStrain&quot;</span><span class="op">);</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Parameter np   <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>np<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;BarlatExponent&quot;</span><span class="op">);</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Parameter c1p<span class="op">[</span><span class="dv">9</span><span class="op">]</span>  <span class="op">=</span> <span class="op">{-</span><span class="fl">0.069888</span><span class="op">,</span><span class="fl">0.079143</span><span class="op">,</span><span class="fl">0.936408</span><span class="op">,</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>              <span class="fl">0.524741</span><span class="op">,</span><span class="fl">1.00306</span><span class="op">,</span><span class="fl">1.36318</span><span class="op">,</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>              <span class="fl">0.954322</span><span class="op">,</span><span class="fl">1.06906</span><span class="op">,</span><span class="fl">1.02377</span><span class="op">};</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>c1p<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;BarlatLinearTransformationCoefficients1&quot;</span><span class="op">);</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Parameter c2p<span class="op">[</span><span class="dv">9</span><span class="op">]</span>  <span class="op">=</span> <span class="op">{</span><span class="fl">0.981171</span><span class="op">,</span><span class="fl">0.575316</span><span class="op">,</span><span class="fl">0.476741</span><span class="op">,</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>              <span class="fl">1.14501</span><span class="op">,</span><span class="fl">0.866827</span><span class="op">,-</span><span class="fl">0.079294</span><span class="op">,</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>              <span class="fl">1.40462</span><span class="op">,</span><span class="fl">1.1471</span><span class="op">,</span><span class="fl">1.05166</span><span class="op">};</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>c2p<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;BarlatLinearTransformationCoefficients2&quot;</span><span class="op">);</span></span></code></pre></div>
<p>Here <code>a</code> stands for the Barlat exponent,
<code>sig0</code>, <code>p0</code> and <code>np</code> are the
parameters describing the hardening of the material.</p>
<p>The parameters associated with the first linear transformation are
given in the following order (see <a href="tensors.html">this page</a>
for details):</p>
<p><span class="math display">\[
\left(c^{1}_{xy},c^{1}_{yx},c^{1}_{xz},c^{1}_{zx},c^{1}_{yz},c^{1}_{zy},c^{1}_{xy},c^{1}_{xz},c^{1}_{yz}\right)
\]</span></p>
<blockquote>
<p><strong>Note</strong> In his paper, Barlat and coworkers seems to use
the following convention for storing symmetric tensors:</p>
<p><span class="math display">\[
\begin{pmatrix}
xx &amp; yy &amp; zz &amp; yz &amp; zx &amp; xy
\end{pmatrix}
\]</span></p>
<p>which is not consistent with the
<code>TFEL</code>/<code>Cast3M</code>/<code>Abaqus</code>/<code>Ansys</code>
conventions:</p>
<p><span class="math display">\[
\begin{pmatrix}
xx &amp; yy &amp; zz &amp; xy &amp; xz &amp; yz
\end{pmatrix}
\]</span></p>
<p>Therefore, if one wants to uses coeficients <span
class="math inline">\(c^{B}\)</span> given by Barlat et al., one shall
“swap” the appropriate coefficients.</p>
</blockquote>
<h2 id="state-variables">State variables</h2>
<p>The elastic strain is automatically declared the
<code>StandardElasticity</code> brick. The associated variable is
<code>eel</code>.</p>
<p>The following statement introduces the equivalent plastic strain
named <code>p</code>:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>StateVariable strain p<span class="op">;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>p<span class="op">.</span>setGlossaryName<span class="op">(</span><span class="st">&quot;EquivalentPlasticStrain&quot;</span><span class="op">);</span></span></code></pre></div>
<h2 id="local-variables-declaration">Local variables declaration</h2>
<p>For the implementations, we will need three local variables:</p>
<ul>
<li>a boolean <code>b</code>. This boolean will be <code>true</code> if
a plastic loading occurs.</li>
<li>two fourth order tensors <code>l1</code> and <code>l2</code> that
stands for the linear transformation of the stress tensors.</li>
</ul>
<div class="sourceCode" id="cb8"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>LocalVariable <span class="dt">bool</span> b<span class="op">;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>LocalVariable Stensor4 l1<span class="op">,</span>l2<span class="op">;</span></span></code></pre></div>
<h2 id="local-variable-initialization">Local variable
initialization</h2>
<p>The main goal of the local variable initialization is to test if the
elastic prediction of the stress lies inside the yield surface.</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>InitializeLocalVariables<span class="op">{</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// when using the `Plate` orthotropic axes convention, all the</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// modelling hypotheses uses the same convention, so we can just</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">// use the `makeBarlatLinearTransformation` function with the</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// space dimension N as the template parameter</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  l1 <span class="op">=</span> makeBarlatLinearTransformation<span class="op">&lt;</span>N<span class="op">&gt;(</span>c1p<span class="op">[</span><span class="dv">0</span><span class="op">],</span>c1p<span class="op">[</span><span class="dv">1</span><span class="op">],</span>c1p<span class="op">[</span><span class="dv">2</span><span class="op">],</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                                         c1p<span class="op">[</span><span class="dv">3</span><span class="op">],</span>c1p<span class="op">[</span><span class="dv">4</span><span class="op">],</span>c1p<span class="op">[</span><span class="dv">5</span><span class="op">],</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                                         c1p<span class="op">[</span><span class="dv">6</span><span class="op">],</span>c1p<span class="op">[</span><span class="dv">7</span><span class="op">],</span>c1p<span class="op">[</span><span class="dv">8</span><span class="op">]);</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  l2 <span class="op">=</span> makeBarlatLinearTransformation<span class="op">&lt;</span>N<span class="op">&gt;(</span>c2p<span class="op">[</span><span class="dv">0</span><span class="op">],</span>c2p<span class="op">[</span><span class="dv">1</span><span class="op">],</span>c2p<span class="op">[</span><span class="dv">2</span><span class="op">],</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                                         c2p<span class="op">[</span><span class="dv">3</span><span class="op">],</span>c2p<span class="op">[</span><span class="dv">4</span><span class="op">],</span>c2p<span class="op">[</span><span class="dv">5</span><span class="op">],</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                                         c2p<span class="op">[</span><span class="dv">6</span><span class="op">],</span>c2p<span class="op">[</span><span class="dv">7</span><span class="op">],</span>c2p<span class="op">[</span><span class="dv">8</span><span class="op">]);</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> stress seps <span class="op">=</span> <span class="fl">1.e-10</span><span class="op">*</span>young<span class="op">;</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> sigel <span class="op">=</span> computeElasticPrediction<span class="op">();</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> seqel <span class="op">=</span> computeBarlatStress<span class="op">(</span>sigel<span class="op">,</span>l1<span class="op">,</span>l2<span class="op">,</span>a<span class="op">,</span>seps<span class="op">);</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  b <span class="op">=</span> seqel<span class="op">/</span>sig0<span class="op">&gt;</span>pow<span class="op">(</span><span class="dv">1</span><span class="op">+</span>p<span class="op">/</span>p0<span class="op">,</span>np<span class="op">);</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>The <code>computeElasticPrediction</code> method, provided by the
<code>StandardElasticity</code> brick, computes the elastic prediction
of the stress and takes into account the modelling hypothesis. This
prediction is thus valid under the plane stress hypothesis.</p>
<p>The <code>makeBarlatLinearTransformation</code> and the
<code>computeBarlatStress</code> functions are described in details <a
href="tensors.hml">here</a></p>
<h2 id="implicit-system">Implicit system</h2>
<p>The code describing the implicit system is rather short:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Integrator<span class="op">{</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> stress seps <span class="op">=</span> <span class="fl">1.e-10</span><span class="op">*</span>young<span class="op">;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span><span class="op">(!</span>b<span class="op">){</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// elastic loading, nothing to be done</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> <span class="va">p_</span> <span class="op">=</span> p<span class="op">+</span>theta<span class="op">*</span>dp<span class="op">;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span><span class="op">(</span><span class="va">p_</span><span class="op">&lt;</span><span class="dv">0</span><span class="op">){</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  real seq<span class="op">;</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  Stensor n<span class="op">;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  Stensor4 dn<span class="op">;</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> tmp <span class="op">=</span> pow<span class="op">(</span><span class="dv">1</span><span class="op">+</span><span class="va">p_</span><span class="op">/</span>p0<span class="op">,</span>np<span class="op">);</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="bu">std::</span>tie<span class="op">(</span>seq<span class="op">,</span>n<span class="op">,</span>dn<span class="op">)</span> <span class="op">=</span> computeBarlatStressSecondDerivative<span class="op">(</span>sig<span class="op">,</span>l1<span class="op">,</span>l2<span class="op">,</span>a<span class="op">,</span>seps<span class="op">);</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  feel        <span class="op">+=</span> dp<span class="op">*</span>n<span class="op">;</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  dfeel_ddeel <span class="op">+=</span> <span class="dv">2</span><span class="op">*</span>mu<span class="op">*</span>theta<span class="op">*</span>dp<span class="op">*</span>dn<span class="op">;</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  dfeel_ddp    <span class="op">=</span> n<span class="op">;</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  fp           <span class="op">=</span> seq<span class="op">/</span>sig0<span class="op">-</span>tmp<span class="op">;</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  dfp_ddeel    <span class="op">=</span> <span class="op">(</span><span class="dv">2</span><span class="op">*</span>mu<span class="op">*</span>theta<span class="op">)/</span>sig0<span class="op">*</span>n<span class="op">;</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  dfp_ddp      <span class="op">=</span> <span class="op">(</span>np<span class="op">*</span>theta<span class="op">)/(</span>p0<span class="op">+</span><span class="va">p_</span><span class="op">)*</span>tmp<span class="op">;</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>It shall be noted that, at the beginning of this code block:</p>
<ul>
<li><code>feel</code> has been initialized to <span
class="math inline">\(\Delta\,\underline{\varepsilon}^{\mathrm{el}}-\Delta\,\underline{\varepsilon}^{\mathrm{to}}\)</span>
by the <code>StandardElasticity</code> brick</li>
<li><code>fp</code> has been initialized to <span
class="math inline">\(\Delta\,p\)</span> following standard conventions
defined in the the <code>Implicit</code> domain specific language.</li>
<li>the jacobian has been set to identity, following standard
conventions defined in the <code>Implicit</code> domain specific
language.</li>
</ul>
<p>Thus, all the variables have been set to describe a purely elastic
behaviour. Hence, nothing is to be done if the boolean variable
<code>b</code> is <code>false</code>. In this case, one just return
<code>true</code>.</p>
<p>If a plastic loading has been predicted, one uses the
<code>computeBarlatStressSecondDerivative</code> function which
returns:</p>
<ul>
<li>the Barlat stress <code>seq</code></li>
<li>the Barlat stress derivative <code>n</code> with respect to the
stress</li>
<li>the Barlat stress second derivative <code>dn</code> with respect to
the stress</li>
</ul>
<p>The implicit system is then readily written, using expressions given
in the previous paragraph.</p>
<p>In <code>C++17</code>, the previous code can be more simplier and
smaller, using <em>structured bindings</em>:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Integrator<span class="op">{</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> stress seps <span class="op">=</span> <span class="fl">1.e-10</span><span class="op">*</span>young<span class="op">;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span><span class="op">(!</span>b<span class="op">){</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// elastic loading, nothing to be done</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> <span class="va">p_</span> <span class="op">=</span> p<span class="op">+</span>theta<span class="op">*</span>dp<span class="op">;</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span><span class="op">(</span><span class="va">p_</span><span class="op">&lt;</span><span class="dv">0</span><span class="op">){</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> tmp <span class="op">=</span> pow<span class="op">(</span><span class="dv">1</span><span class="op">+</span><span class="va">p_</span><span class="op">/</span>p0<span class="op">,</span>np<span class="op">);</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> <span class="op">[</span>seq<span class="op">,</span>n<span class="op">,</span>dn<span class="op">]</span> <span class="op">=</span> computeBarlatStressSecondDerivative<span class="op">(</span>sig<span class="op">,</span>l1<span class="op">,</span>l2<span class="op">,</span>a<span class="op">,</span>seps<span class="op">);</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  feel        <span class="op">+=</span> dp<span class="op">*</span>n<span class="op">;</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  dfeel_ddeel <span class="op">+=</span> <span class="dv">2</span><span class="op">*</span>mu<span class="op">*</span>theta<span class="op">*</span>dp<span class="op">*</span>dn<span class="op">;</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  dfeel_ddp    <span class="op">=</span> n<span class="op">;</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  fp           <span class="op">=</span> seq<span class="op">/</span>sig0<span class="op">-</span>tmp<span class="op">;</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  dfp_ddeel    <span class="op">=</span> <span class="op">(</span><span class="dv">2</span><span class="op">*</span>mu<span class="op">*</span>theta<span class="op">)/</span>sig0<span class="op">*</span>n<span class="op">;</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  dfp_ddp      <span class="op">=</span> <span class="op">(</span>np<span class="op">*</span>theta<span class="op">)/(</span>p0<span class="op">+</span><span class="va">p_</span><span class="op">)*</span>tmp<span class="op">;</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 id="references">References</h1>
<!-- Local IspellDict: english -->
<div id="refs" class="references csl-bib-body" role="list">
<div id="ref-barlat_linear_2005" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div
class="csl-right-inline"><span class="smallcaps">Barlat</span>, F.,
<span class="smallcaps">Aretz</span>, H., <span
class="smallcaps">Yoon</span>, J. W., <span
class="smallcaps">Karabin</span>, M. E., <span
class="smallcaps">Brem</span>, J. C. and <span
class="smallcaps">Dick</span>, R. E. Linear transfomation-based
anisotropic yield functions. <em>International Journal of
Plasticity</em>. 1 May 2005. Vol. 21, no. 5, p. 1009–1039. DOI <a
href="https://doi.org/10.1016/j.ijplas.2004.06.004">10.1016/j.ijplas.2004.06.004</a>.
Available from: <a
href="http://www.sciencedirect.com/science/article/pii/S0749641904001160">http://www.sciencedirect.com/science/article/pii/S0749641904001160</a></div>
</div>
</div>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-62273823-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
