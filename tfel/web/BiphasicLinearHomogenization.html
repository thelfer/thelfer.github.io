
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="generator" content="pandoc" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Implementation of mean-field homogenization schemes for biphasic elastic media</title>
        <meta name="author" content="Martin Antoine" />
            <meta name="date" content="2025-02-24" />
        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <style type="text/css">code{white-space: pre;}</style>
            <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {  background-color: #f8f8f8; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span.al { color: #ef2929; } /* Alert */
      code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { color: #204a87; } /* Attribute */
      code span.bn { color: #0000cf; } /* BaseN */
      code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #4e9a06; } /* Char */
      code span.cn { color: #8f5902; } /* Constant */
      code span.co { color: #8f5902; font-style: italic; } /* Comment */
      code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
      code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
      code span.dt { color: #204a87; } /* DataType */
      code span.dv { color: #0000cf; } /* DecVal */
      code span.er { color: #a40000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #0000cf; } /* Float */
      code span.fu { color: #204a87; font-weight: bold; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
      code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
      code span.ot { color: #8f5902; } /* Other */
      code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
      code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
      code span.ss { color: #4e9a06; } /* SpecialString */
      code span.st { color: #4e9a06; } /* String */
      code span.va { color: #000000; } /* Variable */
      code span.vs { color: #4e9a06; } /* VerbatimString */
      code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    </style>
            <link rel="stylesheet" href="css/normalize.css"/>
    <link rel="stylesheet" href="css/main.css"/>
        <script
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
        type="text/javascript"></script>
          </head>
  <body>
    <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
        <header>
      <ul id="nav">
	<li><a href="news.html">News</a></li>
	<li><a href="index.html">Overview</a>
	  <ul>
	    <li><a>Domain specific languages</a>
	      <ul>
		<li><a href="material-properties.html">Material properties</a></li>
		<li><a href="behaviours.html">Mechanical behaviours</a></li>
		<li><a href="models.html">Models</a></li>
	      </ul>
            </li>
	    <li><a href="interfaces.html">Available interfaces</a></li>
	    <li><a href="associated-projects.html">Associated projects</a></li>
     	    <li><a>Tools</a>
	      <ul>
	        <li><a href="mfront-doc.html">mfront-doc</a></li>
	        <li><a href="mtest.html">mtest</a></li>
	        <li><a href="mfm.html">mfm</a></li>
	        <li><a href="mfm-test-generator.html">mfm-test-generator</a></li>
	        <li><a href="tfel-check.html">tfel-check</a></li>
	      </ul>
	    </li>
	  </ul>
	</li>
	<li><a>Getting started</a>
	  <ul>
	    <li><a href="https://github.com/thelfer/tfel/">Github repository</a></li>
	    <li><a href="https://github.com/thelfer/tfel/releases">Download</a></li>
	    <li><a href="release-notes.html">Release notes</a>
	      <ul>
		<li><a>Versions 2.0.x</a>
                  <ul>
                    <li><a href="release-notes.html">Versions prior to 2.0.5</a></li>
	 	    <li><a href="release-notes-2.0.5.html">Version 2.0.5</a></li>
                  </ul>
		</li>
		<li><a>Versions 3.0.x</a>
                  <ul>
		    <li><a href="release-notes-3.0.html">Version 3.0.0</a></li>
		    <li><a href="release-notes-3.0.1.html">Version 3.0.1</a></li>
		    <li><a href="release-notes-3.0.2.html">Version 3.0.2</a></li>
		    <li><a href="release-notes-3.0.3.html">Version 3.0.3</a></li>
		    <li><a href="release-notes-3.0.4.html">Version 3.0.4</a></li>
		    <li><a href="release-notes-3.0.5.html">Version 3.0.5</a></li>
		    <li><a href="release-notes-3.0.6.html">Version 3.0.6</a></li>
		    <li><a href="release-notes-3.0.7.html">Version 3.0.7</a></li>
		    <li><a href="release-notes-3.0.8.html">Version 3.0.8</a></li>
		    <li><a href="release-notes-3.0.9.html">Version 3.0.9</a></li>
		    <li><a href="release-notes-3.0.10.html">Version 3.0.10</a></li>
		    <li><a href="release-notes-3.0.11.html">Version 3.0.11</a></li>
		    <li><a href="release-notes-3.0.12.html">Version 3.0.12</a></li>
		    <li><a href="release-notes-3.0.13.html">Version 3.0.13</a></li>
		    <li><a href="release-notes-3.0.14.html">Version 3.0.14</a></li>
		    <li><a href="release-notes-3.0.15.html">Version 3.0.15</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.1.x</a>
		  <ul>
		    <li><a href="release-notes-3.1.html">Version 3.1.0</a></li>
		    <li><a href="release-notes-3.1.1.html">Version 3.1.1</a></li>
		    <li><a href="release-notes-3.1.2.html">Version 3.1.2</a></li>
		    <li><a href="release-notes-3.1.3.html">Version 3.1.3</a></li>
		    <li><a href="release-notes-3.1.4.html">Version 3.1.4</a></li>
		    <li><a href="release-notes-3.1.5.html">Version 3.1.5</a></li>
		    <li><a href="release-notes-3.1.6.html">Version 3.1.6</a></li>
		    <li><a href="release-notes-3.1.7.html">Version 3.1.7</a></li>
		    <li><a href="release-notes-3.1.8.html">Version 3.1.8</a></li>
		    <li><a href="release-notes-3.1.9.html">Version 3.1.9</a></li>
		    <li><a href="release-notes-3.1.10.html">Version 3.1.10</a></li>
		    <li><a href="release-notes-3.1.11.html">Version 3.1.11</a></li>
		    <li><a href="release-notes-3.1.12.html">Version 3.1.12</a></li>
		    <li><a href="release-notes-3.1.13.html">Version 3.1.13</a></li>
		    <li><a href="release-notes-3.1.14.html">Version 3.1.14</a></li>
		    <li><a href="release-notes-3.1.15.html">Version 3.1.15</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.2.x</a>
		  <ul>
		    <li><a href="release-notes-3.2.html">Version 3.2.0</a></li>
		    <li><a href="release-notes-3.2.1.html">Version 3.2.1</a></li>
		    <li><a href="release-notes-3.2.2.html">Version 3.2.2</a></li>
		    <li><a href="release-notes-3.2.3.html">Version 3.2.3</a></li>
		    <li><a href="release-notes-3.2.4.html">Version 3.2.4</a></li>
		    <li><a href="release-notes-3.2.5.html">Version 3.2.5</a></li>
		    <li><a href="release-notes-3.2.6.html">Version 3.2.6</a></li>
		    <li><a href="release-notes-3.2.7.html">Version 3.2.7</a></li>
		    <li><a href="release-notes-3.2.8.html">Version 3.2.8</a></li>
		    <li><a href="release-notes-3.2.9.html">Version 3.2.9</a></li>
		    <li><a href="release-notes-3.2.10.html">Version 3.2.10</a></li>
		    <li><a href="release-notes-3.2.11.html">Version 3.2.11</a></li>
		    <li><a href="release-notes-3.2.12.html">Version 3.2.12</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.3.x</a>
		  <ul>
		    <li><a href="release-notes-3.3.html">Version 3.3.0</a></li>
		    <li><a href="release-notes-3.3.1.html">Version 3.3.1</a></li>
		    <li><a href="release-notes-3.3.1.html">Version 3.3.2</a></li>
		    <li><a href="release-notes-3.3.2.html">Version 3.3.2</a></li>
		    <li><a href="release-notes-3.3.3.html">Version 3.3.3</a></li>
		    <li><a href="release-notes-3.3.4.html">Version 3.3.4</a></li>
		    <li><a href="release-notes-3.3.5.html">Version 3.3.5</a></li>
		    <li><a href="release-notes-3.3.6.html">Version 3.3.6</a></li>
		    <li><a href="release-notes-3.3.7.html">Version 3.3.7</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.4.x</a>
		  <ul>
		    <li><a href="release-notes-3.4.html">Version 3.4.0</a></li>
		    <li><a href="release-notes-3.4.1.html">Version 3.4.1</a></li>
		    <li><a href="release-notes-3.4.2.html">Version 3.4.2</a></li>
		    <li><a href="release-notes-3.4.3.html">Version 3.4.3</a></li>
		    <li><a href="release-notes-3.4.4.html">Version 3.4.4</a></li>
		    <li><a href="release-notes-3.4.5.html">Version 3.4.5</a></li>
		    <li><a href="release-notes-3.4.6.html">Version 3.4.6</a></li>
		    <li><a href="release-notes-3.4.7.html">Version 3.4.7</a></li>
		    <li><a href="release-notes-3.4.8.html">Version 3.4.8</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.0.x</a>
		  <ul>
		    <li><a href="release-notes-4.0.html">Version 4.0.0</a></li>
		    <li><a href="release-notes-4.0.1.html">Version 4.0.1</a></li>
		    <li><a href="release-notes-4.0.2.html">Version 4.0.2</a></li>
		    <li><a href="release-notes-4.0.3.html">Version 4.0.3</a></li>
		    <li><a href="release-notes-4.0.4.html">Version 4.0.4</a></li>
		    <li><a href="release-notes-4.0.5.html">Version 4.0.5</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.1.x</a>
		  <ul>
		    <li><a href="release-notes-4.1.html">Version 4.1.0</a></li>
		    <li><a href="release-notes-4.1.1.html">Version 4.1.1</a></li>
		    <li><a href="release-notes-4.1.2.html">Version 4.1.2</a></li>
		    <li><a href="release-notes-4.1.3.html">Version 4.1.3</a></li>
		    <li><a href="release-notes-4.1.4.html">Version 4.1.4</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.2.x</a>
		  <ul>
		    <li><a href="release-notes-4.2.html">Version 4.2.0</a></li>
		    <li><a href="release-notes-4.2.1.html">Version 4.2.1</a></li>
		    <li><a href="release-notes-4.2.2.html">Version 4.2.2</a></li>
		    <li><a href="release-notes-4.2.3.html">Version 4.2.3</a></li>
		  </ul>
		</li>
		<li><a>Versions 5.0.x</a>
		  <ul>
		    <li><a href="release-notes-5.0.html">Version 5.0.0</a></li>
		    <li><a href="release-notes-5.0.1.html">Version 5.0.1</a></li>
		  </ul>
		</li>
		<li><a>Versions 5.1.x</a>
		  <ul>
		    <li><a href="release-notes-5.1.html">Version 5.1.0</a></li>
		  </ul>
		</li>
	      </ul>
	    </li>
	    <li><a href="coverity-scan.html">Coverity scan</a></li>
	    <li><a href="install.html">Installation</a></li>
	  </ul>
	</li>
	<li><a>Documentation</a>
	  <ul>
	    <li><a href="documentations.html">General documentation</a></li>
	    <li><a href="gallery.html">Gallery</a></li>
<!--	    
	    <li><a href="http://tfel.sourceforge.net/doxygen/index.html">Doxygen documentation</a></li>
-->
	    <li><a>Behaviours</a>
	      <ul>
		<li><a href="tutorial.html">Tutorial</a></li>
		<li><a href="implicit-dsl.html">The Implicit DSL</a></li>
		<li><a href="benchmark.html">Benchmark</a></li>
		<li><a href="parameters.html">Parameters</a></li>
		<li><a href="BehaviourBricks.html">Behaviour bricks</a></li>
		<li><a href="interfaces.html">Solver interfaces</a>
		  <ul>
		    <li><a href="castem.html">Cast3M</a></li>
		    <li><a href="amitex.html">AMITEX_FFTP</a></li>
		    <li><a href="aster.html">Code-Aster</a></li>
    		    <li><a href="abaqus.html">Abaqus</a></li>
		    <li><a href="zmat.html">ZeBuLoN</a></li>
   		    <li><a href="calculix.html">CalculiX</a></li>
		    <!-- <li><a >TMFFT</a></li> -->
		    <li><a href="cyrano.html">Cyrano</a></li>
   		    <li><a href="generic-material-property-interface.html">Generic interface for material properties</a></li>
   		    <li><a href="generic-behaviours-interface.html">Generic interface for behaviours</a></li>
		  </ul>
		</li>
	      </ul>
	    </li>
	    <li><a>TFEL libraries</a>
	      <ul>
		<li><a href="libraries_usage.html">Usage of the TFEL libraries in C++</a></li>
		<li><a href="tfel-math.html">TFEL/Math</a></li>
		<li><a href="tfel-material.html">TFEL/Material</a></li>
	      </ul>
	    </li>
	    <li><a>Python modules</a>
	      <ul>
		<li><a href="tfel-python.html">TFEL modules</a></li>
		<li><a href="mfront-python.html">mfront module</a></li>
		<li><a href="mtest-python.html">mtest module</a></li>
	      </ul>
	    </li>
	    <li><a>MFront keywords</a>
	      <ul>
	        <li><a href="Default-keywords.html">Default</a></li>
	        <li><a href="DefaultCZM-keywords.html">DefaultCZM</a></li>
	        <li><a href="DefaultFiniteStrain-keywords.html">DefaultFiniteStrain</a></li>
	        <li><a href="DefaultGenericBehaviour-keywords.html">DefaultGenericBehaviour</a></li>
	        <li><a href="DefaultModel-keywords.html">DefaultModel</a></li>
	        <li><a href="Implicit-keywords.html">Implicit</a></li>
	        <li><a href="ImplicitCZM-keywords.html">ImplicitCZM</a></li>
	        <li><a href="ImplicitFiniteStrain-keywords.html">ImplicitFiniteStrain</a></li>
	        <li><a href="ImplicitGenericBehaviour-keywords.html">ImplicitGenericBehaviour</a></li>
	        <li><a href="ImplicitModel-keywords.html">ImplicitModel</a></li>
	        <li><a href="ImplicitII-keywords.html">ImplicitII</a></li>
	        <li><a href="IsotropicMisesCreep-keywords.html">IsotropicMisesCreep</a></li>
	        <li><a href="IsotropicMisesPlasticFlow-keywords.html">IsotropicMisesPlasticFlow</a></li>
	        <li><a href="IsotropicPlasticMisesFlow-keywords.html">IsotropicPlasticMisesFlow</a></li>
	        <li><a href="IsotropicStrainHardeningMisesCreep-keywords.html">IsotropicStrainHardeningMisesCreep</a></li>
	        <li><a href="MaterialLaw-keywords.html">MaterialLaw</a></li>
	        <li><a href="MaterialProperty-keywords.html">MaterialProperty</a></li>
	        <li><a href="Model-keywords.html">Model</a></li>
	        <li><a href="MultipleIsotropicMisesFlows-keywords.html">MultipleIsotropicMisesFlows</a></li>
	        <li><a href="RungeKutta-keywords.html">RungeKutta</a></li>
	        <li><a href="RungeKuttaFiniteStrain-keywords.html">RungeKuttaFiniteStrain</a></li>
	        <li><a href="RungeKuttaGenericBehaviour-keywords.html">RungeKuttaGenericBehaviour</a></li>
	        <li><a href="RungeKuttaModel-keywords.html">RungeKuttaModel</a></li>
	      </ul>
	    </li>
	    <li><a href="MTest-keywords.html">MTest keywords</a></li>
	    <li><a href="physical-constants.html">Physical constants</a></li>
	    <li><a href="glossary.html">Glossary</a></li>
	    <li><a href="publications.html">Publications</a></li>
	    <li><a href="faq.html">FAQ</a></li>
	    <li><a href="about.html">About</a></li>
	  </ul>
	</li>
	<li><a>Contributing</a>
	  <ul>
	    <li><a href="https://github.com/thelfer/tfel">Access to sources</a></li>
	    <li><a href="contributing.html">Contributing guidelines</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Report bugs</a></li>
	  </ul>
	</li>
	<li><a>Getting Help</a>
	  <ul>
	    <li><a href="search.html">Search on this site</a></li>
	    <li><a href="https://github.com/thelfer/tfel/discussions">Forum</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Bug report</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Feature request</a></li>
	    <li><a href="mailto:tfel-contact@cea.fr">Contact</a></li>
	  </ul>
	</li>
      </ul>
    </header>
<div id="header">
<h1 class="title">Implementation of mean-field homogenization schemes
for biphasic elastic media</h1>
<h2 class="author">Martin Antoine</h2>
<h3 class="date">February 24, 2025</h3>
</div>
<div id="TOC">
<ul>
<li><a href="#available-schemes" id="toc-available-schemes">Available
schemes</a></li>
<li><a href="#example-1-a-distribution-of-spherical-inclusions"
id="toc-example-1-a-distribution-of-spherical-inclusions">Example 1: a
distribution of spherical inclusions</a>
<ul>
<li><a href="#implementation-in-mfront"
id="toc-implementation-in-mfront">Implementation in
<code>MFront</code></a></li>
<li><a href="#results" id="toc-results">Results</a></li>
</ul></li>
<li><a href="#example-2-distributions-of-ellipsoidal-inclusions"
id="toc-example-2-distributions-of-ellipsoidal-inclusions">Example 2:
distributions of ellipsoidal inclusions</a>
<ul>
<li><a href="#implementation-in-mfront-1"
id="toc-implementation-in-mfront-1">Implementation in
<code>MFront</code></a></li>
<li><a href="#results-1" id="toc-results-1">Results</a></li>
</ul></li>
</ul>
</div>
<p>This tutorial shows how to implement in <code>MFront</code>
mean-field homogenization schemes within the framework of 3d linear
elasticity, for biphasic media.</p>
<p>These homogenization schemes are part of the <code>namespace</code>
<code>tfel::material::homogenization::elasticity</code>. They are
implemented via the <code>DSL</code> <code>@MaterialLaw</code>.</p>
<h1 id="available-schemes">Available schemes</h1>
<p>The implemented schemes for biphasic media are:</p>
<ul>
<li>Dilute scheme</li>
<li>Mori-Tanaka scheme</li>
<li>Voigt and Reuss bounds</li>
<li>Isotropic Hashin-Shtrikman bounds</li>
</ul>
<p>For dilute scheme and Mori-Tanaka scheme, the following assumptions
are made:</p>
<ul>
<li>the microstructure is biphasic</li>
<li>the phases are isotropic</li>
<li>one phase is a matrix, the other is made by inclusions</li>
<li>the shape of inclusions can be spherical, spheroidal, ellipsoidal,
otherwise the mean strain localisator (for a single inclusion problem)
can be provided by the user</li>
<li>for non-spherical inclusions, we consider 3 possibilities of
orientation distribution: isotropic, transverse isotropic and
oriented</li>
</ul>
<p>For Voigt, Reuss and Hashin-Shtrikman bounds, the following
assumptions are made:</p>
<ul>
<li>N phases can be considered</li>
<li>the phases can be anisotropic for Voigt and Reuss bounds, but only
isotropic for Hashin-Shtrikman bounds</li>
</ul>
<h1 id="example-1-a-distribution-of-spherical-inclusions">Example 1: a
distribution of spherical inclusions</h1>
<p>We begin with a basic example: a particulate composite with spherical
inclusions.</p>
<h2 id="implementation-in-mfront">Implementation in
<code>MFront</code></h2>
<p>Here is the header of the <code>mfront</code> file:</p>
<div class="sourceCode" id="biphasic"><pre
class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp"><span id="biphasic-1"><a href="#biphasic-1"></a><span class="er">@</span>DSL MaterialLaw<span class="op">;</span></span>
<span id="biphasic-2"><a href="#biphasic-2"></a><span class="er">@</span>Law Spherical<span class="op">;</span></span>
<span id="biphasic-3"><a href="#biphasic-3"></a><span class="er">@</span>Material biphasic<span class="op">;</span></span>
<span id="biphasic-4"><a href="#biphasic-4"></a><span class="er">@</span>UseQt <span class="kw">true</span><span class="op">;</span></span></code></pre></div>
<p>Here we want to let the user choose which scheme he wants to use:
dilute scheme, Mori-Tanaka scheme… Hence, a real parameter is defined as
an input, which can be 0 for dilute scheme, 1 for Mori-Tanaka…
(<code>f</code> is the volume fraction of inclusion phase).</p>
<div class="sourceCode" id="biphasic"><pre
class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp"><span id="biphasic-1"><a href="#biphasic-1"></a><span class="er">@</span>StateVariable real scheme<span class="op">;</span></span>
<span id="biphasic-2"><a href="#biphasic-2"></a>scheme<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;HomogenizationScheme&quot;</span><span class="op">);</span></span>
<span id="biphasic-3"><a href="#biphasic-3"></a><span class="er">@</span>StateVariable stress E0<span class="op">;</span></span>
<span id="biphasic-4"><a href="#biphasic-4"></a>E0<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;MatrixYoungModulus&quot;</span><span class="op">);</span></span>
<span id="biphasic-5"><a href="#biphasic-5"></a><span class="er">@</span>StateVariable real nu0<span class="op">;</span></span>
<span id="biphasic-6"><a href="#biphasic-6"></a>nu0<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;MatrixPoissonRatio&quot;</span><span class="op">);</span></span>
<span id="biphasic-7"><a href="#biphasic-7"></a><span class="er">@</span>StateVariable stress Ei<span class="op">;</span></span>
<span id="biphasic-8"><a href="#biphasic-8"></a>Ei<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;InclusionYoungModulus&quot;</span><span class="op">);</span></span>
<span id="biphasic-9"><a href="#biphasic-9"></a><span class="er">@</span>StateVariable real nui<span class="op">;</span></span>
<span id="biphasic-10"><a href="#biphasic-10"></a>nui<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;InclusionPoissonRatio&quot;</span><span class="op">);</span></span>
<span id="biphasic-11"><a href="#biphasic-11"></a><span class="er">@</span>StateVariable real f<span class="op">;</span></span>
<span id="biphasic-12"><a href="#biphasic-12"></a>f<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;InclusionVolumeFraction&quot;</span><span class="op">);</span></span></code></pre></div>
<p>It is important not to forget the header files that must be
included:</p>
<div class="sourceCode" id="biphasic"><pre
class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp"><span id="biphasic-1"><a href="#biphasic-1"></a><span class="er">@</span>TFELLibraries <span class="op">{</span><span class="st">&quot;Material&quot;</span><span class="op">};</span></span>
<span id="biphasic-2"><a href="#biphasic-2"></a></span>
<span id="biphasic-3"><a href="#biphasic-3"></a><span class="er">@</span>Includes<span class="op">{</span></span>
<span id="biphasic-4"><a href="#biphasic-4"></a><span class="pp">#include </span><span class="im">&quot;TFEL/Material/LinearHomogenizationSchemes.hxx&quot;</span></span>
<span id="biphasic-5"><a href="#biphasic-5"></a><span class="pp">#include </span><span class="im">&quot;TFEL/Material/LinearHomogenizationBounds.hxx&quot;</span></span>
<span id="biphasic-6"><a href="#biphasic-6"></a><span class="op">}</span></span></code></pre></div>
<p>Note that <code>@TFELLibraries</code> lets the user specify a
<code>TFEL</code> library to link with. The header
<code>LinearHomogenizationSchemes.hxx</code> is needed for dilute scheme
and Mori-Tanaka scheme, whereas here
<code>LinearHomogenizationBounds.hxx</code> will be used for computing
upper Hashin-Shtrikman (HS) bound. It is indeed known that the lower
Hashin-Shtrikman bound is equal to the Mori-Tanaka scheme with
spheres.</p>
<p>We choose the Young homogenized modulus <code>E</code> to be the
output of our <code>Function</code>.</p>
<div class="sourceCode" id="biphasic"><pre
class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp"><span id="biphasic-1"><a href="#biphasic-1"></a><span class="er">@</span>Output stress E<span class="op">;</span></span></code></pre></div>
<p>Here is the implementation of the different homogenized schemes:</p>
<div class="sourceCode" id="biphasic"><pre
class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp"><span id="biphasic-1"><a href="#biphasic-1"></a><span class="er">@</span>Function<span class="op">{</span></span>
<span id="biphasic-2"><a href="#biphasic-2"></a><span class="kw">using</span> <span class="kw">namespace</span> tfel<span class="op">::</span>material<span class="op">::</span>homogenization<span class="op">::</span>elasticity<span class="op">;</span></span>
<span id="biphasic-3"><a href="#biphasic-3"></a><span class="bu">std::</span>pair<span class="op">&lt;</span>stress<span class="op">,</span>real<span class="op">&gt;</span> pa<span class="op">;</span></span>
<span id="biphasic-4"><a href="#biphasic-4"></a><span class="cf">if</span> <span class="op">(</span>scheme<span class="op">==</span>real<span class="op">(</span><span class="dv">0</span><span class="op">)){</span></span>
<span id="biphasic-5"><a href="#biphasic-5"></a>pa<span class="op">=</span>computeSphereDiluteScheme<span class="op">&lt;</span>real<span class="op">,</span>stress<span class="op">&gt;(</span>E0<span class="op">,</span>nu0<span class="op">,</span>f<span class="op">,</span>Ei<span class="op">,</span>nui<span class="op">);</span></span>
<span id="biphasic-6"><a href="#biphasic-6"></a><span class="op">}</span></span>
<span id="biphasic-7"><a href="#biphasic-7"></a><span class="cf">if</span> <span class="op">(</span>scheme<span class="op">==</span>real<span class="op">(</span><span class="dv">1</span><span class="op">)){</span></span>
<span id="biphasic-8"><a href="#biphasic-8"></a>pa<span class="op">=</span>computeSphereMoriTanakaScheme<span class="op">&lt;</span>real<span class="op">,</span>stress<span class="op">&gt;(</span>E0<span class="op">,</span>nu0<span class="op">,</span>f<span class="op">,</span>Ei<span class="op">,</span>nui<span class="op">);</span></span>
<span id="biphasic-9"><a href="#biphasic-9"></a><span class="op">};</span></span>
<span id="biphasic-10"><a href="#biphasic-10"></a><span class="cf">if</span> <span class="op">(</span>scheme<span class="op">==</span>real<span class="op">(</span><span class="dv">2</span><span class="op">)){</span></span>
<span id="biphasic-11"><a href="#biphasic-11"></a><span class="bu">std::</span>array<span class="op">&lt;</span>real<span class="op">,</span><span class="dv">2</span><span class="op">&gt;</span> tab_f<span class="op">={</span><span class="dv">1</span><span class="op">-</span>f<span class="op">,</span>f<span class="op">};</span></span>
<span id="biphasic-12"><a href="#biphasic-12"></a><span class="kw">auto</span> k0<span class="op">=</span>E0<span class="op">/</span><span class="dv">3</span><span class="op">/(</span><span class="dv">1</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span>nu0<span class="op">);</span></span>
<span id="biphasic-13"><a href="#biphasic-13"></a><span class="kw">auto</span> ki<span class="op">=</span>Ei<span class="op">/</span><span class="dv">3</span><span class="op">/(</span><span class="dv">1</span><span class="op">-</span><span class="dv">2</span><span class="op">*</span>nui<span class="op">);</span></span>
<span id="biphasic-14"><a href="#biphasic-14"></a><span class="bu">std::</span>array<span class="op">&lt;</span>stress<span class="op">,</span><span class="dv">2</span><span class="op">&gt;</span> tab_k<span class="op">={</span>k0<span class="op">,</span>ki<span class="op">};</span></span>
<span id="biphasic-15"><a href="#biphasic-15"></a><span class="kw">auto</span> mu0<span class="op">=</span>E0<span class="op">/</span><span class="dv">2</span><span class="op">/(</span><span class="dv">1</span><span class="op">+</span>nu0<span class="op">);</span></span>
<span id="biphasic-16"><a href="#biphasic-16"></a><span class="kw">auto</span> mui<span class="op">=</span>Ei<span class="op">/</span><span class="dv">2</span><span class="op">/(</span><span class="dv">1</span><span class="op">+</span>nui<span class="op">);</span></span>
<span id="biphasic-17"><a href="#biphasic-17"></a><span class="bu">std::</span>array<span class="op">&lt;</span>stress<span class="op">,</span><span class="dv">2</span><span class="op">&gt;</span> tab_mu<span class="op">={</span>mu0<span class="op">,</span>mui<span class="op">};</span></span>
<span id="biphasic-18"><a href="#biphasic-18"></a><span class="kw">auto</span> pa2<span class="op">=</span>computeIsotropicHashinShtrikmanBounds<span class="op">&lt;</span><span class="dv">3</span><span class="bu">u</span><span class="op">,</span><span class="dv">2</span><span class="bu">u</span><span class="op">,</span>real<span class="op">,</span>stress<span class="op">&gt;(</span>tab_f<span class="op">,</span>tab_k<span class="op">,</span>tab_mu<span class="op">);</span></span>
<span id="biphasic-19"><a href="#biphasic-19"></a><span class="kw">auto</span> UB<span class="op">=</span><span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">1</span><span class="op">&gt;(</span>pa2<span class="op">);</span></span>
<span id="biphasic-20"><a href="#biphasic-20"></a><span class="kw">auto</span> kh<span class="op">=</span><span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">0</span><span class="op">&gt;(</span>UB<span class="op">);</span></span>
<span id="biphasic-21"><a href="#biphasic-21"></a><span class="kw">auto</span> muh<span class="op">=</span><span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">1</span><span class="op">&gt;(</span>UB<span class="op">);</span></span>
<span id="biphasic-22"><a href="#biphasic-22"></a><span class="kw">auto</span> Eh<span class="op">=</span><span class="dv">9</span><span class="op">*</span>kh<span class="op">*</span>muh<span class="op">/(</span>muh<span class="op">+</span><span class="dv">3</span><span class="op">*</span>kh<span class="op">);</span></span>
<span id="biphasic-23"><a href="#biphasic-23"></a><span class="kw">auto</span> nuh<span class="op">=(</span><span class="dv">3</span><span class="op">*</span>kh<span class="op">-</span><span class="dv">2</span><span class="op">*</span>muh<span class="op">)/</span><span class="dv">2</span><span class="op">/(</span><span class="dv">3</span><span class="op">*</span>kh<span class="op">+</span>muh<span class="op">);</span></span>
<span id="biphasic-24"><a href="#biphasic-24"></a>pa<span class="op">={</span>Eh<span class="op">,</span>nuh<span class="op">};</span></span>
<span id="biphasic-25"><a href="#biphasic-25"></a><span class="op">};</span></span>
<span id="biphasic-26"><a href="#biphasic-26"></a>E<span class="op">=</span><span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">0</span><span class="op">&gt;(</span>pa<span class="op">);</span></span>
<span id="biphasic-27"><a href="#biphasic-27"></a><span class="op">}</span></span></code></pre></div>
<p>Hence, <code>pa</code> is a <code>std::pair</code> that returns the
Young homogenized modulus and the homogenized Poisson ratio. The
computation of dilute scheme and Mori-Tanaka scheme are
straightforward.</p>
<p>The function <code>computeIsotropicHashinShtrikmanBounds</code>
necessitates to give the arrays of volume fractions <code>tab_f</code>,
bulk moduli <code>tab_k</code> and shear moduli <code>tab_mu</code>. The
function returns a pair of pair. The first pair is lower HS bound, the
second is upper HS bound (that we want here). Each bound is a pair whose
first element is the bulk modulus, and whose second element is the shear
modulus. The function is also available for plain strain elasticity (the
first template argument is the dimension).</p>
<h2 id="results">Results</h2>
<p>We choose <code>interface</code> <code>python</code> to compute the
schemes for a volume fraction of spheres which goes from 0 to 1.</p>
<p>Here is the <code>python</code> file :</p>
<div class="sourceCode" id="biphasic"><pre
class="sourceCode numberSource py numberLines"><code class="sourceCode python"><span id="biphasic-1"><a href="#biphasic-1"></a><span class="im">import</span> src.biphasic <span class="im">as</span> bip</span>
<span id="biphasic-2"><a href="#biphasic-2"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="biphasic-3"><a href="#biphasic-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="biphasic-4"><a href="#biphasic-4"></a></span>
<span id="biphasic-5"><a href="#biphasic-5"></a>frac<span class="op">=</span>np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">200</span>)</span>
<span id="biphasic-6"><a href="#biphasic-6"></a>E_DS<span class="op">=</span>np.array([bip.biphasic_Spherical(<span class="dv">0</span>,<span class="fl">1e9</span>,<span class="fl">0.2</span>,<span class="fl">100e9</span>,<span class="fl">0.3</span>,f)<span class="op">/</span><span class="fl">1e11</span> <span class="cf">for</span> f <span class="kw">in</span> frac])</span>
<span id="biphasic-7"><a href="#biphasic-7"></a>E_MT<span class="op">=</span>np.array([bip.biphasic_Spherical(<span class="dv">1</span>,<span class="fl">1e9</span>,<span class="fl">0.2</span>,<span class="fl">100e9</span>,<span class="fl">0.3</span>,f)<span class="op">/</span><span class="fl">1e11</span> <span class="cf">for</span> f <span class="kw">in</span> frac])</span>
<span id="biphasic-8"><a href="#biphasic-8"></a>E_HS<span class="op">=</span>np.array([bip.biphasic_Spherical(<span class="dv">2</span>,<span class="fl">1e9</span>,<span class="fl">0.2</span>,<span class="fl">100e9</span>,<span class="fl">0.3</span>,f)<span class="op">/</span><span class="fl">1e11</span> <span class="cf">for</span> f <span class="kw">in</span> frac])</span>
<span id="biphasic-9"><a href="#biphasic-9"></a>plt.figure()</span>
<span id="biphasic-10"><a href="#biphasic-10"></a>g1,<span class="op">=</span>plt.plot(frac,E_DS,color<span class="op">=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="biphasic-11"><a href="#biphasic-11"></a>g2,<span class="op">=</span>plt.plot(frac,E_MT,color<span class="op">=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="biphasic-12"><a href="#biphasic-12"></a>g3,<span class="op">=</span>plt.plot(frac,E_HS,color<span class="op">=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="biphasic-13"><a href="#biphasic-13"></a>plt.legend([g1,g2,g3],[<span class="st">&#39;Dilute&#39;</span>,<span class="st">&#39;Mori-Tanaka&#39;</span>,<span class="st">&#39;upper HS bound&#39;</span>])</span>
<span id="biphasic-14"><a href="#biphasic-14"></a>plt.xlabel(<span class="vs">r&#39;$f$&#39;</span>)</span>
<span id="biphasic-15"><a href="#biphasic-15"></a>plt.ylabel(<span class="vs">r&#39;$E/E_0$&#39;</span>,rotation<span class="op">=</span><span class="st">&#39;horizontal&#39;</span>)</span>
<span id="biphasic-16"><a href="#biphasic-16"></a>plt.show()</span>
<span id="biphasic-17"><a href="#biphasic-17"></a>plt.close()</span></code></pre></div>
<p>The results are given by the following figure.</p>
<figure>
<img src="./img/Spherical.png"
alt="Homogenized young modulus of a composite made of a matrix and spherical inclusions as a function of the volume fraction of spheres" />
<figcaption aria-hidden="true">Homogenized young modulus of a composite
made of a matrix and spherical inclusions as a function of the volume
fraction of spheres</figcaption>
</figure>
<h1 id="example-2-distributions-of-ellipsoidal-inclusions">Example 2:
distributions of ellipsoidal inclusions</h1>
<p>The example of a composite with ellipsoidal inclusions can be
implemented considering various examples of distributions. We will focus
on Mori-Tanaka scheme, but dilute scheme can also be computed.</p>
<h2 id="implementation-in-mfront-1">Implementation in
<code>MFront</code></h2>
<p>The first lines are not so different from example 1, except the fact
that we now define a <code>real</code> parameter <code>distrib</code> to
let the user choose the distribution of ellipsoids: isotropic,
transverse isotropic, or oriented. We also introduce the semi-lengths
<code>a</code>,<code>b</code>,<code>c</code> of the ellipsoid.</p>
<div class="sourceCode" id="biphasic"><pre
class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp"><span id="biphasic-1"><a href="#biphasic-1"></a><span class="er">@</span>StateVariable real distrib<span class="op">;</span></span>
<span id="biphasic-2"><a href="#biphasic-2"></a>distrib<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;TypeOfDistribution&quot;</span><span class="op">);</span></span>
<span id="biphasic-3"><a href="#biphasic-3"></a><span class="er">@</span>StateVariable stress E0<span class="op">;</span></span>
<span id="biphasic-4"><a href="#biphasic-4"></a>E0<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;MatrixYoungModulus&quot;</span><span class="op">);</span></span>
<span id="biphasic-5"><a href="#biphasic-5"></a><span class="er">@</span>StateVariable real nu0<span class="op">;</span></span>
<span id="biphasic-6"><a href="#biphasic-6"></a>nu0<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;MatrixPoissonRatio&quot;</span><span class="op">);</span></span>
<span id="biphasic-7"><a href="#biphasic-7"></a><span class="er">@</span>StateVariable stress Ei<span class="op">;</span></span>
<span id="biphasic-8"><a href="#biphasic-8"></a>Ei<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;InclusionYoungModulus&quot;</span><span class="op">);</span></span>
<span id="biphasic-9"><a href="#biphasic-9"></a><span class="er">@</span>StateVariable real nui<span class="op">;</span></span>
<span id="biphasic-10"><a href="#biphasic-10"></a>nui<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;InclusionPoissonRatio&quot;</span><span class="op">);</span></span>
<span id="biphasic-11"><a href="#biphasic-11"></a><span class="er">@</span>StateVariable real f<span class="op">;</span></span>
<span id="biphasic-12"><a href="#biphasic-12"></a>f<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;InclusionVolumeFraction&quot;</span><span class="op">);</span></span>
<span id="biphasic-13"><a href="#biphasic-13"></a><span class="er">@</span>StateVariable length a<span class="op">;</span></span>
<span id="biphasic-14"><a href="#biphasic-14"></a>a<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;FirstSemiLength&quot;</span><span class="op">);</span></span>
<span id="biphasic-15"><a href="#biphasic-15"></a><span class="er">@</span>StateVariable length b<span class="op">;</span></span>
<span id="biphasic-16"><a href="#biphasic-16"></a>b<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;SecondSemiLength&quot;</span><span class="op">);</span></span>
<span id="biphasic-17"><a href="#biphasic-17"></a><span class="er">@</span>StateVariable length c<span class="op">;</span></span>
<span id="biphasic-18"><a href="#biphasic-18"></a>c<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;ThirdSemiLength&quot;</span><span class="op">);</span></span></code></pre></div>
<p>Note that the orientation for the oriented case will be fixed in the
<code>mfront</code> file, and it will be the same for the transverse
isotropic case which necessitates to gives the direction of one of the
axes of the ellipsoid. But those orientations could also be inputs of
the law.</p>
<p>Here is the <code>Function</code> block:</p>
<div class="sourceCode" id="biphasic"><pre
class="sourceCode numberSource cpp numberLines"><code class="sourceCode cpp"><span id="biphasic-1"><a href="#biphasic-1"></a><span class="er">@</span>Function<span class="op">{</span></span>
<span id="biphasic-2"><a href="#biphasic-2"></a>tfel<span class="op">::</span>math<span class="op">::</span>tvector<span class="op">&lt;</span><span class="dv">3</span><span class="bu">u</span><span class="op">,</span>real<span class="op">&gt;</span> n_a<span class="op">={</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">};</span></span>
<span id="biphasic-3"><a href="#biphasic-3"></a>tfel<span class="op">::</span>math<span class="op">::</span>tvector<span class="op">&lt;</span><span class="dv">3</span><span class="bu">u</span><span class="op">,</span>real<span class="op">&gt;</span> n_b<span class="op">={</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">};</span></span>
<span id="biphasic-4"><a href="#biphasic-4"></a><span class="kw">using</span> <span class="kw">namespace</span> tfel<span class="op">::</span>material<span class="op">::</span>homogenization<span class="op">::</span>elasticity<span class="op">;</span></span>
<span id="biphasic-5"><a href="#biphasic-5"></a><span class="cf">if</span> <span class="op">(</span>distrib<span class="op">==</span>real<span class="op">(</span><span class="dv">0</span><span class="op">)){</span></span>
<span id="biphasic-6"><a href="#biphasic-6"></a><span class="kw">auto</span> pa <span class="op">=</span> computeIsotropicMoriTanakaScheme<span class="op">&lt;</span>real<span class="op">,</span>stress<span class="op">,</span>length<span class="op">&gt;(</span>E0<span class="op">,</span>nu0<span class="op">,</span>f<span class="op">,</span>Ei<span class="op">,</span>nui<span class="op">,</span>a<span class="op">,</span>b<span class="op">,</span>c<span class="op">);</span></span>
<span id="biphasic-7"><a href="#biphasic-7"></a>E1<span class="op">=</span><span class="bu">std::</span>get<span class="op">&lt;</span><span class="dv">0</span><span class="op">&gt;(</span>pa<span class="op">);</span></span>
<span id="biphasic-8"><a href="#biphasic-8"></a><span class="op">}</span></span>
<span id="biphasic-9"><a href="#biphasic-9"></a><span class="cf">if</span> <span class="op">(</span>distrib<span class="op">==</span>real<span class="op">(</span><span class="dv">1</span><span class="op">)){</span></span>
<span id="biphasic-10"><a href="#biphasic-10"></a><span class="kw">auto</span> Chom<span class="op">=</span>computeTransverseIsotropicMoriTanakaScheme<span class="op">&lt;</span>real<span class="op">,</span>stress<span class="op">,</span>length<span class="op">&gt;(</span>E0<span class="op">,</span>nu0<span class="op">,</span>f<span class="op">,</span>Ei<span class="op">,</span>nui<span class="op">,</span>n_a<span class="op">,</span>a<span class="op">,</span>b<span class="op">,</span>c<span class="op">);</span></span>
<span id="biphasic-11"><a href="#biphasic-11"></a><span class="kw">auto</span> Shom<span class="op">=</span>invert<span class="op">(</span>Chom<span class="op">);</span></span>
<span id="biphasic-12"><a href="#biphasic-12"></a>E1<span class="op">=</span><span class="dv">1</span><span class="op">/</span>Shom<span class="op">(</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">);</span></span>
<span id="biphasic-13"><a href="#biphasic-13"></a><span class="op">}</span></span>
<span id="biphasic-14"><a href="#biphasic-14"></a><span class="cf">if</span> <span class="op">(</span>distrib<span class="op">==</span>real<span class="op">(</span><span class="dv">2</span><span class="op">)){</span></span>
<span id="biphasic-15"><a href="#biphasic-15"></a><span class="kw">auto</span> Chom<span class="op">=</span>computeOrientedMoriTanakaScheme<span class="op">&lt;</span>real<span class="op">,</span>stress<span class="op">,</span>length<span class="op">&gt;(</span>E0<span class="op">,</span>nu0<span class="op">,</span>f<span class="op">,</span>Ei<span class="op">,</span>nui<span class="op">,</span>n_a<span class="op">,</span>a<span class="op">,</span>n_b<span class="op">,</span>b<span class="op">,</span>c<span class="op">);</span></span>
<span id="biphasic-16"><a href="#biphasic-16"></a><span class="kw">auto</span> Shom<span class="op">=</span>invert<span class="op">(</span>Chom<span class="op">);</span></span>
<span id="biphasic-17"><a href="#biphasic-17"></a>E1<span class="op">=</span><span class="dv">1</span><span class="op">/</span>Shom<span class="op">(</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">);</span></span>
<span id="biphasic-18"><a href="#biphasic-18"></a><span class="op">}</span></span>
<span id="biphasic-19"><a href="#biphasic-19"></a><span class="op">}</span></span></code></pre></div>
<p>For <code>computeTransverseIsotropicMoriTanakaScheme</code>, only one
vector <code>n_a</code> is used. It specifies the direction of
transverse isotropy. The ellipsoid has one axis aligned with this
vector, and the semi-length of this axis is specified immediately after
<code>n_a</code> (here <code>a</code>). This is in fact a special case
of transverse isotropy for which the ellipsoid rotates around one of its
principal axes. For <code>computeOrientedMoriTanakaScheme</code>, the
first vector <code>n_a</code> is the direction of one axis, whose
semi-length is precised immediately after (here <code>a</code>) and the
same goes for the second vector and second semi-length. If the vectors
are not normals, an error is returned. However, the norms of these
vectors can be different from 1.</p>
<h2 id="results-1">Results</h2>
<p>We choose <code>interface</code> <code>python</code> to compute the
schemes for a volume fraction of ellipsoids which goes from 0 to 1.</p>
<p>Here is the <code>python</code> file :</p>
<div class="sourceCode" id="biphasic"><pre
class="sourceCode numberSource py numberLines"><code class="sourceCode python"><span id="biphasic-1"><a href="#biphasic-1"></a><span class="im">import</span> src.biphasic <span class="im">as</span> bip</span>
<span id="biphasic-2"><a href="#biphasic-2"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="biphasic-3"><a href="#biphasic-3"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="biphasic-4"><a href="#biphasic-4"></a></span>
<span id="biphasic-5"><a href="#biphasic-5"></a></span>
<span id="biphasic-6"><a href="#biphasic-6"></a>frac<span class="op">=</span>np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">200</span>)</span>
<span id="biphasic-7"><a href="#biphasic-7"></a>E_I<span class="op">=</span>np.array([bip.biphasic_Ellipsoidal(<span class="dv">0</span>,<span class="fl">1e9</span>,<span class="fl">0.2</span>,<span class="fl">100e9</span>,<span class="fl">0.3</span>,f,<span class="dv">30</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">/</span><span class="fl">1e11</span> <span class="cf">for</span> f <span class="kw">in</span> frac])</span>
<span id="biphasic-8"><a href="#biphasic-8"></a>E_TI<span class="op">=</span>np.array([bip.biphasic_Ellipsoidal(<span class="dv">1</span>,<span class="fl">1e9</span>,<span class="fl">0.2</span>,<span class="fl">100e9</span>,<span class="fl">0.3</span>,f,<span class="dv">1</span>,<span class="dv">30</span>,<span class="dv">1</span>)<span class="op">/</span><span class="fl">1e11</span> <span class="cf">for</span> f <span class="kw">in</span> frac])</span>
<span id="biphasic-9"><a href="#biphasic-9"></a>E_O<span class="op">=</span>np.array([bip.biphasic_Ellipsoidal(<span class="dv">2</span>,<span class="fl">1e9</span>,<span class="fl">0.2</span>,<span class="fl">100e9</span>,<span class="fl">0.3</span>,f,<span class="dv">30</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="op">/</span><span class="fl">1e11</span> <span class="cf">for</span> f <span class="kw">in</span> frac])</span>
<span id="biphasic-10"><a href="#biphasic-10"></a>plt.figure()</span>
<span id="biphasic-11"><a href="#biphasic-11"></a>g1,<span class="op">=</span>plt.plot(frac,E_I,color<span class="op">=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="biphasic-12"><a href="#biphasic-12"></a>g2,<span class="op">=</span>plt.plot(frac,E_TI,color<span class="op">=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="biphasic-13"><a href="#biphasic-13"></a>g3,<span class="op">=</span>plt.plot(frac,E_O,color<span class="op">=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="biphasic-14"><a href="#biphasic-14"></a>plt.legend([g1,g2,g3],[<span class="st">&#39;Isotropic&#39;</span>,<span class="st">&#39;Transverse Isotropic&#39;</span>,<span class="st">&#39;Oriented&#39;</span>])</span>
<span id="biphasic-15"><a href="#biphasic-15"></a>plt.xlabel(<span class="vs">r&#39;$f$&#39;</span>)</span>
<span id="biphasic-16"><a href="#biphasic-16"></a>plt.ylabel(<span class="vs">r&#39;$E^</span><span class="sc">{1}</span><span class="vs">/E^</span><span class="sc">{1}</span><span class="vs">_0$&#39;</span>,rotation<span class="op">=</span><span class="st">&#39;horizontal&#39;</span>)</span>
<span id="biphasic-17"><a href="#biphasic-17"></a>plt.show()</span>
<span id="biphasic-18"><a href="#biphasic-18"></a>plt.close()</span></code></pre></div>
<p>We see here that we chose prolate spheroids for the ellipsoids, with
aspect ratio of 30. The first case is the isotropic distribution, the
second case is the transverse isotropic distribution where the biggest
axis rotates in the <code>y-z</code> plane, and in the last case, the
biggest axis is oriented in the <code>x</code> direction. The results
are given by the following figure.</p>
<figure>
<img src="./img/Ellipsoidal.png"
alt="Homogenized young modulus (direction 1) of a composite made of a matrix and ellipsoidal inclusions as a function of the volume fraction of ellipsoids" />
<figcaption aria-hidden="true">Homogenized young modulus (direction 1)
of a composite made of a matrix and ellipsoidal inclusions as a function
of the volume fraction of ellipsoids</figcaption>
</figure>
<!-- Local IspellDict: english -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-62273823-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
