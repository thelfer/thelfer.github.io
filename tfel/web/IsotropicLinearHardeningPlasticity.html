
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="generator" content="pandoc" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>How to implement an isotropic plastic behaviour with isotropic linear hardening in MFront</title>
        <meta name="author" content="Thomas Helfer, Lorenzo Riparbelli, Ioannis Christovasilis" />
            <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <style type="text/css">code{white-space: pre;}</style>
            <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          color: #aaaaaa;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
      div.sourceCode
        {  background-color: #f8f8f8; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span.al { color: #ef2929; } /* Alert */
      code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
      code span.at { color: #204a87; } /* Attribute */
      code span.bn { color: #0000cf; } /* BaseN */
      code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #4e9a06; } /* Char */
      code span.cn { color: #8f5902; } /* Constant */
      code span.co { color: #8f5902; font-style: italic; } /* Comment */
      code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
      code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
      code span.dt { color: #204a87; } /* DataType */
      code span.dv { color: #0000cf; } /* DecVal */
      code span.er { color: #a40000; font-weight: bold; } /* Error */
      code span.ex { } /* Extension */
      code span.fl { color: #0000cf; } /* Float */
      code span.fu { color: #204a87; font-weight: bold; } /* Function */
      code span.im { } /* Import */
      code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
      code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
      code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
      code span.ot { color: #8f5902; } /* Other */
      code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
      code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
      code span.ss { color: #4e9a06; } /* SpecialString */
      code span.st { color: #4e9a06; } /* String */
      code span.va { color: #000000; } /* Variable */
      code span.vs { color: #4e9a06; } /* VerbatimString */
      code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    </style>
            <link rel="stylesheet" href="css/normalize.css"/>
    <link rel="stylesheet" href="css/main.css"/>
        <script
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
        type="text/javascript"></script>
          </head>
  <body>
    <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
        <header>
      <ul id="nav">
	<li><a href="news.html">News</a></li>
	<li><a href="index.html">Overview</a>
	  <ul>
	    <li><a>Domain specific languages</a>
	      <ul>
		<li><a href="material-properties.html">Material properties</a></li>
		<li><a href="behaviours.html">Mechanical behaviours</a></li>
		<li><a href="models.html">Models</a></li>
	      </ul>
            </li>
	    <li><a href="interfaces.html">Available interfaces</a></li>
	    <li><a href="associated-projects.html">Associated projects</a></li>
     	    <li><a>Tools</a>
	      <ul>
	        <li><a href="mfront-doc.html">mfront-doc</a></li>
	        <li><a href="mtest.html">mtest</a></li>
	        <li><a href="mfm.html">mfm</a></li>
	        <li><a href="mfm-test-generator.html">mfm-test-generator</a></li>
	        <li><a href="tfel-check.html">tfel-check</a></li>
	      </ul>
	    </li>
	  </ul>
	</li>
	<li><a>Getting started</a>
	  <ul>
	    <li><a href="https://github.com/thelfer/tfel/">Github repository</a></li>
	    <li><a href="https://github.com/thelfer/tfel/releases">Download</a></li>
	    <li><a href="release-notes.html">Release notes</a>
	      <ul>
		<li><a>Versions 2.0.x</a>
                  <ul>
                    <li><a href="release-notes.html">Versions prior to 2.0.5</a></li>
	 	    <li><a href="release-notes-2.0.5.html">Version 2.0.5</a></li>
                  </ul>
		</li>
		<li><a>Versions 3.0.x</a>
                  <ul>
		    <li><a href="release-notes-3.0.html">Version 3.0.0</a></li>
		    <li><a href="release-notes-3.0.1.html">Version 3.0.1</a></li>
		    <li><a href="release-notes-3.0.2.html">Version 3.0.2</a></li>
		    <li><a href="release-notes-3.0.3.html">Version 3.0.3</a></li>
		    <li><a href="release-notes-3.0.4.html">Version 3.0.4</a></li>
		    <li><a href="release-notes-3.0.5.html">Version 3.0.5</a></li>
		    <li><a href="release-notes-3.0.6.html">Version 3.0.6</a></li>
		    <li><a href="release-notes-3.0.7.html">Version 3.0.7</a></li>
		    <li><a href="release-notes-3.0.8.html">Version 3.0.8</a></li>
		    <li><a href="release-notes-3.0.9.html">Version 3.0.9</a></li>
		    <li><a href="release-notes-3.0.10.html">Version 3.0.10</a></li>
		    <li><a href="release-notes-3.0.11.html">Version 3.0.11</a></li>
		    <li><a href="release-notes-3.0.12.html">Version 3.0.12</a></li>
		    <li><a href="release-notes-3.0.13.html">Version 3.0.13</a></li>
		    <li><a href="release-notes-3.0.14.html">Version 3.0.14</a></li>
		    <li><a href="release-notes-3.0.15.html">Version 3.0.15</a></li>
		    <li><a href="release-notes-3.0.16.html">Version 3.0.16</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.1.x</a>
		  <ul>
		    <li><a href="release-notes-3.1.html">Version 3.1.0</a></li>
		    <li><a href="release-notes-3.1.1.html">Version 3.1.1</a></li>
		    <li><a href="release-notes-3.1.2.html">Version 3.1.2</a></li>
		    <li><a href="release-notes-3.1.3.html">Version 3.1.3</a></li>
		    <li><a href="release-notes-3.1.4.html">Version 3.1.4</a></li>
		    <li><a href="release-notes-3.1.5.html">Version 3.1.5</a></li>
		    <li><a href="release-notes-3.1.6.html">Version 3.1.6</a></li>
		    <li><a href="release-notes-3.1.7.html">Version 3.1.7</a></li>
		    <li><a href="release-notes-3.1.8.html">Version 3.1.8</a></li>
		    <li><a href="release-notes-3.1.9.html">Version 3.1.9</a></li>
		    <li><a href="release-notes-3.1.10.html">Version 3.1.10</a></li>
		    <li><a href="release-notes-3.1.11.html">Version 3.1.11</a></li>
		    <li><a href="release-notes-3.1.12.html">Version 3.1.12</a></li>
		    <li><a href="release-notes-3.1.13.html">Version 3.1.13</a></li>
		    <li><a href="release-notes-3.1.14.html">Version 3.1.14</a></li>
		    <li><a href="release-notes-3.1.15.html">Version 3.1.15</a></li>
		    <li><a href="release-notes-3.1.16.html">Version 3.1.16</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.2.x</a>
		  <ul>
		    <li><a href="release-notes-3.2.html">Version 3.2.0</a></li>
		    <li><a href="release-notes-3.2.1.html">Version 3.2.1</a></li>
		    <li><a href="release-notes-3.2.2.html">Version 3.2.2</a></li>
		    <li><a href="release-notes-3.2.3.html">Version 3.2.3</a></li>
		    <li><a href="release-notes-3.2.4.html">Version 3.2.4</a></li>
		    <li><a href="release-notes-3.2.5.html">Version 3.2.5</a></li>
		    <li><a href="release-notes-3.2.6.html">Version 3.2.6</a></li>
		    <li><a href="release-notes-3.2.7.html">Version 3.2.7</a></li>
		    <li><a href="release-notes-3.2.8.html">Version 3.2.8</a></li>
		    <li><a href="release-notes-3.2.9.html">Version 3.2.9</a></li>
		    <li><a href="release-notes-3.2.10.html">Version 3.2.10</a></li>
		    <li><a href="release-notes-3.2.11.html">Version 3.2.11</a></li>
		    <li><a href="release-notes-3.2.12.html">Version 3.2.12</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.3.x</a>
		  <ul>
		    <li><a href="release-notes-3.3.html">Version 3.3.0</a></li>
		    <li><a href="release-notes-3.3.1.html">Version 3.3.1</a></li>
		    <li><a href="release-notes-3.3.1.html">Version 3.3.2</a></li>
		    <li><a href="release-notes-3.3.2.html">Version 3.3.2</a></li>
		    <li><a href="release-notes-3.3.3.html">Version 3.3.3</a></li>
		    <li><a href="release-notes-3.3.4.html">Version 3.3.4</a></li>
		    <li><a href="release-notes-3.3.5.html">Version 3.3.5</a></li>
		    <li><a href="release-notes-3.3.6.html">Version 3.3.6</a></li>
		    <li><a href="release-notes-3.3.7.html">Version 3.3.7</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.4.x</a>
		  <ul>
		    <li><a href="release-notes-3.4.html">Version 3.4.0</a></li>
		    <li><a href="release-notes-3.4.1.html">Version 3.4.1</a></li>
		    <li><a href="release-notes-3.4.2.html">Version 3.4.2</a></li>
		    <li><a href="release-notes-3.4.3.html">Version 3.4.3</a></li>
		    <li><a href="release-notes-3.4.4.html">Version 3.4.4</a></li>
		    <li><a href="release-notes-3.4.5.html">Version 3.4.5</a></li>
		    <li><a href="release-notes-3.4.6.html">Version 3.4.6</a></li>
		    <li><a href="release-notes-3.4.7.html">Version 3.4.7</a></li>
		    <li><a href="release-notes-3.4.8.html">Version 3.4.8</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.0.x</a>
		  <ul>
		    <li><a href="release-notes-4.0.html">Version 4.0.0</a></li>
		    <li><a href="release-notes-4.0.1.html">Version 4.0.1</a></li>
		    <li><a href="release-notes-4.0.2.html">Version 4.0.2</a></li>
		    <li><a href="release-notes-4.0.3.html">Version 4.0.3</a></li>
		    <li><a href="release-notes-4.0.4.html">Version 4.0.4</a></li>
		    <li><a href="release-notes-4.0.5.html">Version 4.0.5</a></li>
		    <li><a href="release-notes-4.0.6.html">Version 4.0.6</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.1.x</a>
		  <ul>
		    <li><a href="release-notes-4.1.html">Version 4.1.0</a></li>
		    <li><a href="release-notes-4.1.1.html">Version 4.1.1</a></li>
		    <li><a href="release-notes-4.1.2.html">Version 4.1.2</a></li>
		    <li><a href="release-notes-4.1.3.html">Version 4.1.3</a></li>
		    <li><a href="release-notes-4.1.4.html">Version 4.1.4</a></li>
		    <li><a href="release-notes-4.1.5.html">Version 4.1.5</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.2.x</a>
		  <ul>
		    <li><a href="release-notes-4.2.html">Version 4.2.0</a></li>
		    <li><a href="release-notes-4.2.1.html">Version 4.2.1</a></li>
		    <li><a href="release-notes-4.2.2.html">Version 4.2.2</a></li>
		    <li><a href="release-notes-4.2.3.html">Version 4.2.3</a></li>
		  </ul>
		</li>
		<li><a>Versions 5.0.x</a>
		  <ul>
		    <li><a href="release-notes-5.0.html">Version 5.0.0</a></li>
		    <li><a href="release-notes-5.0.1.html">Version 5.0.1</a></li>
		    <li><a href="release-notes-5.0.2.html">Version 5.0.2</a></li>
		  </ul>
		</li>
		<li><a>Versions 5.1.x</a>
		  <ul>
		    <li><a href="release-notes-5.1.html">Version 5.1.0</a></li>
		  </ul>
		</li>
	      </ul>
	    </li>
	    <li><a href="coverity-scan.html">Coverity scan</a></li>
	    <li><a href="install.html">Installation</a></li>
	  </ul>
	</li>
	<li><a>Documentation</a>
	  <ul>
	    <li><a href="documentations.html">General documentation</a></li>
	    <li><a href="gallery.html">Gallery</a></li>
<!--	    
	    <li><a href="http://tfel.sourceforge.net/doxygen/index.html">Doxygen documentation</a></li>
-->
	    <li><a>Behaviours</a>
	      <ul>
		<li><a href="tutorial.html">Tutorial</a></li>
		<li><a href="implicit-dsl.html">The Implicit DSL</a></li>
		<li><a href="benchmark.html">Benchmark</a></li>
		<li><a href="parameters.html">Parameters</a></li>
		<li><a href="BehaviourBricks.html">Behaviour bricks</a></li>
		<li><a href="interfaces.html">Solver interfaces</a>
		  <ul>
		    <li><a href="castem.html">Cast3M</a></li>
		    <li><a href="amitex.html">AMITEX_FFTP</a></li>
		    <li><a href="aster.html">Code-Aster</a></li>
    		    <li><a href="abaqus.html">Abaqus</a></li>
		    <li><a href="zmat.html">ZeBuLoN</a></li>
   		    <li><a href="calculix.html">CalculiX</a></li>
		    <!-- <li><a >TMFFT</a></li> -->
		    <li><a href="cyrano.html">Cyrano</a></li>
   		    <li><a href="generic-material-property-interface.html">Generic interface for material properties</a></li>
   		    <li><a href="generic-behaviours-interface.html">Generic interface for behaviours</a></li>
		  </ul>
		</li>
	      </ul>
	    </li>
	    <li><a>TFEL libraries</a>
	      <ul>
		<li><a href="libraries_usage.html">Usage of the TFEL libraries in C++</a></li>
		<li><a href="tfel-math.html">TFEL/Math</a></li>
		<li><a href="tfel-material.html">TFEL/Material</a></li>
	      </ul>
	    </li>
	    <li><a>Python modules</a>
	      <ul>
		<li><a href="tfel-python.html">TFEL modules</a></li>
		<li><a href="mfront-python.html">mfront module</a></li>
		<li><a href="mtest-python.html">mtest module</a></li>
	      </ul>
	    </li>
	    <li><a>MFront keywords</a>
	      <ul>
	        <li><a href="Default-keywords.html">Default</a></li>
	        <li><a href="DefaultCZM-keywords.html">DefaultCZM</a></li>
	        <li><a href="DefaultFiniteStrain-keywords.html">DefaultFiniteStrain</a></li>
	        <li><a href="DefaultGenericBehaviour-keywords.html">DefaultGenericBehaviour</a></li>
	        <li><a href="DefaultModel-keywords.html">DefaultModel</a></li>
	        <li><a href="Implicit-keywords.html">Implicit</a></li>
	        <li><a href="ImplicitCZM-keywords.html">ImplicitCZM</a></li>
	        <li><a href="ImplicitFiniteStrain-keywords.html">ImplicitFiniteStrain</a></li>
	        <li><a href="ImplicitGenericBehaviour-keywords.html">ImplicitGenericBehaviour</a></li>
	        <li><a href="ImplicitModel-keywords.html">ImplicitModel</a></li>
	        <li><a href="ImplicitII-keywords.html">ImplicitII</a></li>
	        <li><a href="IsotropicMisesCreep-keywords.html">IsotropicMisesCreep</a></li>
	        <li><a href="IsotropicMisesPlasticFlow-keywords.html">IsotropicMisesPlasticFlow</a></li>
	        <li><a href="IsotropicPlasticMisesFlow-keywords.html">IsotropicPlasticMisesFlow</a></li>
	        <li><a href="IsotropicStrainHardeningMisesCreep-keywords.html">IsotropicStrainHardeningMisesCreep</a></li>
	        <li><a href="MaterialLaw-keywords.html">MaterialLaw</a></li>
	        <li><a href="MaterialProperty-keywords.html">MaterialProperty</a></li>
	        <li><a href="Model-keywords.html">Model</a></li>
	        <li><a href="MultipleIsotropicMisesFlows-keywords.html">MultipleIsotropicMisesFlows</a></li>
	        <li><a href="RungeKutta-keywords.html">RungeKutta</a></li>
	        <li><a href="RungeKuttaFiniteStrain-keywords.html">RungeKuttaFiniteStrain</a></li>
	        <li><a href="RungeKuttaGenericBehaviour-keywords.html">RungeKuttaGenericBehaviour</a></li>
	        <li><a href="RungeKuttaModel-keywords.html">RungeKuttaModel</a></li>
	      </ul>
	    </li>
	    <li><a href="MTest-keywords.html">MTest keywords</a></li>
	    <li><a href="physical-constants.html">Physical constants</a></li>
	    <li><a href="glossary.html">Glossary</a></li>
	    <li><a href="publications.html">Publications</a></li>
	    <li><a href="faq.html">FAQ</a></li>
	    <li><a href="about.html">About</a></li>
	  </ul>
	</li>
	<li><a>Contributing</a>
	  <ul>
	    <li><a href="https://github.com/thelfer/tfel">Access to sources</a></li>
	    <li><a href="contributing.html">Contributing guidelines</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Report bugs</a></li>
	  </ul>
	</li>
	<li><a>Getting Help</a>
	  <ul>
	    <li><a href="search.html">Search on this site</a></li>
	    <li><a href="https://github.com/thelfer/tfel/discussions">Forum</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Bug report</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Feature request</a></li>
	    <li><a href="mailto:tfel-contact@cea.fr">Contact</a></li>
	  </ul>
	</li>
      </ul>
    </header>
<div id="header">
<h1 class="title">How to implement an isotropic plastic behaviour with
isotropic linear hardening in MFront</h1>
<h2 class="author">Thomas Helfer, Lorenzo Riparbelli, Ioannis
Christovasilis</h2>
<h3 class="date">24/04/2018</h3>
</div>
<div id="TOC">
<ul>
<li><a href="#description-of-the-behaviour"
id="toc-description-of-the-behaviour">Description of the behaviour</a>
<ul>
<li><a href="#elastic-behaviour" id="toc-elastic-behaviour">Elastic
behaviour</a></li>
<li><a href="#plastic-flow" id="toc-plastic-flow">Plastic flow</a></li>
</ul></li>
<li><a href="#integration-algorithm"
id="toc-integration-algorithm">Integration algorithm</a>
<ul>
<li><a href="#expression-of-the-plastic-strain-increment"
id="toc-expression-of-the-plastic-strain-increment">Expression of the
plastic strain increment</a></li>
<li><a href="#expression-of-the-elastic-strain-increment"
id="toc-expression-of-the-elastic-strain-increment">Expression of the
elastic strain increment</a></li>
<li><a href="#expression-of-the-consistent-tangent-operator"
id="toc-expression-of-the-consistent-tangent-operator">Expression of the
consistent tangent operator</a></li>
</ul></li>
<li><a href="#fully-implicit-implementation"
id="toc-fully-implicit-implementation">Fully implicit implementation</a>
<ul>
<li><a href="#choice-of-the-domain-specific-language"
id="toc-choice-of-the-domain-specific-language">Choice of the domain
specific language</a></li>
<li><a href="#name-of-the-behaviour" id="toc-name-of-the-behaviour">Name
of the behaviour</a></li>
<li><a href="#metadata" id="toc-metadata">Metadata</a></li>
<li><a href="#declaration-of-state-parameters"
id="toc-declaration-of-state-parameters">Declaration of state
parameters</a></li>
<li><a href="#declaration-of-parameters"
id="toc-declaration-of-parameters">Declaration of parameters</a></li>
<li><a href="#computation-of-the-prediction-operator"
id="toc-computation-of-the-prediction-operator">Computation of the
prediction operator</a></li>
<li><a href="#behaviour-integration"
id="toc-behaviour-integration">Behaviour integration</a></li>
</ul></li>
</ul>
</div>
<p>This article shows how to implement an isotropic plastic behaviour
with isotropic linear hardening in <code>MFront</code>.</p>
<p>The implementation is available <a
href="gallery/plasticity/IsotropicLinearHardeningPlasticity.mfront">here</a>.</p>
<h1 id="description-of-the-behaviour">Description of the behaviour</h1>
<p>The behaviour is described by a standard decomposition of the strain
<span
class="math inline">\(\underline{\varepsilon}^{\mathrm{to}}\)</span> in
an elastic and a plastic component, respectively denoted <span
class="math inline">\(\underline{\varepsilon}^{\mathrm{el}}\)</span> and
<span
class="math inline">\(\underline{\varepsilon}^{\mathrm{p}}\)</span>:</p>
<p><span id="eq:isotropic_linear_harderning:strain_slip"><span
class="math display">\[
\underline{\varepsilon}^{\mathrm{to}}=\underline{\varepsilon}^{\mathrm{el}}+\underline{\varepsilon}^{\mathrm{p}}
\qquad{(1)}\]</span></span></p>
<h2 id="elastic-behaviour">Elastic behaviour</h2>
<p>The stress <span class="math inline">\(\underline{\sigma}\)</span> is
related to the the elastic strain <span
class="math inline">\(\underline{\varepsilon}^{\mathrm{el}}\)</span> by
a the standard Hooke behaviour:</p>
<p><span id="eq:isotropic_linear_harderning:hooke"><span
class="math display">\[
\underline{\sigma}=
\lambda\,{\mathrm{tr}{\left(\underline{\varepsilon}^{\mathrm{el}}\right)}}\,\underline{I}+2\,\mu\,\underline{\varepsilon}^{\mathrm{el}}
\qquad{(2)}\]</span></span></p>
<h2 id="plastic-flow">Plastic flow</h2>
<p>The plastic part of the behaviour is described by the following yield
surface: <span id="eq:isotropic_linear_harderning:yield_surface"><span
class="math display">\[
f{\left(\sigma_{\mathrm{eq}},p\right)} =
\sigma_{\mathrm{eq}}-\sigma_{0}-R\,p
\qquad{(3)}\]</span></span></p>
<p>where <span class="math inline">\(\sigma_{\mathrm{eq}}\)</span> is
the vonMises stress defined below, <span
class="math inline">\(p\)</span> is the equivalent plastic strain, <span
class="math inline">\(\sigma_{0}\)</span> is the yield stress and <span
class="math inline">\(R\)</span> is the hardening slope.</p>
<p>The von Mises stress is defined by: <span class="math display">\[
\sigma_{\mathrm{eq}}=\sqrt{{{\displaystyle \frac{\displaystyle
3}{\displaystyle
2}}}\,\underline{s}\,\colon\,\underline{s}}=\sqrt{3\,J_{2}}
\]</span> where:</p>
<ul>
<li><span class="math inline">\(\underline{s}\)</span> is the deviatoric
stress defined as follows: <span class="math display">\[
\underline{s}=\underline{\sigma}-{{\displaystyle \frac{\displaystyle
1}{\displaystyle
3}}}\,{\mathrm{tr}{\left(\underline{\sigma}\right)}}\,\underline{I}
\]</span></li>
<li><span class="math inline">\(J_{2}\)</span> is the second invariant
of <span class="math inline">\(\underline{s}\)</span>.</li>
</ul>
<p>The previous expression can be rewritten by introducing a fourth
order tensor called <span
class="math inline">\(\underline{\underline{\mathbf{M}}}\)</span>: <span
class="math display">\[
\sigma_{\mathrm{eq}}=\sqrt{\sigma\,\colon\,\underline{\underline{\mathbf{M}}}\,\colon\,\underline{\sigma}}
\]</span></p>
<p>The tensor <span
class="math inline">\(\underline{\underline{\mathbf{M}}}\)</span> is
given by: <span class="math display">\[
\underline{\underline{\mathbf{M}}}={{\displaystyle \frac{\displaystyle
3}{\displaystyle
2}}}\,{\left(\underline{\underline{\mathbf{I}}}-{{\displaystyle
\frac{\displaystyle 1}{\displaystyle
3}}}\,\underline{I}\,\otimes\,\underline{I}\right)}
\]</span></p>
<p>The plastic flow is assumed to be associated, so the flow direction
<span class="math inline">\(\underline{n}\)</span> is given by <span
class="math inline">\({\displaystyle \frac{\displaystyle \partial
f}{\displaystyle \partial \underline{\sigma}}}\)</span>:</p>
<p><span class="math display">\[
\underline{n} = {\displaystyle \frac{\displaystyle \partial
f}{\displaystyle \partial \underline{\sigma}}} = {{\displaystyle
\frac{\displaystyle 3}{\displaystyle
2\,\sigma_{\mathrm{eq}}}}}\,\underline{s}
\]</span></p>
<p>One may readily check that:</p>
<p><span id="eq:isotropic_linear_harderning:n_norm"><span
class="math display">\[
\underline{n}\,\colon\underline{n}={{\displaystyle \frac{\displaystyle
3}{\displaystyle 2}}}
\qquad{(4)}\]</span></span></p>
<h1 id="integration-algorithm">Integration algorithm</h1>
<p>The previous constitutive equations will be integrated using a
standard implicit scheme which, due to the isotropy of the elastic
behaviour, the quadratic nature of the equivalent stress and the
linearity of the isotropic hardening rule can be solved
analytically.</p>
<h2 id="expression-of-the-plastic-strain-increment">Expression of the
plastic strain increment</h2>
<p>Assuming that a plastic flow occurs, the plastic increment <span
class="math inline">\(\Delta\,\underline{\varepsilon}^{\mathrm{p}}\)</span>
over the time step is approximated by:</p>
<p><span class="math display">\[
\Delta\,\underline{\varepsilon}^{\mathrm{p}}=
\Delta\,p\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}
\]</span></p>
<p>The slip of strain given by Equation (1) may be written
incrementally:</p>
<p><span id="eq:isotropic_linear_harderning:strain_increment_slip"><span
class="math display">\[
\Delta\,\underline{\varepsilon}^{\mathrm{to}}=\Delta\,\underline{\varepsilon}^{\mathrm{el}}+\Delta\,\underline{\varepsilon}^{\mathrm{p}}=\Delta\,\underline{\varepsilon}^{\mathrm{el}}+\Delta\,p\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}
\qquad{(5)}\]</span></span></p>
<p>and projected on the deviatoric space as follows:</p>
<p><span class="math display">\[
\Delta\,\underline{s}^{\mathrm{to}} =
\Delta\,\underline{s}^{\mathrm{el}}+\Delta\,p\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}
\]</span></p>
<p>The isotropy of the elastic behaviour projected on the deviatoric
space leads to:</p>
<p><span class="math display">\[
\begin{aligned}
{\left.\underline{s}\right|_{t+\theta\,\Delta\,t}} &amp;=
{{\displaystyle \frac{\displaystyle 2}{\displaystyle
3}}}\,{\left.\sigma_{\mathrm{eq}}\right|_{t+\theta\,\Delta\,t}}\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\\
                  &amp;=
2\,{\left.\mu\right|_{t+\theta\,\Delta\,t}}\,{\left({\left.\underline{s}^{\mathrm{el}}\right|_{t}}+\theta\,\Delta\,\underline{s}^{\mathrm{el}}\right)}
\\
                  &amp;=
2\,{\left.\mu\right|_{t+\theta\,\Delta\,t}}\,{\left({\left.\underline{s}^{\mathrm{el}}\right|_{t}}
                                   +\theta\,\Delta\,\underline{s}^{\mathrm{to}}
                                   -\theta\,\Delta\,p\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\right)}
\end{aligned}
\]</span></p>
<p>The previous equations leads to:</p>
<p><span id="eq:isotropic_linear_harderning:trial_stress"><span
class="math display">\[
{\left({{\displaystyle \frac{\displaystyle 2}{\displaystyle
3}}}\,{\left.\sigma_{\mathrm{eq}}\right|_{t+\theta\,\Delta\,t}}+\theta\,\Delta\,p\right)}\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}
=
2\,{\left.\mu\right|_{t+\theta\,\Delta\,t}}\,{\left({\left.\underline{s}^{\mathrm{el}}\right|_{t}}+\theta\,\Delta\,\underline{s}^{\mathrm{to}}\right)}
\qquad{(6)}\]</span></span></p>
<p>The right hand side is the value of the deviatoric part of the stress
tensor that would be obtained in a pure elastic loading. The latter is
commonly called the trial stress <span
class="math inline">\(\underline{\sigma}^{\mathrm{tr}}\)</span>:</p>
<p><span class="math display">\[
\underline{\sigma}^{\mathrm{tr}}=
{\left.\lambda\right|_{t+\theta\,\Delta\,t}}\,{\mathrm{tr}{\left({\left.\underline{\varepsilon}^{\mathrm{el}}\right|_{t}}+\theta\,\Delta\,\underline{\varepsilon}^{\mathrm{to}}\right)}}\,\underline{I}+
2\,{\left.\mu\right|_{t+\theta\,\Delta\,t}}\,{\left({\left.\underline{\varepsilon}^{\mathrm{el}}\right|_{t}}+\theta\,\Delta\,\underline{\varepsilon}^{\mathrm{to}}\right)}
\]</span></p>
<p>Its deviatoric part is denoted <span
class="math inline">\({\left.\underline{s}^{\mathrm{tr}}\right|_{t+\theta\,\Delta\,t}}\)</span>:</p>
<p><span class="math display">\[
{\left.\underline{s}^{\mathrm{tr}}\right|_{t+\theta\,\Delta\,t}}=2\,{\left.\mu\right|_{t+\theta\,\Delta\,t}}\,{\left({\left.\underline{s}^{\mathrm{el}}\right|_{t}}+\theta\,\Delta\,\underline{s}^{\mathrm{to}}\right)}
\]</span></p>
<p>Taking the von Mises norm of both side of Equation (6) yields:</p>
<p><span class="math display">\[
{\left({{\displaystyle \frac{\displaystyle 2}{\displaystyle
3}}}\,{\left.\sigma_{\mathrm{eq}}\right|_{t+\theta\,\Delta\,t}}+2\,{\left.\mu\right|_{t+\theta\,\Delta\,t}}\,\theta\,\Delta\,p\right)}\,\sqrt{{{\displaystyle
\frac{\displaystyle 3}{\displaystyle
2}}}\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\,\colon{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}}
=
{\left.\sigma_{\mathrm{eq}}^{\mathrm{tr}}\right|_{t+\theta\,\Delta\,t}}
\]</span></p>
<p>where <span
class="math inline">\({\left.\sigma_{\mathrm{eq}}^{\mathrm{tr}}\right|_{t+\theta\,\Delta\,t}}\)</span>
is the so-called trial equivalent stress.</p>
<p>It is important to note that <span
class="math inline">\(\underline{s}^{\mathrm{tr}}\)</span> and <span
class="math inline">\({\left.\sigma_{\mathrm{eq}}^{\mathrm{tr}}\right|_{t+\theta\,\Delta\,t}}\)</span>
can be computed <em>a priori</em>, only with the known values of the
elastic strain at the beginning of the time step and the total strain
increment.</p>
<p>The previous expressions leads to a closed form expression of the
normal:</p>
<p><span id="eq:isotropic_linear_harderning:normal_value"><span
class="math display">\[
{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}} = {{\displaystyle
\frac{\displaystyle 3}{\displaystyle
2\,{\left.\sigma_{\mathrm{eq}}^{\mathrm{tr}}\right|_{t+\theta\,\Delta\,t}}}}}\underline{s}^{\mathrm{tr}}
\qquad{(7)}\]</span></span></p>
<blockquote>
<p><strong>Derivatives of the equivalent trial stress <span
class="math inline">\({\left.\sigma_{\mathrm{eq}}^{\mathrm{tr}}\right|_{t+\theta\,\Delta\,t}}\)</span>
and normal <span
class="math inline">\({\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\)</span></strong></p>
<p>The following classical relationships will be useful in the
following:</p>
<p><span id="eq:isotropic_linear_harderning:useful_derivatives"><span
class="math display">\[
\left\{
\begin{aligned}
{\displaystyle \frac{\displaystyle \partial
{\left.\sigma_{\mathrm{eq}}^{\mathrm{tr}}\right|_{t+\theta\,\Delta\,t}}}{\displaystyle
\partial
{\left.\underline{\sigma}^{\mathrm{tr}}\right|_{t+\theta\,\Delta\,t}}}}&amp;={\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\\
{\displaystyle \frac{\displaystyle \partial
{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}}{\displaystyle
\partial
{\left.\underline{\sigma}^{\mathrm{tr}}\right|_{t+\theta\,\Delta\,t}}}}&amp;=
{{\displaystyle \frac{\displaystyle 1}{\displaystyle
{\left.\sigma_{\mathrm{eq}}^{\mathrm{tr}}\right|_{t+\theta\,\Delta\,t}}}}}
{\left(\underline{\underline{\mathbf{M}}}-{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\,\otimes\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\right)}\\
\end{aligned}
\right.
\qquad{(8)}\]</span></span></p>
</blockquote>
<p>Finally, taking into account Equation (4), the von Mises stress
satisfies:</p>
<p><span class="math display">\[
{\left.\sigma_{\mathrm{eq}}\right|_{t+\theta\,\Delta\,t}} =
{\left.\sigma_{\mathrm{eq}}^{\mathrm{tr}}\right|_{t+\theta\,\Delta\,t}}
- 3\,{\left.\mu\right|_{t+\theta\,\Delta\,t}}\,\theta\,\Delta\,p
\]</span></p>
<p>Using the fact that, during plastic loading, the stress state must be
on the Yield Surface (3), the von Mises stress also satisfies:</p>
<p><span class="math display">\[
{\left.\sigma_{\mathrm{eq}}\right|_{t+\theta\,\Delta\,t}}=\sigma_{0}+R\,{\left.p\right|_{t+\theta\,\Delta\,t}}=\sigma_{0}+R\,{\left({\left.p\right|_{t}}+\theta\,\Delta\,p\right)}
\]</span></p>
<p>Combining those equations yields this closed-form expression of the
plastic strain increment:</p>
<p><span id="eq:isotropic_linear_harderning:dp"><span
class="math display">\[
\Delta\,p = {{\displaystyle \frac{\displaystyle
{\left.\sigma_{\mathrm{eq}}^{\mathrm{tr}}\right|_{t+\theta\,\Delta\,t}}
- \sigma_{0} - R\,{\left.p\right|_{t}}}{\displaystyle
{\left(3\,{\left.\mu\right|_{t+\theta\,\Delta\,t}}\, +
R\right)}\,\theta}}}
\qquad{(9)}\]</span></span></p>
<h2 id="expression-of-the-elastic-strain-increment">Expression of the
elastic strain increment</h2>
<p>The elastic strain increment is given in closed form by Equations
(5), (7) and (9):</p>
<p><span id="eq:isotropic_linear_harderning:deel"><span
class="math display">\[
\Delta\underline{\varepsilon}^{\mathrm{el}}=
\Delta\,\underline{\varepsilon}^{\mathrm{to}}-\Delta\,p\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}
\qquad{(10)}\]</span></span></p>
<h2 id="expression-of-the-consistent-tangent-operator">Expression of the
consistent tangent operator</h2>
<p>The consistent tangent operator is the derivative <span
class="math inline">\({\displaystyle \frac{\displaystyle \partial
{\left.\underline{\sigma}\right|_{t+\Delta\,t}}}{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{to}}}}\)</span> of the stress
at the end of the time step with respect the increment of the
strain.</p>
<p>Using Equation (2), this derivative can be expressed as:</p>
<p><span class="math display">\[
{\displaystyle \frac{\displaystyle \partial
{\left.\underline{\sigma}\right|_{t+\Delta\,t}}}{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{to}}}}=
{\left.\underline{\underline{\mathbf{D}}}\right|_{t+\Delta\,t}}\,\colon\,{\displaystyle
\frac{\displaystyle \partial
{\left.\underline{\varepsilon}^{\mathrm{el}}\right|_{t+\Delta\,t}}}{\displaystyle
\partial \Delta\,\underline{\varepsilon}^{\mathrm{to}}}}=
{\left.\underline{\underline{\mathbf{D}}}\right|_{t+\Delta\,t}}\,\colon\,{\displaystyle
\frac{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{el}}}{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{to}}}}
\]</span></p>
<p>where <span
class="math inline">\({\left.\underline{\underline{\mathbf{D}}}\right|_{t+\Delta\,t}}={\left.\lambda\right|_{t+\Delta\,t}}\,\,\underline{\underline{\mathbf{I}}}+2\,{\left.\mu\right|_{t+\Delta\,t}}\,\underline{I}\,\otimes\,\underline{I}\)</span>
denotes the stiffness matrix.</p>
<p>The derivative <span class="math inline">\({\displaystyle
\frac{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{el}}}{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{to}}}}\)</span> can be deduced
from Equation (10):</p>
<p><span class="math display">\[
{\displaystyle \frac{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{el}}}{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{to}}}}=
\underline{\underline{\mathbf{I}}}
-{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\,\otimes\,{\displaystyle
\frac{\displaystyle \partial \Delta\,p}{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{to}}}}
-\Delta\,p\,{\displaystyle \frac{\displaystyle \partial
{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}}{\displaystyle
\partial \Delta\,\underline{\varepsilon}^{\mathrm{to}}}}
\]</span></p>
<p>Using Equation (8), the derivative <span
class="math inline">\({\displaystyle \frac{\displaystyle \partial
\Delta\,p}{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{to}}}}\)</span> can be deduced
from Equation (9) as follows:</p>
<p><span id="eq:isotropic_linear_harderning:ddp_ddeto"><span
class="math display">\[
{\displaystyle \frac{\displaystyle \partial \Delta\,p}{\displaystyle
\partial \Delta\,\underline{\varepsilon}^{\mathrm{to}}}}=
{{\displaystyle \frac{\displaystyle 1}{\displaystyle
{\left(3\,{\left.\mu\right|_{t+\theta\,\Delta\,t}}\, +
R\right)}\,\theta}}}\,
{\displaystyle \frac{\displaystyle \partial
{\left.\sigma_{\mathrm{eq}}^{\mathrm{tr}}\right|_{t+\theta\,\Delta\,t}}
}{\displaystyle \partial \Delta\,\underline{\varepsilon}^{\mathrm{to}}}}
=
{{\displaystyle \frac{\displaystyle
2\,{\left.\mu\right|_{t+\theta\,\Delta\,t}}}{\displaystyle
3\,{\left.\mu\right|_{t+\theta\,\Delta\,t}}\, +
R}}}\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}
\qquad{(11)}\]</span></span></p>
<p>Using Equations (8) and (7), the derivative <span
class="math inline">\({\displaystyle \frac{\displaystyle \partial
{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}}{\displaystyle
\partial \Delta\,\underline{\varepsilon}^{\mathrm{to}}}}\)</span> is
also given by:</p>
<p><span id="eq:isotropic_linear_harderning:dn_ddeto"><span
class="math display">\[
{\displaystyle \frac{\displaystyle \partial
{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}}{\displaystyle
\partial \Delta\,\underline{\varepsilon}^{\mathrm{to}}}}=
{{\displaystyle \frac{\displaystyle
2\,{\left.\mu\right|_{t+\theta\,\Delta\,t}}\,\theta}{\displaystyle
{\left.\sigma_{\mathrm{eq}}^{\mathrm{tr}}\right|_{t+\theta\,\Delta\,t}}}}}
{\left(\underline{\underline{\mathbf{M}}}-{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\,\otimes\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\right)}
\qquad{(12)}\]</span></span></p>
<p>Equations (11) and (12), shows that the derivatives <span
class="math inline">\({\displaystyle \frac{\displaystyle \partial
\Delta\,p}{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{to}}}}\)</span> and <span
class="math inline">\({\displaystyle \frac{\displaystyle \partial
{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}}{\displaystyle
\partial \Delta\,\underline{\varepsilon}^{\mathrm{to}}}}\)</span> are
linear combinations of the two fourth order tensors <span
class="math inline">\(\underline{M}\)</span> and <span
class="math inline">\({\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\,\otimes\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\)</span>
which only acts on the deviatoric parts of the symmetric tensors. The
following properites then holds:</p>
<p><span class="math display">\[
\left\{
\begin{aligned}
{\left.\underline{\underline{\mathbf{D}}}\right|_{t+\Delta\,t}}\,\colon\,\underline{\underline{\mathbf{M}}}
&amp;=
2\,{\left.\mu\right|_{t+\Delta\,t}}\,\underline{\underline{\mathbf{M}}}\\
{\left.\underline{\underline{\mathbf{D}}}\right|_{t+\Delta\,t}}\,\colon\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\,\otimes\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}
&amp;=
2\,{\left.\mu\right|_{t+\Delta\,t}}\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\,\otimes\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\\
\end{aligned}
\right.
\]</span></p>
<p>The consistent tangent operator is then:</p>
<p><span class="math display">\[
\begin{aligned}
{\displaystyle \frac{\displaystyle \partial
{\left.\underline{\sigma}\right|_{t+\Delta\,t}}}{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{to}}}}
&amp;=
{\left.\underline{\underline{\mathbf{D}}}\right|_{t+\Delta\,t}}
-{\left.\underline{\underline{\mathbf{D}}}\right|_{t+\Delta\,t}}\,\colon\,{\left(
{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\,\otimes\,{\displaystyle
\frac{\displaystyle \partial \Delta\,p}{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{to}}}}
+\Delta\,p\,{\displaystyle \frac{\displaystyle \partial
{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}}{\displaystyle
\partial \Delta\,\underline{\varepsilon}^{\mathrm{to}}}}
\right)}\\
&amp;={\left.\underline{\underline{\mathbf{D}}}\right|_{t+\Delta\,t}}
-2\,{\left.\mu\right|_{t+\theta\,\Delta\,t}}\,{\left(
{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\,\otimes\,{\displaystyle
\frac{\displaystyle \partial \Delta\,p}{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{to}}}}
+\Delta\,p\,{\displaystyle \frac{\displaystyle \partial
{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}}{\displaystyle
\partial \Delta\,\underline{\varepsilon}^{\mathrm{to}}}}
\right)}
\end{aligned}
\]</span></p>
<p>and finaly,</p>
<p><span
id="eq:isotropic_linear_harderning:consistent_tangent_operator"><span
class="math display">\[
\begin{aligned}
{\displaystyle \frac{\displaystyle \partial
{\left.\underline{\sigma}\right|_{t+\Delta\,t}}}{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{to}}}}
={\left.\underline{\underline{\mathbf{D}}}\right|_{t+\Delta\,t}}
-4\,{\left({\left.\mu\right|_{t+\theta\,\Delta\,t}}\right)}^{2}\,
&amp;\left(
{{\displaystyle \frac{\displaystyle 1}{\displaystyle
3\,{\left.\mu\right|_{t+\theta\,\Delta\,t}}\, +
R}}}\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}
\otimes\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}+\right.\\
&amp;\left.{{\displaystyle \frac{\displaystyle
\theta\Delta\,p}{\displaystyle
{\left.\sigma_{\mathrm{eq}}^{\mathrm{tr}}\right|_{t+\theta\,\Delta\,t}}}}}\,{\left(\underline{\underline{\mathbf{M}}}-{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\,\otimes\,{\left.\underline{n}\right|_{t+\theta\,\Delta\,t}}\right)}\right)\\
\end{aligned}
\qquad{(13)}\]</span></span></p>
<h1 id="fully-implicit-implementation">Fully implicit
implementation</h1>
<p>We now describe how to make a fully implicit implementation, i.e. we
fix the <span class="math inline">\(\theta\)</span> parameter to <span
class="math inline">\(1\)</span>.</p>
<p>This choice is consistent with the description of a plastic flow as
it imposes that the material lies on the yield surface at the end of the
time step if a plastic loading occurs.</p>
<p>With other choices, the material may be outside the yield surface at
the end of the time step and spurious oscillations in the stress in time
can be observed, for example during a simple uniaxial tensile test
test.</p>
<h2 id="choice-of-the-domain-specific-language">Choice of the domain
specific language</h2>
<p>The behaviour integration is trivial as all the computated quantities
can be obtained thanks in closed form:</p>
<ul>
<li>The values of the state variables <span
class="math inline">\(\underline{\varepsilon}^{\mathrm{el}}\)</span>,
<span class="math inline">\(p\)</span> and the value of the stress <span
class="math inline">\(\underline{\sigma}\)</span> at the end of the time
step.</li>
<li>The consistent tangent operator <span
class="math inline">\({\displaystyle \frac{\displaystyle \partial
\underline{\sigma}}{\displaystyle \partial
\Delta\,\underline{\varepsilon}^{\mathrm{to}}}}\)</span>.</li>
</ul>
<p>In this case, an appropriate domain specific language is the
<code>Default</code>:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>DSL Default<span class="op">;</span></span></code></pre></div>
<p>Contrary to other DSLs, the <code>Default</code> does not provide a
built-in support for a given integration scheme.</p>
<h2 id="name-of-the-behaviour">Name of the behaviour</h2>
<p>The name of the behaviour is introduced by the
<code>@Behaviour</code> keyword:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Behaviour IsotropicLinearHardeningPlasticity<span class="op">;</span></span></code></pre></div>
<h2 id="metadata">Metadata</h2>
<p>The following lines defines the author of the implementation, the
date and provides a small description:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Author Thomas Helfer<span class="op">;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Date   <span class="dv">14</span><span class="op">/</span><span class="dv">10</span><span class="op">/</span><span class="dv">2016</span><span class="op">;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Description<span class="op">{</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  An implicit implementation of a simple</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  isotropic plasticity behaviour with</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  isotropic linear hardening<span class="op">.</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  The yield surface is defined by<span class="op">:</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;</span><span class="er">\[</span><span class="st">&quot;</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;  f(</span><span class="er">\s</span><span class="st">igmaeq,p) = </span><span class="er">\s</span><span class="st">igmaeq-s_</span><span class="sc">{0}</span><span class="st">-H</span><span class="er">\,</span><span class="st">p&quot;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;</span><span class="er">\]</span><span class="st">&quot;</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h2 id="declaration-of-state-parameters">Declaration of state
parameters</h2>
<p>The behaviour used two state variables, the elastic strain <span
class="math inline">\(\underline{\varepsilon}^{\mathrm{el}}\)</span> and
the equivalent plastic strain <span
class="math inline">\(p\)</span>.</p>
<p>Those state variables are declared as follows:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>StateVariable StrainStensor eel<span class="op">;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>eel<span class="op">.</span>setGlossaryName<span class="op">(</span><span class="st">&quot;ElasticStrain&quot;</span><span class="op">);</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>StateVariable strain p<span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>p<span class="op">.</span>setGlossaryName<span class="op">(</span><span class="st">&quot;EquivalentPlasticStrain&quot;</span><span class="op">);</span></span></code></pre></div>
<p>The state variables have been associated to <a
href="glossary.html">glossary names</a> which are meant to:</p>
<ul>
<li>automatically declare the external name of the variable (i.e. the
name as seen from the calling solver if this solver uses the metadata
exported by <code>MFront</code>).</li>
<li>automatically document the variable.</li>
</ul>
<blockquote>
<p><strong>Increments of the state variables</strong></p>
<p>The <code>Default</code> automatically declares the increments of
those variables, called respectively <code>deel</code> and
<code>dp</code>. The user is free to use those increments or to directly
update the values of the state variables.</p>
<p>If the increment of a state variable is defined, it is added to the
state variable <strong>after</strong> the <code>@Integrator</code> code
block.</p>
<p>In our implementation, we will directly update the elastic strain and
use the plastic strain increment.</p>
</blockquote>
<h2 id="declaration-of-parameters">Declaration of parameters</h2>
<p>In this implementation, we choose to use parameters associated
respectively with the Young’ modulus, Poisson’ ratio, hardening slope
and yield stress, as follows:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Parameter stress young <span class="op">=</span>  <span class="fl">70.e9</span><span class="op">;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>young<span class="op">.</span>setGlossaryName<span class="op">(</span><span class="st">&quot;YoungModulus&quot;</span><span class="op">);</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Parameter real nu <span class="op">=</span>   <span class="fl">0.34</span><span class="op">;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>nu<span class="op">.</span>setGlossaryName<span class="op">(</span><span class="st">&quot;PoissonRatio&quot;</span><span class="op">);</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Parameter stress H <span class="op">=</span>  <span class="fl">10.e9</span><span class="op">;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>H<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;HardeningSlope&quot;</span><span class="op">);</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Parameter stress s0 <span class="op">=</span>  <span class="fl">300.e6</span><span class="op">;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>s0<span class="op">.</span>setGlossaryName<span class="op">(</span><span class="st">&quot;YieldStress&quot;</span><span class="op">);</span></span></code></pre></div>
<blockquote>
<p><strong>Using material properties</strong></p>
<p>The use of parameters could be replaced by the use of material
properties as follows:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>MaterialProperty stress young<span class="op">;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>young<span class="op">.</span>setGlossaryName<span class="op">(</span><span class="st">&quot;YoungModulus&quot;</span><span class="op">);</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>MaterialProperty real nu<span class="op">;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>nu<span class="op">.</span>setGlossaryName<span class="op">(</span><span class="st">&quot;PoissonRatio&quot;</span><span class="op">);</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>MaterialProperty stress H<span class="op">;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>H<span class="op">.</span>setEntryName<span class="op">(</span><span class="st">&quot;HardeningSlope&quot;</span><span class="op">);</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>MaterialProperty stress s0<span class="op">;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>s0<span class="op">.</span>setGlossaryName<span class="op">(</span><span class="st">&quot;YieldStress&quot;</span><span class="op">);</span></span></code></pre></div>
<p>Contrary to parameters, material properties does not have default
values and must be provided by the calling solvers, which generally uses
values provided by the user in its input file.</p>
</blockquote>
<h2 id="computation-of-the-prediction-operator">Computation of the
prediction operator</h2>
<p>The current implementation only provides the elastic operator:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>PredictionOperator<span class="op">{</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> lambda <span class="op">=</span> computeLambda<span class="op">(</span>young<span class="op">,</span> nu<span class="op">);</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> mu     <span class="op">=</span> computeMu<span class="op">(</span>young<span class="op">,</span> nu<span class="op">);</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  Dt <span class="op">=</span> lambda <span class="op">*</span> Stensor4<span class="op">::</span>IxI<span class="op">()</span> <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> mu <span class="op">*</span> Stensor4<span class="op">::</span>Id<span class="op">();</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>We could also provide a tangent operator, but this would mean saving
an auxiliary state variable stating if a plastic loading occured at the
previous time step.</p>
<h2 id="behaviour-integration">Behaviour integration</h2>
<p>The behaviour integration is implemented in the
<code>@Integrator</code> code block.</p>
<h3 id="computation-of-the-consistent-tangent-operator">Computation of
the consistent tangent operator</h3>
<p>The <code>Default</code> DSL allows to compute the consistent tangent
operator either inside the <code>@Integrator</code> code block or in a
dedicated code block name <code>@TangentOperator</code>.</p>
<p>The first choice is simplier and more efficient for the considered
implementation, but this requires to explicitely state that the
consistent tangent operator is defined in the <code>@Integrator</code>
code block using the <code>@ProvidesSymmetricTangentOperator</code>
keyword, as follows:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>ProvidesSymmetricTangentOperator<span class="op">;</span></span></code></pre></div>
<p>The consistent tangent operator may or may not be requested by the
calling solver at runtime.</p>
<h3 id="computation-of-the-lamé-coefficients">Computation of the Lamé’
coefficients</h3>
<p>The <code>@Integrator</code> code blocks begins by computing the
Lamé’ coefficients as follows:</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="er">@</span>Integrator<span class="op">{</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> lambda <span class="op">=</span> computeLambda<span class="op">(</span>young<span class="op">,</span> nu<span class="op">);</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> mu     <span class="op">=</span> computeMu<span class="op">(</span>young<span class="op">,</span> nu<span class="op">);</span></span></code></pre></div>
<h3 id="elastic-loading">Elastic loading</h3>
<p>The next lines assume a purely elastic loading and:</p>
<ul>
<li>Updates the value of the elastic strain with the increment of the
total strain.</li>
<li>Initializes the value of the consistent tangent operator to the
elastic stiffness matrix.</li>
</ul>
<div class="sourceCode" id="cb10"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>  eel <span class="op">+=</span> deto<span class="op">;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span><span class="op">(</span><span class="va">computeTangentOperator_</span><span class="op">){</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    Dt <span class="op">=</span> lambda <span class="op">*</span> Stensor4<span class="op">::</span>IxI<span class="op">()</span> <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> mu <span class="op">*</span> Stensor4<span class="op">::</span>Id<span class="op">();</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span></code></pre></div>
<p>If required, a plastic correction will be applied to the elastic
strain and the consistent tangent operator in the next part of the
code.</p>
<h3 id="computation-of-the-trial-stress">Computation of the trial
stress</h3>
<p>To check of if a plastic correction must be applied, we first compute
the deviator of the trial stress, the equivalent trial stress and checks
if its value is outside the elastic domain at the beginning of the time
step.</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> se     <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> mu <span class="op">*</span> deviator<span class="op">(</span>eel<span class="op">);</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> seq_e  <span class="op">=</span> sigmaeq<span class="op">(</span>se<span class="op">);</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">const</span> <span class="kw">auto</span> plastic_loading <span class="op">=</span> seq_e <span class="op">&gt;</span> s0 <span class="op">+</span> H <span class="op">*</span> p<span class="op">;</span></span></code></pre></div>
<p>The <code>plastic_loading</code> boolean value is thus
<code>true</code> if a plastic correction must be applied,
<code>false</code> otherwise.</p>
<h3 id="plastic-loading">Plastic loading</h3>
<h4 id="computation-of-the-normal">Computation of the normal</h4>
<p>If a plastic correction must be applied, we first compute the normal
using Equation (7):</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span><span class="op">(</span>plastic_loading<span class="op">){</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="kw">auto</span> iseq_e <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> seq_e<span class="op">;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="kw">auto</span> n      <span class="op">=</span> eval<span class="op">(</span><span class="dv">3</span> <span class="op">*</span> se <span class="op">/</span> <span class="op">(</span><span class="dv">2</span> <span class="op">*</span> seq_e<span class="op">));</span></span></code></pre></div>
<blockquote>
<p><strong>The <code>eval</code> function</strong></p>
<p><code>TFEL/Math</code> uses expression templates to perform lazy
evaluations of most tensorial operations. See <a
href="tfel-math.html">its documentation</a> for details.</p>
<p>The eval function evaluates an expression to get its results. We
could have removed it here, but the normal is used multiple times, so we
choose to evaluate it once.</p>
</blockquote>
<h4 id="update-of-the-state-variables">Update of the state
variables</h4>
<p>The increment of the equivalent plastic strain is computed using
Equation (9):</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>    <span class="at">const</span> <span class="kw">auto</span> cste   <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> <span class="op">(</span>H <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> mu<span class="op">);</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    dp   <span class="op">=</span> <span class="op">(</span>seq_e <span class="op">-</span> s0 <span class="op">-</span> H <span class="op">*</span> p<span class="op">)</span> <span class="op">*</span> cste<span class="op">;</span></span></code></pre></div>
<p>The value of the equivalent plastic strain will be updated
automatically after the <code>@Integrator</code> code block.</p>
<p>Once the equivalent plastic strain is known, the elastic strain can
be corrected using the split of the strain (Equation (1)):</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>    eel <span class="op">-=</span> dp <span class="op">*</span> n<span class="op">;</span></span></code></pre></div>
<h4 id="update-of-the-consistent-tangent-operator">Update of the
consistent tangent operator</h4>
<p>The consistent tangent operator can be corrected using Equation
(13):</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">((</span><span class="va">computeTangentOperator_</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="op">(</span>smt<span class="op">==</span>CONSISTENTTANGENTOPERATOR<span class="op">)){</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>      Dt <span class="op">-=</span> <span class="op">-</span><span class="dv">4</span> <span class="op">*</span> mu <span class="op">*</span> mu <span class="op">*</span> <span class="op">(</span>dp <span class="op">*</span> iseq_e <span class="op">*</span> <span class="op">(</span>Stensor4<span class="op">::</span>M<span class="op">()-(</span>n <span class="op">^</span> n<span class="op">))</span> <span class="op">+</span> cste <span class="op">*</span> <span class="op">(</span>n <span class="op">^</span> n<span class="op">));</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span> <span class="co">// end of if(plastic_loading)</span></span></code></pre></div>
<h4
id="computation-of-the-stress-at-the-end-of-the-time-step">Computation
of the stress at the end of the time step</h4>
<p>At this stage, the elastic strain have been updated and hols its
value at the end of the time step. The last step of the implementation
is to use it to compute the stress at the end of the time step:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode cxx"><code class="sourceCode cpp"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>  sig <span class="op">=</span> lambda<span class="op">*</span>trace<span class="op">(</span>eel<span class="op">)*</span>Stensor<span class="op">::</span>Id<span class="op">()+</span><span class="dv">2</span><span class="op">*</span>mu<span class="op">*</span>eel<span class="op">;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="co">// end of @Integrator</span></span></code></pre></div>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-62273823-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
