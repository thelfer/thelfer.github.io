<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="generator" content="pandoc" />
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>How to implement an hyperelastic behaviour in MFront</title>
        <meta name="author" content="Thomas Helfer" />
            <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    <style type="text/css">code{white-space: pre;}</style>
                <link rel="stylesheet" href="css/normalize.css"/>
    <link rel="stylesheet" href="css/main.css"/>
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
          </head>
  <body>
    <!--[if lt IE 7]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
        <header>
      <ul id="nav">
	<li><a href="news.html">News</a></li>
	<li><a href="index.html">Overview</a>
	  <ul>
	    <li><a>Domain specific languages</a>
	      <ul>
		<li><a href="material-properties.html">Material properties</a></li>
		<li><a href="behaviours.html">Mechanical behaviours</a></li>
		<li><a href="models.html">Models</a></li>
	      </ul>
            </li>
	    <li><a href="interfaces.html">Available interfaces</a></li>
	    <li><a href="associated-projects.html">Associated projects</a></li>
     	    <li><a>Tools</a>
	      <ul>
	        <li><a href="mfront-doc.html">mfront-doc</a></li>
	        <li><a href="mtest.html">mtest</a></li>
	        <li><a href="mfm.html">mfm</a></li>
	        <li><a href="mfm-test-generator.html">mfm-test-generator</a></li>
	        <li><a href="tfel-check.html">tfel-check</a></li>
	      </ul>
	    </li>
	  </ul>
	</li>
	<li><a>Getting started</a>
	  <ul>
	    <li><a href="https://github.com/thelfer/tfel/">Github repository</a></li>
	    <li><a href="https://github.com/thelfer/tfel/releases">Download</a></li>
	    <li><a href="release-notes.html">Release notes</a>
	      <ul>
		<li><a>Versions 2.0.x</a>
                  <ul>
                    <li><a href="release-notes.html">Versions prior to 2.0.5</a></li>
	 	    <li><a href="release-notes-2.0.5.html">Version 2.0.5</a></li>
                  </ul>
		</li>
		<li><a>Versions 3.0.x</a>
                  <ul>
		    <li><a href="release-notes-3.0.html">Version 3.0.0</a></li>
		    <li><a href="release-notes-3.0.1.html">Version 3.0.1</a></li>
		    <li><a href="release-notes-3.0.2.html">Version 3.0.2</a></li>
		    <li><a href="release-notes-3.0.3.html">Version 3.0.3</a></li>
		    <li><a href="release-notes-3.0.4.html">Version 3.0.4</a></li>
		    <li><a href="release-notes-3.0.5.html">Version 3.0.5</a></li>
		    <li><a href="release-notes-3.0.6.html">Version 3.0.6</a></li>
		    <li><a href="release-notes-3.0.7.html">Version 3.0.7</a></li>
		    <li><a href="release-notes-3.0.8.html">Version 3.0.8</a></li>
		    <li><a href="release-notes-3.0.9.html">Version 3.0.9</a></li>
		    <li><a href="release-notes-3.0.10.html">Version 3.0.10</a></li>
		    <li><a href="release-notes-3.0.11.html">Version 3.0.11</a></li>
		    <li><a href="release-notes-3.0.12.html">Version 3.0.12</a></li>
		    <li><a href="release-notes-3.0.13.html">Version 3.0.13</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.1.x</a>
		  <ul>
		    <li><a href="release-notes-3.1.html">Version 3.1.0</a></li>
		    <li><a href="release-notes-3.1.1.html">Version 3.1.1</a></li>
		    <li><a href="release-notes-3.1.2.html">Version 3.1.2</a></li>
		    <li><a href="release-notes-3.1.3.html">Version 3.1.3</a></li>
		    <li><a href="release-notes-3.1.4.html">Version 3.1.4</a></li>
		    <li><a href="release-notes-3.1.5.html">Version 3.1.5</a></li>
		    <li><a href="release-notes-3.1.6.html">Version 3.1.6</a></li>
		    <li><a href="release-notes-3.1.7.html">Version 3.1.7</a></li>
		    <li><a href="release-notes-3.1.8.html">Version 3.1.8</a></li>
		    <li><a href="release-notes-3.1.9.html">Version 3.1.9</a></li>
		    <li><a href="release-notes-3.1.10.html">Version 3.1.10</a></li>
		    <li><a href="release-notes-3.1.11.html">Version 3.1.11</a></li>
		    <li><a href="release-notes-3.1.12.html">Version 3.1.12</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.2.x</a>
		  <ul>
		    <li><a href="release-notes-3.2.html">Version 3.2.0</a></li>
		    <li><a href="release-notes-3.2.1.html">Version 3.2.1</a></li>
		    <li><a href="release-notes-3.2.2.html">Version 3.2.2</a></li>
		    <li><a href="release-notes-3.2.3.html">Version 3.2.3</a></li>
		    <li><a href="release-notes-3.2.4.html">Version 3.2.4</a></li>
		    <li><a href="release-notes-3.2.5.html">Version 3.2.5</a></li>
		    <li><a href="release-notes-3.2.6.html">Version 3.2.6</a></li>
		    <li><a href="release-notes-3.2.7.html">Version 3.2.7</a></li>
		    <li><a href="release-notes-3.2.8.html">Version 3.2.8</a></li>
		    <li><a href="release-notes-3.2.9.html">Version 3.2.9</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.3.x</a>
		  <ul>
		    <li><a href="release-notes-3.3.html">Version 3.3.0</a></li>
		    <li><a href="release-notes-3.3.1.html">Version 3.3.1</a></li>
		    <li><a href="release-notes-3.3.1.html">Version 3.3.2</a></li>
		    <li><a href="release-notes-3.3.2.html">Version 3.3.2</a></li>
		    <li><a href="release-notes-3.3.3.html">Version 3.3.3</a></li>
		    <li><a href="release-notes-3.3.4.html">Version 3.3.4</a></li>
		  </ul>
		</li>
		<li><a>Versions 3.4.x</a>
		  <ul>
		    <li><a href="release-notes-3.4.html">Version 3.4.0</a></li>
		    <li><a href="release-notes-3.4.1.html">Version 3.4.1</a></li>
		    <li><a href="release-notes-3.4.2.html">Version 3.4.2</a></li>
		    <li><a href="release-notes-3.4.3.html">Version 3.4.3</a></li>
		    <li><a href="release-notes-3.4.4.html">Version 3.4.4</a></li>
		    <li><a href="release-notes-3.4.5.html">Version 3.4.5</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.0.x</a>
		  <ul>
		    <li><a href="release-notes-4.0.html">Version 4.0.0</a></li>
		    <li><a href="release-notes-4.0.1.html">Version 4.0.1</a></li>
		    <li><a href="release-notes-4.0.2.html">Version 4.0.2</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.1.x</a>
		  <ul>
		    <li><a href="release-notes-4.1.html">Version 4.1.0</a></li>
		    <li><a href="release-notes-4.1.1.html">Version 4.1.1</a></li>
		    <li><a href="release-notes-4.1.2.html">Version 4.1.2</a></li>
		  </ul>
		</li>
		<li><a>Versions 4.2.x</a>
		  <ul>
		    <li><a href="release-notes-4.2.html">Version 4.2.0</a></li>
		    <li><a href="release-notes-4.2.1.html">Version 4.2.1</a></li>
		  </ul>
		</li>
		<li><a>Versions 5.0.x</a>
		  <ul>
		    <li><a href="release-notes-5.0.html">Version 5.0.0</a></li>
		  </ul>
		</li>
	      </ul>
	    </li>
	    <li><a href="coverity-scan.html">Coverity scan</a></li>
	    <li><a href="install.html">Installation</a></li>
	  </ul>
	</li>
	<li><a>Documentation</a>
	  <ul>
	    <li><a href="documentations.html">General documentation</a></li>
	    <li><a href="gallery.html">Gallery</a></li>
<!--	    
	    <li><a href="http://tfel.sourceforge.net/doxygen/index.html">Doxygen documentation</a></li>
-->
	    <li><a>Behaviours</a>
	      <ul>
		<li><a href="tutorial.html">Tutorial</a></li>
		<li><a href="implicit-dsl.html">The Implicit DSL</a></li>
		<li><a href="benchmark.html">Benchmark</a></li>
		<li><a href="parameters.html">Parameters</a></li>
		<li><a href="BehaviourBricks.html">Behaviour bricks</a></li>
		<li><a href="interfaces.html">Solver interfaces</a>
		  <ul>
		    <li><a href="castem.html">Cast3M</a></li>
		    <li><a href="amitex.html">AMITEX_FFTP</a></li>
		    <li><a href="aster.html">Code-Aster</a></li>
    		    <li><a href="abaqus.html">Abaqus</a></li>
    		    <li><a href="epx.html">EUROPLEXUS</a></li>
		    <li><a href="zmat.html">ZeBuLoN</a></li>
   		    <li><a href="calculix.html">CalculiX</a></li>
		    <!-- <li><a >TMFFT</a></li> -->
		    <li><a href="cyrano.html">Cyrano</a></li>
   		    <li><a href="generic-material-property-interface.html">Generic interface for material properties</a></li>
   		    <li><a href="generic-behaviours-interface.html">Generic interface for behaviours</a></li>
		  </ul>
		</li>
	      </ul>
	    </li>
	    <li><a>TFEL libraries</a>
	      <ul>
		<li><a href="tfel-math.html">TFEL/Math</a></li>
		<li><a href="tfel-material.html">TFEL/Material</a></li>
	      </ul>
	    </li>
	    <li><a>Python modules</a>
	      <ul>
		<li><a href="tfel-python.html">TFEL modules</a></li>
		<li><a href="mfront-python.html">mfront module</a></li>
		<li><a href="mtest-python.html">mtest module</a></li>
	      </ul>
	    </li>
	    <li><a>MFront keywords</a>
	      <ul>
		<li><a href="DefaultDSL-keywords.html">DefaultDSL</a></li> 
		<li><a href="DefaultCZMDSL-keywords.html">DefaultCZMDSL</a></li> 
		<li><a href="DefaultFiniteStrainDSL-keywords.html">DefaultFiniteStrainDSL</a></li> 
		<li><a href="Implicit-keywords.html">Implicit</a></li> 
		<li><a href="ImplicitFiniteStrain-keywords.html">ImplicitFiniteStrain</a></li> 
		<li><a href="ImplicitII-keywords.html">ImplicitII</a></li> 
		<li><a href="IsotropicMisesCreep-keywords.html">IsotropicMisesCreep</a></li> 
		<li><a href="IsotropicPlasticMisesFlow-keywords.html">IsotropicPlasticMisesFlow</a></li> 
		<li><a href="IsotropicStrainHardeningMisesCreep-keywords.html">IsotropicStrainHardeningMisesCreep</a></li> 
		<li><a href="MaterialLaw-keywords.html">MaterialLaw</a></li> 
		<li><a href="Model-keywords.html">Model</a></li> 
		<li><a href="MultipleIsotropicMisesFlows-keywords.html">MultipleIsotropicMisesFlows</a></li> 
		<li><a href="RungeKutta-keywords.html">RungeKutta</a></li> 
	      </ul>
	    </li>
	    <li><a href="MTest-keywords.html">MTest keywords</a></li>
	    <li><a href="physical-constants.html">Physical constants</a></li>
	    <li><a href="glossary.html">Glossary</a></li>
	    <li><a href="publications.html">Publications</a></li>
	    <li><a href="faq.html">FAQ</a></li>
	    <li><a href="about.html">About</a></li>
	  </ul>
	</li>
	<li><a>Contributing</a>
	  <ul>
	    <li><a href="svn.html">Access to source repositories</a></li>
	    <li><a href="devel.html">Development guidelines</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Report bugs</a></li>
	  </ul>
	</li>
	<li><a>Getting Help</a>
	  <ul>
	    <li><a href="search.html">Search on this site</a></li>
	    <li><a href="https://github.com/thelfer/tfel/discussions">Forum</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Bug report</a></li>
	    <li><a href="https://github.com/thelfer/tfel/issues">Feature request</a></li>
	    <li><a href="mailto:tfel-contact@cea.fr">Contact</a></li>
	  </ul>
	</li>
      </ul>
    </header>
<div id="header">
<h1 class="title">How to implement an hyperelastic behaviour in MFront</h1>
<h2 class="author">Thomas Helfer</h2>
<h3 class="date">15/12/2016</h3>
</div>
<div id="TOC">
<ul>
<li><a href="#a-first-class-of-hyperelastic-behaviours">A first class of hyperelastic behaviours</a>
<ul>
<li><a href="#computation-of-the-second-piola-kirchhoff-stress">Computation of the second Piola-Kirchhoff stress</a></li>
<li><a href="#computation-of-consistent-tangent-operator">Computation of consistent tangent operator</a></li>
</ul></li>
<li><a href="#a-second-class-of-hyperelastic-behaviours">A second class of hyperelastic behaviours</a>
<ul>
<li><a href="#derivatives-of-the-invariants-of-the-isochoric-right-cauchy-tensor">Derivatives of the invariants of the isochoric right Cauchy tensor</a></li>
<li><a href="#general-derivation-of-the-second-piola-kirchhoff-stress-and-its-derivative">General derivation of the second Piola-Kirchhoff stress and its derivative</a>
<ul>
<li><a href="#volumetric-part-of-the-second-piola-kirchhoff-stress-and-its-derivative">Volumetric part of the second Piola-Kirchhoff stress and its derivative</a></li>
<li><a href="#isochoric-part-of-the-second-piola-kirchhoff-stress-and-its-derivative">Isochoric part of the second Piola-Kirchhoff stress and its derivative</a></li>
</ul></li>
<li><a href="#application-to-the-signorini-behaviour">Application to the Signorini behaviour</a></li>
</ul></li>
<li><a href="#odgen-hyperelastic-behaviours">Odgen Hyperelastic behaviours</a></li>
</ul>
</div>
<p><!-- pandoc -f markdown-markdown_in_html_blocks+tex_math_single_backslash --mathjax -s  hyperelasticity.md  -o hyperelasticity.pdf --></p>
<p>This article shows how to implement various hyperelastic behaviours in <code>MFront</code>.</p>
<h1 id="a-first-class-of-hyperelastic-behaviours">A first class of hyperelastic behaviours</h1>
<p>In this section, we consider an isotropic hyperelastic behaviour whose potential <span class="math inline">\(W\)</span> is written in terms of the invariants of the right Cauchy tensor <span class="math inline">\(\underline{C}\)</span>:</p>
<p><span class="math display">\[
W{\left(\underline{C}\right)}=W{\left(I_{1},I_{2},I_{3}\right)}
\]</span></p>
<p>The three invariants are defined by: <span class="math display">\[
\left\{
\begin{aligned}
I_{1} &amp;= {\mathrm{tr}{\left(\underline{C}\right)}} \\
I_{2} &amp;= {{\displaystyle \frac{\displaystyle 1}{\displaystyle 2}}}\left({\left({\mathrm{tr}{\left(\underline{C}\right)}}\right)}^{2}-{\mathrm{tr}{\left(\underline{C}^{2}\right)}}\right) \\
I_{3} &amp;= \det{\left(\underline{C}\right)} = J^{2}
\end{aligned}
\right.
\]</span></p>
<p>where <span class="math inline">\(J\)</span> is the jacobian of the deformation gradient</p>
<h2 id="computation-of-the-second-piola-kirchhoff-stress">Computation of the second Piola-Kirchhoff stress</h2>
<p>The second Piola-Kirchhoff stress <span class="math inline">\(\underline{S}\)</span> is then defined by:</p>
<p><span class="math display">\[
\underline{S}=2{\displaystyle \frac{\displaystyle \partial W}{\displaystyle \partial \underline{C}}}=2\,{\displaystyle \frac{\displaystyle \partial W}{\displaystyle \partial I_{1}}}\,{\displaystyle \frac{\displaystyle \partial I_{1}}{\displaystyle \partial \underline{C}}}+2\,{\displaystyle \frac{\displaystyle \partial W}{\displaystyle \partial I_{2}}}\,{\displaystyle \frac{\displaystyle \partial I_{2}}{\displaystyle \partial \underline{C}}}+2\,{\displaystyle \frac{\displaystyle \partial W}{\displaystyle \partial I_{3}}}\,{\displaystyle \frac{\displaystyle \partial I_{3}}{\displaystyle \partial \underline{C}}}
\]</span></p>
<p>The derivative of the invariants are classically given by: <span class="math display">\[
\left\{
\begin{aligned}
{\displaystyle \frac{\displaystyle \partial I_{1}}{\displaystyle \partial \underline{C}}} &amp;= \underline{I}\\
{\displaystyle \frac{\displaystyle \partial I_{2}}{\displaystyle \partial \underline{C}}} &amp;= I_{1}\,\underline{I}-\underline{C}\\
{\displaystyle \frac{\displaystyle \partial I_{3}}{\displaystyle \partial \underline{C}}} &amp;= \underline{C}^{2}-I_{1}\,C+I_{2}\,\underline{I} \\
\end{aligned}
\right.
\]</span></p>
<h2 id="computation-of-consistent-tangent-operator">Computation of consistent tangent operator</h2>
<p>The second derivative of the invariants are given by: <span class="math display">\[
\left\{
\begin{aligned}
{\displaystyle \frac{\displaystyle \partial^{2} I_{1}}{\displaystyle \partial \underline{C}^{2}}} &amp;= 0\\
{\displaystyle \frac{\displaystyle \partial^{2} I_{2}}{\displaystyle \partial \underline{C}^{2}}} &amp;= \underline{I}\otimes\underline{I}-\underline{\underline{\mathbf{I}}}\\
\end{aligned}
\right.
\]</span></p>
<p>In <code>MFront</code>, the fourth order tensors <span class="math inline">\(\underline{I}\otimes\underline{I}\)</span> and <span class="math inline">\(\underline{\underline{\mathbf{I}}}\)</span> are computed by <code>Stensor4::IxI()</code> and <code>Stensor4::Id()</code> respectively.</p>
<p>The <span class="math inline">\({\displaystyle \frac{\displaystyle \partial^{2} I_{3}}{\displaystyle \partial \underline{C}^{2}}}\)</span> term can be computed using the <code>computeDeterminantSecondDerivative</code> function.</p>
<h1 id="a-second-class-of-hyperelastic-behaviours">A second class of hyperelastic behaviours</h1>
<p>More precisely, we consider an hyperelastic behaviour whose potential <span class="math inline">\(W\)</span> is decomposed in an volumetric part <span class="math inline">\(W^{\text{v}}\)</span> and an isochoric part <span class="math inline">\(W^{\text{i}}\)</span>:</p>
<p><span class="math display">\[
W{\left(\underline{C}\right)}=W^{v}{\left(J\right)}+W^{i}{\left(\bar{I}_{1},\bar{I}_{2}\right)}
\]</span></p>
<p>where <span class="math inline">\(\bar{I}_{1}\)</span> and <span class="math inline">\(\bar{I}_{2}\)</span> are the first and second invariant of the isochoric right Cauchy tensor <span class="math inline">\(\underline{\bar{C}}\)</span> defined by:</p>
<p><span class="math display">\[
\underline{\bar{C}}=J^{-2/3}\,\underline{C}= I_{3}^{-1/3}\,\underline{C}= \bar{c}_{I_{3}}\,\underline{C}
\]</span></p>
<p>with <span class="math inline">\(\bar{c}_{I_{3}}=I_{3}^{-1/3}\)</span></p>
<h2 id="derivatives-of-the-invariants-of-the-isochoric-right-cauchy-tensor">Derivatives of the invariants of the isochoric right Cauchy tensor</h2>
<p><span class="math inline">\(\bar{I}_{1}\)</span> and <span class="math inline">\(\bar{I}_{2}\)</span> are related to the first and second invariants of the right Cauchy tensor by:</p>
<p><span class="math display">\[
\begin{aligned}
  \bar{I}_{1} &amp;= I_{3}^{-1/3}\,I_{1} = \bar{c}_{I_{3}}\,I_{1}\\
  \bar{I}_{2} &amp;= I_{3}^{-2/3}\,I_{2} = \bar{c}_{I_{3}}^{2}\,I_{2}\\
\end{aligned}
\]</span></p>
<p>The following derivatives will be useful in the following: <span class="math display">\[
\left\{
\begin{aligned}
    {\displaystyle \frac{\displaystyle \partial \bar{c}_{I_{3}}}{\displaystyle \partial \underline{C}}}  &amp;= {\displaystyle \frac{\displaystyle \partial \bar{c}_{I_{3}}}{\displaystyle \partial I_{3}}}\,{\displaystyle \frac{\displaystyle \partial I_{3}}{\displaystyle \partial \underline{C}}} =-\frac{1}{3}\,\bar{c}_{I_{3}}^{4}\,{\displaystyle \frac{\displaystyle \partial I_{3}}{\displaystyle \partial \underline{C}}} \\
    {\displaystyle \frac{\displaystyle \partial^{2} \bar{c}_{I_{3}}}{\displaystyle \partial \underline{C}^{2}}} &amp;= \frac{4}{9}\,\bar{c}_{I_{3}}^{7}{\displaystyle \frac{\displaystyle \partial I_{3}}{\displaystyle \partial \underline{C}}}\otimes{\displaystyle \frac{\displaystyle \partial I_{3}}{\displaystyle \partial \underline{C}}}-\frac{1}{3}\,\bar{c}_{I_{3}}^{4}\,{\displaystyle \frac{\displaystyle \partial^{2} I_{3}}{\displaystyle \partial \underline{C}^{2}}} \\
\end{aligned}
\right.
\]</span></p>
<p><span class="math inline">\({\displaystyle \frac{\displaystyle \partial \bar{I}_{1}}{\displaystyle \partial \underline{C}}}\)</span> is given by: <span class="math display">\[
{\displaystyle \frac{\displaystyle \partial \bar{I}_{1}}{\displaystyle \partial \underline{C}}}=\bar{c}_{I_{3}}\underline{I}+\,I_{1}\,{\displaystyle \frac{\displaystyle \partial iJb}{\displaystyle \partial \underline{C}}}
\]</span></p>
<p><span class="math inline">\({\displaystyle \frac{\displaystyle \partial \bar{I}_{2}}{\displaystyle \partial \underline{C}}}\)</span> is given by: <span class="math display">\[
{\displaystyle \frac{\displaystyle \partial \bar{I}_{2}}{\displaystyle \partial \underline{C}}}=\bar{c}_{I_{3}}^{2}\,{\displaystyle \frac{\displaystyle \partial I_{2}}{\displaystyle \partial \underline{C}}}+2\,I_{2}\,\bar{c}_{I_{3}}\,{\displaystyle \frac{\displaystyle \partial \bar{c}_{I_{3}}}{\displaystyle \partial \underline{C}}}
\]</span></p>
<p>The second derivative of the first invariant of the isochoric right Cauchy tensor is:</p>
<p><span class="math display">\[
{\displaystyle \frac{\displaystyle \partial^{2} \bar{I}_{1}}{\displaystyle \partial \underline{C}^{2}}}=
\underline{I}\otimes{\displaystyle \frac{\displaystyle \partial \bar{c}_{I_{3}}}{\displaystyle \partial \underline{C}}}+
{\displaystyle \frac{\displaystyle \partial \bar{c}_{I_{3}}}{\displaystyle \partial \underline{C}}}\otimes\underline{I}+
I_{1}\,{\displaystyle \frac{\displaystyle \partial^{2} \bar{c}_{I_{3}}}{\displaystyle \partial \underline{C}^{2}}}
\]</span></p>
<p>The second derivative of the second invariant of the isochoric right Cauchy tensor is:</p>
<p><span class="math display">\[
\begin{aligned}
{\displaystyle \frac{\displaystyle \partial^{2} \bar{I}_{2}}{\displaystyle \partial \underline{C}^{2}}}&amp;=
2\,\bar{c}_{I_{3}}\,{\displaystyle \frac{\displaystyle \partial I_{2}}{\displaystyle \partial \underline{C}}}\otimes{\displaystyle \frac{\displaystyle \partial \bar{c}_{I_{3}}}{\displaystyle \partial \underline{C}}}+
\bar{c}_{I_{3}}^{2}\,{\displaystyle \frac{\displaystyle \partial^{2} I_{2}}{\displaystyle \partial \underline{C}^{2}}}+
2\,\bar{c}_{I_{3}}\,{\displaystyle \frac{\displaystyle \partial \bar{c}_{I_{3}}}{\displaystyle \partial \underline{C}}}\otimes{\displaystyle \frac{\displaystyle \partial I_{2}}{\displaystyle \partial \underline{C}}}+
2\,I_{2}\,{\displaystyle \frac{\displaystyle \partial \bar{c}_{I_{3}}}{\displaystyle \partial \underline{C}}}\otimes{\displaystyle \frac{\displaystyle \partial \bar{c}_{I_{3}}}{\displaystyle \partial \underline{C}}}+
2\,I_{2}\,\bar{c}_{I_{3}}\,{\displaystyle \frac{\displaystyle \partial^{2} \bar{c}_{I_{3}}}{\displaystyle \partial \underline{C}^{2}}}
\end{aligned}
\]</span></p>
<h2 id="general-derivation-of-the-second-piola-kirchhoff-stress-and-its-derivative">General derivation of the second Piola-Kirchhoff stress and its derivative</h2>
<p>The second Piola-Kirchhoff stress <span class="math inline">\(\underline{S}\)</span> is defined by:</p>
<p><span class="math display">\[
\underline{S}=2{\displaystyle \frac{\displaystyle \partial W}{\displaystyle \partial \underline{C}}}
\]</span></p>
<p>The more natural expression of the consistent tangent operator in that context is <span class="math inline">\({\displaystyle \frac{\displaystyle \partial \underline{S}}{\displaystyle \partial \underline{C}}}\)</span>. We let <code>MFront</code> make an implicit transformation to the appropriate tangent operator expected by the solver.</p>
<p>The general expression of the second Piola-Kirchhoff stress is:</p>
<p><span class="math display">\[
\underline{S}=2\,{\displaystyle \frac{\displaystyle \partial W^{v}}{\displaystyle \partial \underline{C}}}+2{\displaystyle \frac{\displaystyle \partial W^{i}}{\displaystyle \partial \underline{C}}}=\underline{S}^{v}+\underline{S}^{i}
\]</span></p>
<p>where <span class="math inline">\(\underline{S}^{v}=2\,{\displaystyle \frac{\displaystyle \partial W^{v}}{\displaystyle \partial \underline{C}}}\)</span> is the volumetric part of the the second Piola-Kirchhoff stress and <span class="math inline">\(\underline{S}^{i}=2\,{\displaystyle \frac{\displaystyle \partial W^{i}}{\displaystyle \partial \underline{C}}}\)</span> is the isochoric part.</p>
<h3 id="volumetric-part-of-the-second-piola-kirchhoff-stress-and-its-derivative">Volumetric part of the second Piola-Kirchhoff stress and its derivative</h3>
<p>By chain rule, we have: <span class="math display">\[
  \underline{S}^{v} = 2\,{\displaystyle \frac{\displaystyle \partial W^{v}}{\displaystyle \partial \underline{C}}}=2\,{\displaystyle \frac{\displaystyle \partial W^{v}}{\displaystyle \partial J}}\,{\displaystyle \frac{\displaystyle \partial J}{\displaystyle \partial I3}}{\displaystyle \frac{\displaystyle \partial I_{3}}{\displaystyle \partial \underline{C}}}
  = 2\,{\displaystyle \frac{\displaystyle \partial W^{v}}{\displaystyle \partial J}}{{\displaystyle \frac{\displaystyle 1}{\displaystyle 2\,J}}}\,{\displaystyle \frac{\displaystyle \partial I_{3}}{\displaystyle \partial \underline{C}}}
  = {{\displaystyle \frac{\displaystyle 1}{\displaystyle J}}}\,{\displaystyle \frac{\displaystyle \partial W^{v}}{\displaystyle \partial J}}\,{\displaystyle \frac{\displaystyle \partial I_{3}}{\displaystyle \partial \underline{C}}}
\]</span></p>
<p>The computation of <span class="math inline">\({\displaystyle \frac{\displaystyle \partial \underline{S}^{v}}{\displaystyle \partial \underline{C}}}\)</span> is straightforward:</p>
<p><span class="math display">\[
\begin{aligned}
{\displaystyle \frac{\displaystyle \partial \underline{S}^{v}}{\displaystyle \partial \underline{C}}}
    &amp;={\displaystyle \frac{\displaystyle \partial }{\displaystyle \partial J}}{\left({{\displaystyle \frac{\displaystyle 1}{\displaystyle J}}}\,{\displaystyle \frac{\displaystyle \partial W^{v}}{\displaystyle \partial J}}\right)}\,{\displaystyle \frac{\displaystyle \partial J}{\displaystyle \partial I_{3}}}\,{\displaystyle \frac{\displaystyle \partial I_{3}}{\displaystyle \partial \underline{C}}}\otimes{\displaystyle \frac{\displaystyle \partial I_{3}}{\displaystyle \partial \underline{C}}}+{{\displaystyle \frac{\displaystyle 1}{\displaystyle J}}}\,{\displaystyle \frac{\displaystyle \partial W^{v}}{\displaystyle \partial J}}\,{\displaystyle \frac{\displaystyle \partial^{2} I_{3}}{\displaystyle \partial \underline{C}^{2}}}\\
    &amp;={\left({\displaystyle \frac{\displaystyle \partial^{2} W^{v}}{\displaystyle \partial J^{2}}}-{{\displaystyle \frac{\displaystyle 1}{\displaystyle J}}}\,{\displaystyle \frac{\displaystyle \partial W^{v}}{\displaystyle \partial J}}\right)}\,\frac{1}{2\,I_{3}}\,{\displaystyle \frac{\displaystyle \partial I_{3}}{\displaystyle \partial \underline{C}}}\otimes{\displaystyle \frac{\displaystyle \partial I_{3}}{\displaystyle \partial \underline{C}}}+{{\displaystyle \frac{\displaystyle 1}{\displaystyle J}}}\,{\displaystyle \frac{\displaystyle \partial W^{v}}{\displaystyle \partial J}}\,{\displaystyle \frac{\displaystyle \partial^{2} I_{3}}{\displaystyle \partial \underline{C}^{2}}}\\
\end{aligned}
\]</span></p>
<h3 id="isochoric-part-of-the-second-piola-kirchhoff-stress-and-its-derivative">Isochoric part of the second Piola-Kirchhoff stress and its derivative</h3>
<p>By chain rule, we have: <span class="math display">\[
  \underline{S}^{i} = 2\,{\displaystyle \frac{\displaystyle \partial W^{i}}{\displaystyle \partial \underline{C}}}=2\,{\displaystyle \frac{\displaystyle \partial W^{i}}{\displaystyle \partial \bar{I}_{1}}}\,{\displaystyle \frac{\displaystyle \partial \bar{I}_{1}}{\displaystyle \partial \underline{C}}}+2\,{\displaystyle \frac{\displaystyle \partial W^{i}}{\displaystyle \partial \bar{I}_{2}}}\,{\displaystyle \frac{\displaystyle \partial \bar{I}_{2}}{\displaystyle \partial \underline{C}}}
\]</span></p>
<p>The second derivative is also straightforward: <span class="math display">\[
\begin{aligned}
{\displaystyle \frac{\displaystyle \partial^{2} \underline{S}^{i}}{\displaystyle \partial C^{2}}}=&amp;
2\,{\displaystyle \frac{\displaystyle \partial^{2} W^{i}}{\displaystyle \partial \bar{I}_{1}^{2}}}\,{\displaystyle \frac{\displaystyle \partial \bar{I}_{1}}{\displaystyle \partial \underline{C}}}\otimes{\displaystyle \frac{\displaystyle \partial \bar{I}_{1}}{\displaystyle \partial \underline{C}}}+
2\,{\displaystyle \frac{\displaystyle \partial^{2} W^{i}}{\partial \bar{I}_{1}\partial \bar{I}_{2}}}\,{\displaystyle \frac{\displaystyle \partial \bar{I}_{1}}{\displaystyle \partial \underline{C}}}\otimes{\displaystyle \frac{\displaystyle \partial \bar{I}_{2}}{\displaystyle \partial \underline{C}}}+
2\,{\displaystyle \frac{\displaystyle \partial W^{i}}{\displaystyle \partial \bar{I}_{1}}}{\displaystyle \frac{\displaystyle \partial^{2} \bar{I}_{1}}{\displaystyle \partial \underline{C}^{2}}}+\\
&amp; 2\,{\displaystyle \frac{\displaystyle \partial^{2} W^{i}}{\displaystyle \partial \bar{I}_{2}^{2}}}\,{\displaystyle \frac{\displaystyle \partial \bar{I}_{2}}{\displaystyle \partial \underline{C}}}\otimes{\displaystyle \frac{\displaystyle \partial \bar{I}_{2}}{\displaystyle \partial \underline{C}}}+
2\,{\displaystyle \frac{\displaystyle \partial^{2} W^{i}}{\partial \bar{I}_{1}\partial \bar{I}_{2}}}\,{\displaystyle \frac{\displaystyle \partial \bar{I}_{2}}{\displaystyle \partial \underline{C}}}\otimes{\displaystyle \frac{\displaystyle \partial \bar{I}_{1}}{\displaystyle \partial \underline{C}}}+
2\,{\displaystyle \frac{\displaystyle \partial W^{i}}{\displaystyle \partial \bar{I}_{2}}}{\displaystyle \frac{\displaystyle \partial^{2} \bar{I}_{2}}{\displaystyle \partial \underline{C}^{2}}}
\end{aligned}
\]</span></p>
<h2 id="application-to-the-signorini-behaviour">Application to the Signorini behaviour</h2>
<p>An implementation of the Signorini behaviour based on the previous developments is available on a <a href="signorini.html">dedicated page</a>.</p>
<h1 id="odgen-hyperelastic-behaviours">Odgen Hyperelastic behaviours</h1>
<p>We now consider another class of hyperelastic behaviour of the form: More precisely, we consider an hyperelastic behaviour whose potential <span class="math inline">\(W\)</span> is decomposed in an volumetric part <span class="math inline">\(W^{\text{v}}\)</span> and an isochoric part <span class="math inline">\(W^{\text{i}}\)</span>:</p>
<p><span class="math display">\[
W{\left(\underline{C}\right)}=W^{v}{\left(J\right)}+\bar{W}^{i}{\left(\bar{\lambda}_{1},\bar{\lambda}_{2},\bar{\lambda}_{3}\right)}
\]</span></p>
<p>where <span class="math inline">\({\left(\bar{\lambda}_{i}\right)}_{i\in \{1,2,3\}}\)</span> are the eigenvalues of the isochoric right Cauchy tensor <span class="math inline">\(\underline{\bar{C}}\)</span>.</p>
<p><span class="math display">\[
\bar{\lambda}_{i}=\bar{c}_{I_{3}}\,\lambda_{i}
\]</span></p>
<p>The volumetric part has been treated in the previous section. Let us consider the isochoric part which is assumed to have the following Odgen-type form:</p>
<p><span class="math display">\[
\bar{W}^{i}{\left(\bar{\lambda}_{1},\bar{\lambda}_{2},\bar{\lambda}_{3}\right)}=\sum_{p=1}^{N}\bar{W}^{i}_{p}
\]</span></p>
<p><span class="math display">\[
\bar{W}^{i}_{p}{\left(\bar{\lambda}_{1},\bar{\lambda}_{2},\bar{\lambda}_{3}\right)}
={{\displaystyle \frac{\displaystyle \mu_{p}}{\displaystyle \alpha_{p}}}}{\left(\bar{\lambda}_{1}^{\alpha_{p}/2}+\bar{\lambda}_{2}^{\alpha_{p}/2}+\bar{\lambda}_{3}^{\alpha_{p}/2}-3\right)} 
={{\displaystyle \frac{\displaystyle \mu_{p}}{\displaystyle \alpha_{p}}}}\bar{c}_{I_{3}}^{\alpha_{p}/2}\,f{\left(\lambda_{1},\lambda_{2},\lambda_{3}\right)}-{{\displaystyle \frac{\displaystyle 3\,\mu_{p}}{\displaystyle \alpha_{p}}}}
\]</span></p>
<p>with <span class="math inline">\(f{\left(\lambda_{1},\lambda_{2},\lambda_{3}\right)}=\lambda_{1}^{\alpha_{p}/2}+\lambda_{2}^{\alpha_{p}/2}+\lambda_{3}^{\alpha_{p}/2}\)</span></p>
<p>Let us focus on the contribution <span class="math inline">\(\underline{S}_{p}^{i}\)</span> of <span class="math inline">\(W^{i}_{p}\)</span> to the second Piola Kirchoff stress: <span class="math display">\[
\begin{aligned}
\underline{S}_{p}^{i}=2\,{\displaystyle \frac{\displaystyle \partial \bar{W}^{i}_{p}}{\displaystyle \partial \underline{C}}}=
\mu_{p}\,\bar{c}_{I_{3}}^{\alpha_{p}/2-1}\,f{\left(\lambda_{1},\lambda_{2},\lambda_{3}\right)}{\displaystyle \frac{\displaystyle \partial \bar{c}_{I_{3}}}{\displaystyle \partial \underline{C}}}+
{{\displaystyle \frac{\displaystyle 2\,\mu_{p}\,\bar{c}_{I_{3}}^{\alpha_{p}/2}}{\displaystyle \alpha_{p}}}}\,{\displaystyle \frac{\displaystyle \partial f}{\displaystyle \partial \underline{C}}}\\
\end{aligned}
\]</span></p>
<p>The associated contribution to the consistent tangent operator is given the derivative of <span class="math inline">\(\underline{S}_{p}^{i}\)</span> with respect to the right Cauchy tensor <span class="math inline">\(\underline{C}\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
{{\displaystyle \frac{\displaystyle 1}{\displaystyle \mu_{p}}}}\,{\displaystyle \frac{\displaystyle \partial S_{p}^{i}}{\displaystyle \partial \underline{C}}}
&amp;=\frac{\alpha_{p}-2}{2}\,\bar{c}_{I_{3}}^{\alpha_{p}/2-2}\,f{\left(\lambda_{1},\lambda_{2},\lambda_{3}\right)}{\displaystyle \frac{\displaystyle \partial \bar{c}_{I_{3}}}{\displaystyle \partial \underline{C}}}\otimes{\displaystyle \frac{\displaystyle \partial \bar{c}_{I_{3}}}{\displaystyle \partial \underline{C}}}\\
&amp;+\bar{c}_{I_{3}}^{\alpha_{p}/2-1}\,f{\left(\lambda_{1},\lambda_{2},\lambda_{3}\right)}\,{\displaystyle \frac{\displaystyle \partial^{2} \bar{c}_{I_{3}}}{\displaystyle \partial \underline{C}^{2}}}+\bar{c}_{I_{3}}^{\alpha_{p}/2-1}\,{\displaystyle \frac{\displaystyle \partial \bar{c}_{I_{3}}}{\displaystyle \partial \underline{C}}}\otimes{\displaystyle \frac{\displaystyle \partial f}{\displaystyle \partial \underline{C}}}\\
&amp;+\bar{c}_{I_{3}}^{\alpha_{p}/2-1}\,{\displaystyle \frac{\displaystyle \partial f}{\displaystyle \partial \underline{C}}}\otimes{\displaystyle \frac{\displaystyle \partial \bar{c}_{I_{3}}}{\displaystyle \partial \underline{C}}}+
2\,{{\displaystyle \frac{\displaystyle \bar{c}_{I_{3}}^{\alpha_{p}/2}}{\displaystyle \alpha_{p}}}}\,{\displaystyle \frac{\displaystyle \partial^{2} f}{\displaystyle \partial \underline{C}^{2}}}
\end{aligned}
\]</span></p>
<p>In this expression, we have: <span class="math display">\[
{\displaystyle \frac{\displaystyle \partial f}{\displaystyle \partial \underline{C}}}=\sum_{i=1}^{3}{{\displaystyle \frac{\displaystyle \alpha_{p}}{\displaystyle 2}}}\,\lambda_{i}^{\alpha_{p}/2-1}\,\underline{n}_{i}
\]</span></p>
<p>where <span class="math inline">\({\left(\underline{n}_{i}\right)}_{i\in \{1,2,3\}}\)</span> are the eigentenseurs of the right Cauchy tensor.</p>
<p>Computing <span class="math inline">\({\displaystyle \frac{\displaystyle \partial^{2} f}{\displaystyle \partial \underline{C}^{2}}}\)</span> is a non trivial task as one have to take care of the cases where two eigenvalues are equal and repeatedly use the Hospital rule to pass to the limit. For this reason, it is much easier to use the <code>computeIsotropicFunctionAndDerivative</code> static method of the <code>stensor</code> class.</p>
<p>An implementation of the Ogden behaviour based on the previous developments is available on a <a href="ogden.html">dedicated page</a>.</p>
<!-- Local IspellDict: english -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-62273823-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
